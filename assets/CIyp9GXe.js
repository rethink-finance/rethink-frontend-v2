import{r as k}from"./DQ172AOg.js";function y(n,a){for(var u=0;u<a.length;u++){const d=a[u];if(typeof d!="string"&&!Array.isArray(d)){for(const s in d)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(d,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>d[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}var _={},g={},f={},v;function x(){if(v)return f;v=1,Object.defineProperty(f,"__esModule",{value:!0}),f.getLowerCase=void 0;function n(a){return a&&a.toLowerCase()}return f.getLowerCase=n,f}var m;function T(){if(m)return g;m=1,Object.defineProperty(g,"__esModule",{value:!0}),g.SafeAppProvider=void 0;const n=k(),a=x();class u extends n.EventEmitter{constructor(s,i){super(),this.submittedTxs=new Map,this.safe=s,this.sdk=i}async connect(){this.emit("connect",{chainId:this.chainId})}async disconnect(){}get chainId(){return this.safe.chainId}async request(s){const{method:i,params:e=[]}=s;switch(i){case"eth_accounts":return[this.safe.safeAddress];case"net_version":case"eth_chainId":return`0x${this.chainId.toString(16)}`;case"personal_sign":{const[t,r]=e;if(this.safe.safeAddress.toLowerCase()!==r.toLowerCase())throw new Error("The address or message hash is invalid");const h=await this.sdk.txs.signMessage(t);return("signature"in h?h.signature:void 0)||"0x"}case"eth_sign":{const[t,r]=e;if(this.safe.safeAddress.toLowerCase()!==t.toLowerCase()||!r.startsWith("0x"))throw new Error("The address or message hash is invalid");const h=await this.sdk.txs.signMessage(r);return("signature"in h?h.signature:void 0)||"0x"}case"eth_signTypedData":case"eth_signTypedData_v4":{const[t,r]=e,h=typeof r=="string"?JSON.parse(r):r;if(this.safe.safeAddress.toLowerCase()!==t.toLowerCase())throw new Error("The address is invalid");const l=await this.sdk.txs.signTypedMessage(h);return("signature"in l?l.signature:void 0)||"0x"}case"eth_sendTransaction":const o={...e[0],value:e[0].value||"0",data:e[0].data||"0x"};typeof o.gas=="string"&&o.gas.startsWith("0x")&&(o.gas=parseInt(o.gas,16));const p=await this.sdk.txs.send({txs:[o],params:{safeTxGas:o.gas}});return this.submittedTxs.set(p.safeTxHash,{from:this.safe.safeAddress,hash:p.safeTxHash,gas:0,gasPrice:"0x00",nonce:0,input:o.data,value:o.value,to:o.to,blockHash:null,blockNumber:null,transactionIndex:null}),p.safeTxHash;case"eth_blockNumber":return(await this.sdk.eth.getBlockByNumber(["latest"])).number;case"eth_getBalance":return this.sdk.eth.getBalance([(0,a.getLowerCase)(e[0]),e[1]]);case"eth_getCode":return this.sdk.eth.getCode([(0,a.getLowerCase)(e[0]),e[1]]);case"eth_getTransactionCount":return this.sdk.eth.getTransactionCount([(0,a.getLowerCase)(e[0]),e[1]]);case"eth_getStorageAt":return this.sdk.eth.getStorageAt([(0,a.getLowerCase)(e[0]),e[1],e[2]]);case"eth_getBlockByNumber":return this.sdk.eth.getBlockByNumber([e[0],e[1]]);case"eth_getBlockByHash":return this.sdk.eth.getBlockByHash([e[0],e[1]]);case"eth_getTransactionByHash":let c=e[0];try{c=(await this.sdk.txs.getBySafeTxHash(c)).txHash||c}catch{}return this.submittedTxs.has(c)?this.submittedTxs.get(c):this.sdk.eth.getTransactionByHash([c]).then(t=>(t&&(t.hash=e[0]),t));case"eth_getTransactionReceipt":{let t=e[0];try{t=(await this.sdk.txs.getBySafeTxHash(t)).txHash||t}catch{}return this.sdk.eth.getTransactionReceipt([t]).then(r=>(r&&(r.transactionHash=e[0]),r))}case"eth_estimateGas":return this.sdk.eth.getEstimateGas(e[0]);case"eth_call":return this.sdk.eth.call([e[0],e[1]]);case"eth_getLogs":return this.sdk.eth.getPastLogs([e[0]]);case"eth_gasPrice":return this.sdk.eth.getGasPrice();case"wallet_getPermissions":return this.sdk.wallet.getPermissions();case"wallet_requestPermissions":return this.sdk.wallet.requestPermissions(e[0]);case"safe_setSettings":return this.sdk.eth.setSafeSettings([e[0]]);default:throw Error(`"${s.method}" not implemented`)}}send(s,i){s||i("Undefined request"),this.request(s).then(e=>i(null,{jsonrpc:"2.0",id:s.id,result:e})).catch(e=>i(e,null))}}return g.SafeAppProvider=u,g}var w;function b(){return w||(w=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SafeAppProvider=void 0;var a=T();Object.defineProperty(n,"SafeAppProvider",{enumerable:!0,get:function(){return a.SafeAppProvider}})}(_)),_}var P=b();const H=y({__proto__:null},[P]);export{H as i};

import{O as ge,P as A,cc as Oe,ck as Ae,fv as x,n as O,dy as Y,dJ as pt,k as Le,t as lt,Z as me,d1 as J,fx as K,fB as yt,fC as _e,d5 as qe,d6 as He,fD as ct,ez as mt,fE as ft,c_ as fe,fF as Ge,ey as We,cZ as ve,fG as Me,fH as Tt,fI as bt,fJ as De,u as ht}from"./_BmmGIGi.js";import{D as gt,E as At,G as vt,b as Te,u as ee,n as Ce,P as E,H as Ft,x as Nt,I as Ue,J as ce,z as St,d as te,K as Et,y as Q,L as wt,w as xt,f as Mt,M as Dt,O as Ct,F as k}from"./BwiW5Nlt.js";import{u as $e}from"./DxTlZv4G.js";import{I}from"./cVa1OdO9.js";import{f as D}from"./CKS8D1OD.js";const ne=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_value",type:"uint256"}],name:"burn",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_value",type:"uint256"}],name:"burnFrom",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"},{name:"_extraData",type:"bytes"}],name:"approveAndCall",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"",type:"address"},{name:"",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[{name:"initialSupply",type:"uint256"},{name:"tokenName",type:"string"},{name:"tokenSymbol",type:"string"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Burn",type:"event"}],Ut={abi:[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"Empty",type:"error"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"version",type:"uint8"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint64",name:"oldVoteExtension",type:"uint64"},{indexed:!1,internalType:"uint64",name:"newVoteExtension",type:"uint64"}],name:"LateQuorumVoteExtensionSet",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"proposalId",type:"uint256"}],name:"ProposalCanceled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"proposalId",type:"uint256"},{indexed:!1,internalType:"address",name:"proposer",type:"address"},{indexed:!1,internalType:"address[]",name:"targets",type:"address[]"},{indexed:!1,internalType:"uint256[]",name:"values",type:"uint256[]"},{indexed:!1,internalType:"string[]",name:"signatures",type:"string[]"},{indexed:!1,internalType:"bytes[]",name:"calldatas",type:"bytes[]"},{indexed:!1,internalType:"uint256",name:"voteStart",type:"uint256"},{indexed:!1,internalType:"uint256",name:"voteEnd",type:"uint256"},{indexed:!1,internalType:"string",name:"description",type:"string"}],name:"ProposalCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"proposalId",type:"uint256"}],name:"ProposalExecuted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"proposalId",type:"uint256"},{indexed:!1,internalType:"uint64",name:"extendedDeadline",type:"uint64"}],name:"ProposalExtended",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"proposalId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"eta",type:"uint256"}],name:"ProposalQueued",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"oldQuorumNumerator",type:"uint256"},{indexed:!1,internalType:"uint256",name:"newQuorumNumerator",type:"uint256"}],name:"QuorumNumeratorUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"oldTimelock",type:"address"},{indexed:!1,internalType:"address",name:"newTimelock",type:"address"}],name:"TimelockChange",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"voter",type:"address"},{indexed:!1,internalType:"uint256",name:"proposalId",type:"uint256"},{indexed:!1,internalType:"uint8",name:"support",type:"uint8"},{indexed:!1,internalType:"uint256",name:"weight",type:"uint256"},{indexed:!1,internalType:"string",name:"reason",type:"string"}],name:"VoteCast",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"voter",type:"address"},{indexed:!1,internalType:"uint256",name:"proposalId",type:"uint256"},{indexed:!1,internalType:"uint8",name:"support",type:"uint8"},{indexed:!1,internalType:"uint256",name:"weight",type:"uint256"},{indexed:!1,internalType:"string",name:"reason",type:"string"},{indexed:!1,internalType:"bytes",name:"params",type:"bytes"}],name:"VoteCastWithParams",type:"event"},{inputs:[],name:"BALLOT_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"CLOCK_MODE",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"COUNTING_MODE",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"pure",type:"function"},{inputs:[],name:"EXTENDED_BALLOT_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"targets",type:"address[]"},{internalType:"uint256[]",name:"values",type:"uint256[]"},{internalType:"bytes[]",name:"calldatas",type:"bytes[]"},{internalType:"bytes32",name:"descriptionHash",type:"bytes32"}],name:"cancel",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"},{internalType:"uint8",name:"support",type:"uint8"}],name:"castVote",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"},{internalType:"uint8",name:"support",type:"uint8"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"castVoteBySig",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"},{internalType:"uint8",name:"support",type:"uint8"},{internalType:"string",name:"reason",type:"string"}],name:"castVoteWithReason",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"},{internalType:"uint8",name:"support",type:"uint8"},{internalType:"string",name:"reason",type:"string"},{internalType:"bytes",name:"params",type:"bytes"}],name:"castVoteWithReasonAndParams",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"},{internalType:"uint8",name:"support",type:"uint8"},{internalType:"string",name:"reason",type:"string"},{internalType:"bytes",name:"params",type:"bytes"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"castVoteWithReasonAndParamsBySig",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"clock",outputs:[{internalType:"uint48",name:"",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"targets",type:"address[]"},{internalType:"uint256[]",name:"values",type:"uint256[]"},{internalType:"bytes[]",name:"calldatas",type:"bytes[]"},{internalType:"bytes32",name:"descriptionHash",type:"bytes32"}],name:"execute",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"getVotes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"timepoint",type:"uint256"},{internalType:"bytes",name:"params",type:"bytes"}],name:"getVotesWithParams",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"},{internalType:"address",name:"account",type:"address"}],name:"hasVoted",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"targets",type:"address[]"},{internalType:"uint256[]",name:"values",type:"uint256[]"},{internalType:"bytes[]",name:"calldatas",type:"bytes[]"},{internalType:"bytes32",name:"descriptionHash",type:"bytes32"}],name:"hashProposal",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"contract IVotesUpgradeable",name:"_token",type:"address"},{internalType:"string",name:"_govName",type:"string"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"lateQuorumVoteExtension",outputs:[{internalType:"uint64",name:"",type:"uint64"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC1155BatchReceived",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC1155Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC721Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"}],name:"proposalDeadline",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"}],name:"proposalEta",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"}],name:"proposalProposer",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"}],name:"proposalSnapshot",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"proposalThreshold",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"}],name:"proposalVotes",outputs:[{internalType:"uint256",name:"againstVotes",type:"uint256"},{internalType:"uint256",name:"forVotes",type:"uint256"},{internalType:"uint256",name:"abstainVotes",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"targets",type:"address[]"},{internalType:"uint256[]",name:"values",type:"uint256[]"},{internalType:"bytes[]",name:"calldatas",type:"bytes[]"},{internalType:"string",name:"description",type:"string"}],name:"propose",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"targets",type:"address[]"},{internalType:"uint256[]",name:"values",type:"uint256[]"},{internalType:"bytes[]",name:"calldatas",type:"bytes[]"},{internalType:"bytes32",name:"descriptionHash",type:"bytes32"}],name:"queue",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"quorum",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"quorumDenominator",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"quorumNumerator",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"quorumNumerator",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"target",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"relay",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint64",name:"newVoteExtension",type:"uint64"}],name:"setLateQuorumVoteExtension",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"}],name:"state",outputs:[{internalType:"enum IGovernorUpgradeable.ProposalState",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"timelock",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"token",outputs:[{internalType:"contract IERC5805Upgradeable",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"newQuorumNumerator",type:"uint256"}],name:"updateQuorumNumerator",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract TimelockControllerUpgradeable",name:"newTimelock",type:"address"}],name:"updateTimelock",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"version",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"votingDelay",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[],name:"votingPeriod",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{stateMutability:"payable",type:"receive"}]};var _=(e=>(e.Idle="idle",e.Loading="loading",e.Success="success",e.Error="error",e))(_||{});const Vt=ge("actionState",{state:()=>({loadingStates:{}}),getters:{isActionState:e=>(t,n)=>e.loadingStates[t]===n,isActionStateLoading:e=>t=>e.loadingStates[t]===_.Loading,getActionState:e=>t=>e.loadingStates[t]},actions:{setActionState(e,t){this.loadingStates[e]=t}}});async function h(e,t,n=!1){const a=Vt();if(n&&a.isActionState(e,_.Loading)){console.warn(`Action "${e}" is already in progress.`);return}a.setActionState(e,_.Loading);try{const s=await t();return a.setActionState(e,_.Success),s}catch(s){throw console.error(`Error in action "${e}":`,s),a.setActionState(e,_.Error),s}}const L={abi:[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"delegator",type:"address"},{indexed:!0,internalType:"address",name:"fromDelegate",type:"address"},{indexed:!0,internalType:"address",name:"toDelegate",type:"address"}],name:"DelegateChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"delegate",type:"address"},{indexed:!1,internalType:"uint256",name:"previousBalance",type:"uint256"},{indexed:!1,internalType:"uint256",name:"newBalance",type:"uint256"}],name:"DelegateVotesChanged",type:"event"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"version",type:"uint8"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"FundSettings",outputs:[{internalType:"uint256",name:"depositFee",type:"uint256"},{internalType:"uint256",name:"withdrawFee",type:"uint256"},{internalType:"uint256",name:"performanceFee",type:"uint256"},{internalType:"uint256",name:"managementFee",type:"uint256"},{internalType:"uint256",name:"performaceHurdleRateBps",type:"uint256"},{internalType:"address",name:"baseToken",type:"address"},{internalType:"address",name:"safe",type:"address"},{internalType:"bool",name:"isExternalGovTokenInUse",type:"bool"},{internalType:"bool",name:"isWhitelistedDeposits",type:"bool"},{internalType:"address",name:"governanceToken",type:"address"},{internalType:"address",name:"fundAddress",type:"address"},{internalType:"address",name:"governor",type:"address"},{internalType:"string",name:"fundName",type:"string"},{internalType:"string",name:"fundSymbol",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"_feeBal",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"_navUpdateLatestIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"_navUpdateLatestTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"_totalDepositBal",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint32",name:"pos",type:"uint32"}],name:"checkpoints",outputs:[{components:[{internalType:"uint32",name:"fromBlock",type:"uint32"},{internalType:"uint224",name:"votes",type:"uint224"}],internalType:"struct ERC20VotesUpgradeable.Checkpoint",name:"",type:"tuple"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"delegatee",type:"address"}],name:"delegate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"delegatee",type:"address"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"expiry",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"delegateBySig",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"delegates",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"feeManagePeriod",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"feePerformancePeriod",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"fundMetadata",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"getCurrentPendingDepositBal",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"getCurrentPendingWithdrawalBal",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"enum IGovernableFundStorage.FundFeeType",name:"feeType",type:"uint8"}],name:"getFeeCollector",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"getFundSettings",outputs:[{components:[{internalType:"uint256",name:"depositFee",type:"uint256"},{internalType:"uint256",name:"withdrawFee",type:"uint256"},{internalType:"uint256",name:"performanceFee",type:"uint256"},{internalType:"uint256",name:"managementFee",type:"uint256"},{internalType:"uint256",name:"performaceHurdleRateBps",type:"uint256"},{internalType:"address",name:"baseToken",type:"address"},{internalType:"address",name:"safe",type:"address"},{internalType:"bool",name:"isExternalGovTokenInUse",type:"bool"},{internalType:"bool",name:"isWhitelistedDeposits",type:"bool"},{internalType:"address[]",name:"allowedDepositAddrs",type:"address[]"},{internalType:"address[]",name:"allowedManagers",type:"address[]"},{internalType:"address",name:"governanceToken",type:"address"},{internalType:"address",name:"fundAddress",type:"address"},{internalType:"address",name:"governor",type:"address"},{internalType:"string",name:"fundName",type:"string"},{internalType:"string",name:"fundSymbol",type:"string"},{internalType:"address[4]",name:"feeCollectors",type:"address[4]"}],internalType:"struct IGovernableFundStorage.Settings",name:"",type:"tuple"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"getFundStartTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getNavEntry",outputs:[{components:[{internalType:"enum IGovernableFundStorage.NavUpdateType",name:"entryType",type:"uint8"},{components:[{internalType:"address",name:"tokenPair",type:"address"},{internalType:"address",name:"aggregatorAddress",type:"address"},{internalType:"bytes",name:"functionSignatureWithEncodedInputs",type:"bytes"},{internalType:"address",name:"assetTokenAddress",type:"address"},{internalType:"address",name:"nonAssetTokenAddress",type:"address"},{internalType:"bool",name:"isReturnArray",type:"bool"},{internalType:"uint256",name:"returnLength",type:"uint256"},{internalType:"uint256",name:"returnIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"}],internalType:"struct IGovernableFundStorage.NAVLiquidUpdate[]",name:"liquid",type:"tuple[]"},{components:[{internalType:"uint256",name:"baseCurrencySpent",type:"uint256"},{internalType:"uint256",name:"amountAquiredTokens",type:"uint256"},{internalType:"address",name:"tokenAddress",type:"address"},{internalType:"bool",name:"isNFT",type:"bool"},{internalType:"string[]",name:"otcTxHashes",type:"string[]"},{internalType:"enum IGovernableFundStorage.NAVNFTType",name:"nftType",type:"uint8"},{internalType:"uint256",name:"nftIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"}],internalType:"struct IGovernableFundStorage.NAVIlliquidUpdate[]",name:"illiquid",type:"tuple[]"},{components:[{internalType:"address",name:"oracleAddress",type:"address"},{internalType:"address",name:"nftAddress",type:"address"},{internalType:"enum IGovernableFundStorage.NAVNFTType",name:"nftType",type:"uint8"},{internalType:"uint256",name:"nftIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"}],internalType:"struct IGovernableFundStorage.NAVNFTUpdate[]",name:"nft",type:"tuple[]"},{components:[{internalType:"address",name:"remoteContractAddress",type:"address"},{internalType:"string",name:"functionSignatures",type:"string"},{internalType:"bytes",name:"encodedFunctionSignatureWithInputs",type:"bytes"},{internalType:"uint256",name:"normalizationDecimals",type:"uint256"},{internalType:"bool",name:"isReturnArray",type:"bool"},{internalType:"uint256",name:"returnValIndex",type:"uint256"},{internalType:"uint256",name:"returnArraySize",type:"uint256"},{internalType:"enum IGovernableFundStorage.NAVComposableUpdateReturnType",name:"returnValType",type:"uint8"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"},{internalType:"bool",name:"isNegative",type:"bool"}],internalType:"struct IGovernableFundStorage.NAVComposableUpdate[]",name:"composable",type:"tuple[]"},{internalType:"bool",name:"isPastNAVUpdate",type:"bool"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateEntryIndex",type:"uint256"},{internalType:"string",name:"description",type:"string"}],internalType:"struct IGovernableFundStorage.NavUpdateEntry[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"uint256",name:"start",type:"uint256"},{internalType:"uint256",name:"end",type:"uint256"}],name:"getNavUpdateTime",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"getPastTotalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"getPastVotes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getVotes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"numCheckpoints",outputs:[{internalType:"uint32",name:"",type:"uint32"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_name_",type:"string"},{internalType:"string",name:"_symbol_",type:"string"},{components:[{internalType:"uint256",name:"depositFee",type:"uint256"},{internalType:"uint256",name:"withdrawFee",type:"uint256"},{internalType:"uint256",name:"performanceFee",type:"uint256"},{internalType:"uint256",name:"managementFee",type:"uint256"},{internalType:"uint256",name:"performaceHurdleRateBps",type:"uint256"},{internalType:"address",name:"baseToken",type:"address"},{internalType:"address",name:"safe",type:"address"},{internalType:"bool",name:"isExternalGovTokenInUse",type:"bool"},{internalType:"bool",name:"isWhitelistedDeposits",type:"bool"},{internalType:"address[]",name:"allowedDepositAddrs",type:"address[]"},{internalType:"address[]",name:"allowedManagers",type:"address[]"},{internalType:"address",name:"governanceToken",type:"address"},{internalType:"address",name:"fundAddress",type:"address"},{internalType:"address",name:"governor",type:"address"},{internalType:"string",name:"fundName",type:"string"},{internalType:"string",name:"fundSymbol",type:"string"},{internalType:"address[4]",name:"feeCollectors",type:"address[4]"}],internalType:"struct IGovernableFundStorage.Settings",name:"_fundSettings",type:"tuple"},{internalType:"address",name:"navCalculatorAddress",type:"address"},{internalType:"address",name:"fundDelgateCallFlowAddress",type:"address"},{internalType:"address",name:"fundDelgateCallNavAddress",type:"address"},{internalType:"string",name:"_fundMetadata",type:"string"},{internalType:"uint256",name:"_feePerformancePeriod",type:"uint256"},{internalType:"uint256",name:"_feeManagePeriod",type:"uint256"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"clock",outputs:[{internalType:"uint48",name:"",type:"uint48"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"CLOCK_MODE",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"pure",type:"function",constant:!0},{inputs:[{components:[{internalType:"uint256",name:"depositFee",type:"uint256"},{internalType:"uint256",name:"withdrawFee",type:"uint256"},{internalType:"uint256",name:"performanceFee",type:"uint256"},{internalType:"uint256",name:"managementFee",type:"uint256"},{internalType:"uint256",name:"performaceHurdleRateBps",type:"uint256"},{internalType:"address",name:"baseToken",type:"address"},{internalType:"address",name:"safe",type:"address"},{internalType:"bool",name:"isExternalGovTokenInUse",type:"bool"},{internalType:"bool",name:"isWhitelistedDeposits",type:"bool"},{internalType:"address[]",name:"allowedDepositAddrs",type:"address[]"},{internalType:"address[]",name:"allowedManagers",type:"address[]"},{internalType:"address",name:"governanceToken",type:"address"},{internalType:"address",name:"fundAddress",type:"address"},{internalType:"address",name:"governor",type:"address"},{internalType:"string",name:"fundName",type:"string"},{internalType:"string",name:"fundSymbol",type:"string"},{internalType:"address[4]",name:"feeCollectors",type:"address[4]"}],internalType:"struct IGovernableFundStorage.Settings",name:"_fundSettings",type:"tuple"},{internalType:"string",name:"_fundMetadata",type:"string"},{internalType:"uint256",name:"_feePerformancePeriod",type:"uint256"},{internalType:"uint256",name:"_feeManagePeriod",type:"uint256"}],name:"updateSettings",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"enum IGovernableFundStorage.NavUpdateType",name:"entryType",type:"uint8"},{components:[{internalType:"address",name:"tokenPair",type:"address"},{internalType:"address",name:"aggregatorAddress",type:"address"},{internalType:"bytes",name:"functionSignatureWithEncodedInputs",type:"bytes"},{internalType:"address",name:"assetTokenAddress",type:"address"},{internalType:"address",name:"nonAssetTokenAddress",type:"address"},{internalType:"bool",name:"isReturnArray",type:"bool"},{internalType:"uint256",name:"returnLength",type:"uint256"},{internalType:"uint256",name:"returnIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"}],internalType:"struct IGovernableFundStorage.NAVLiquidUpdate[]",name:"liquid",type:"tuple[]"},{components:[{internalType:"uint256",name:"baseCurrencySpent",type:"uint256"},{internalType:"uint256",name:"amountAquiredTokens",type:"uint256"},{internalType:"address",name:"tokenAddress",type:"address"},{internalType:"bool",name:"isNFT",type:"bool"},{internalType:"string[]",name:"otcTxHashes",type:"string[]"},{internalType:"enum IGovernableFundStorage.NAVNFTType",name:"nftType",type:"uint8"},{internalType:"uint256",name:"nftIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"}],internalType:"struct IGovernableFundStorage.NAVIlliquidUpdate[]",name:"illiquid",type:"tuple[]"},{components:[{internalType:"address",name:"oracleAddress",type:"address"},{internalType:"address",name:"nftAddress",type:"address"},{internalType:"enum IGovernableFundStorage.NAVNFTType",name:"nftType",type:"uint8"},{internalType:"uint256",name:"nftIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"}],internalType:"struct IGovernableFundStorage.NAVNFTUpdate[]",name:"nft",type:"tuple[]"},{components:[{internalType:"address",name:"remoteContractAddress",type:"address"},{internalType:"string",name:"functionSignatures",type:"string"},{internalType:"bytes",name:"encodedFunctionSignatureWithInputs",type:"bytes"},{internalType:"uint256",name:"normalizationDecimals",type:"uint256"},{internalType:"bool",name:"isReturnArray",type:"bool"},{internalType:"uint256",name:"returnValIndex",type:"uint256"},{internalType:"uint256",name:"returnArraySize",type:"uint256"},{internalType:"enum IGovernableFundStorage.NAVComposableUpdateReturnType",name:"returnValType",type:"uint8"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"},{internalType:"bool",name:"isNegative",type:"bool"}],internalType:"struct IGovernableFundStorage.NAVComposableUpdate[]",name:"composable",type:"tuple[]"},{internalType:"bool",name:"isPastNAVUpdate",type:"bool"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateEntryIndex",type:"uint256"},{internalType:"string",name:"description",type:"string"}],internalType:"struct IGovernableFundStorage.NavUpdateEntry[]",name:"navUpdateData",type:"tuple[]"},{internalType:"address[]",name:"pastNAVUpdateEntryFundAddress",type:"address[]"},{internalType:"bool",name:"processWithdraw",type:"bool"}],name:"updateNav",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"navExecutor",type:"address"}],name:"executeNAVUpdate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"flowCall",type:"bytes"}],name:"fundFlowsCall",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"totalWithrawalBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"uint8",name:"feeKind",type:"uint8"}],name:"calculateAccrued",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"enum IGovernableFundStorage.FundFeeType",name:"feeType",type:"uint8"}],name:"collectFees",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"toggleDaoFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"bps",type:"uint256"}],name:"setDaoFeeBps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"setDaoFeeAddr",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"ownr",type:"address"}],name:"valueOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"totalNAV",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0}]},Bt={calculateMetrics:async(e,t)=>{const n=await Pt(t,e);e.sharePrice=n,e.cumulativeReturnPercent=At(void 0,n,e.baseToken.decimals,e.fundToken.decimals)}},kt={calculateMetrics:async(e,t)=>{const n=t==null?void 0:t.timestamp,a=await Ot(e,t);console.debug("  [METRICS] lastNAVUpdateTotalDepositBalance",a);const s=e.baseToken.decimals;e.cumulativeReturnPercent=n?vt(a||0n,e.lastNAVUpdateTotalNAV||0n,s):0}},Rt=e=>{const t={"0xabc961afc18dfe9f062cf9a8046346e92a934d08":Bt},n=e.address.toLowerCase();return n in t?t[n]:kt},It=async e=>{if(!e){console.error("Error: this.fund is not available");return}try{const t=e.navUpdates,n=t[(t==null?void 0:t.length)-1],a=n==null?void 0:n.timestamp;console.debug("  [METRICS] title",e.title),console.debug("  [METRICS] totalDepositBalance",e.totalDepositBalance),console.debug("  [METRICS] fund.lastNAVUpdateTotalNAV",e.lastNAVUpdateTotalNAV),console.debug("  [METRICS] last NAV update",n),e&&(await Rt(e).calculateMetrics(e,n),e.lastNAVUpdateTotalNAV=a?e.lastNAVUpdateTotalNAV:e.totalDepositBalance,e.isNavUpdatesLoading=!1,e.sharpeRatio=gt(t,e.totalDepositBalance))}catch(t){console.error("Error calculating fund performance metrics: ",e,t),e.isNavUpdatesLoading=!1}},Pt=async(e,t)=>{if(e!=null&&e.timestamp){const n=A(),a=$e(),s=await a.initializeBlockTimeContext(t.chainId,!1),r=(s==null?void 0:s.averageBlockTime)||0,i=Te(String(e.totalNAV||"0"),t==null?void 0:t.baseToken.decimals),o=Number(await a.getBlockByTimestamp(t.chainId,e.timestamp/1e3,r)||0);try{const d=await n.callWithRetry(t.chainId,()=>n.getCustomContract(t.chainId,ne,t.fundToken.address).methods.totalSupply().call({},o)),u=Te(String(d||"0"),t.fundToken.decimals),p=t.baseToken.decimals,l=t.fundToken.decimals,y=p-l,m=y>0?i*10n**BigInt(y):i,f=y<0?u*10n**BigInt(-y):u,T=10n**36n,g=u>0n?m*T/f:0n;return parseFloat(ee(g,36))}catch(d){console.error("Error getting share price",d);return}}return 0},Ot=async(e,t)=>{if(t!=null&&t.timestamp){const n=A();let a=0;const{$getExplorer:s}=Oe();try{a=await s(e.chainId).getBlockNumberFromTimestamp(t.timestamp/1e3)}catch(r){console.error("Error getting block number from timestamp",r)}console.debug("  [METRICS] lastNavUpdateBlockNumber from EXPLORER",a);try{return await n.callWithRetry(e.chainId,async()=>{const r=n.getCustomContract(e.chainId,L.abi,e.address);return BigInt(await r.methods._totalDepositBal().call({},a)||0)})}catch(r){return console.error("Error getting total deposit balance at last NAV update",r),null}}return null},Je=e=>{const t=(e==null?void 0:e.entries)||[],n=Ce.reduce((a,s)=>(a[s]=0n,a),{});if(t)for(const a of t)a.positionType===E.Composable?a.details.composable[0].functionSignatures.includes("illiquidCalc")?n[E.Illiquid]+=a.pastNavValue||0n:a.details.composable[0].functionSignatures.includes("liquidCalc")?n[E.Liquid]+=a.pastNavValue||0n:n[a.positionType]+=a.pastNavValue||0n:n[a.positionType]+=a.pastNavValue||0n;return Ce.map(a=>(e&&e.navParts&&(n[E.Liquid]+=(e.navParts.baseAssetOIVBal||0n)+(e.navParts.feeBal||0n)+(e.navParts.baseAssetSafeBal||0n)),{type:Ft[a],count:n[a].toString()}))};function Lt(e){return h(`fetchFundLatestSnapshot_${e.chainId}_${e.address}`,()=>qt(e))}function _t(e,t){return h(`fetchFundLatestSnapshots_${e}`,()=>Ht(e,t))}async function qt(e){console.warn("FETCH LATEST SNAPSHOT Fund ",e.chainId,e.address);const t=Ae(),n=await fetch(`${t.public.BACKEND_URL}/nav/latest-snapshot/${e.address}?fundChainId=${e.chainId}`);if(!n.ok)return console.error(`Failed to fetch latest snapshot for fund ${e.chainId} ${e.address}:`,n.statusText),e;const a=await n.json();return console.warn("Fund ",e.chainId,e.address," NAV SNAPSHOT",a),je(e,a)}async function Ht(e,t){console.warn("FETCH LATEST SNAPSHOTS ChainId ",e);const n=Ae();try{const a=t.map(i=>i.address),s=await fetch(`${n.public.BACKEND_URL}/nav/latest-snapshots`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fundChainId:e,fundAddresses:a})});if(!s.ok)return console.error(`Failed to fetch latest snapshot for chain ${e}:`,s.statusText),t;const r=await s.json();return console.warn("Funds chainId ",e," NAV SNAPSHOTS",r),t.map(i=>je(i,r.find(o=>o.fundAddress===i.address)))}catch(a){return console.error(`Error fetching latest snapshot for ChainId ${e}:`,a),t}}const je=(e,t)=>{var s,r;let n;try{t!=null&&t.calculatedAt&&(n=Nt(new Date(t==null?void 0:t.calculatedAt)))}catch(i){console.error(i)}const a=(s=e==null?void 0:e.positionTypeCounts)!=null&&s.length?e==null?void 0:e.positionTypeCounts:(r=t==null?void 0:t.positionTypeCounts)!=null&&r.length?t==null?void 0:t.positionTypeCounts:[];return{...e,totalSimulatedNavCalculatedAt:n,totalSimulatedNav:BigInt((t==null?void 0:t.totalSimulatedNav)||0),totalSimulatedNavFormatted:t==null?void 0:t.totalSimulatedNavFormatted,totalSimulatedNavUSD:t==null?void 0:t.totalSimulatedNavUSD,totalSimulatedNavUSDFormatted:t==null?void 0:t.totalSimulatedNavUSDFormatted,totalDepositBalance:t==null?void 0:t.totalDepositBalance,sharpeRatio:t==null?void 0:t.sharpeRatio,lastNAVUpdateTotalNAV:t==null?void 0:t.totalNAV,cumulativeReturnPercent:t==null?void 0:t.cumulativeReturnPercent,positionTypeCounts:a,isNavUpdatesLoading:!1}};function Gt(e){return e.length?_t(e[0].chainId,e):Promise.resolve([])}const Wt=async(e,t)=>{const n=S();n.resetFundData(e,t),n.selectedFundChain=e,n.selectedFundAddress=t;try{await n.fetchFundMetaData(e,t),await n.fetchFundNAVData(),n.fund&&Lt(n.fund).then(a=>{console.warn("TTT fetchFundLatestSnapshotAction DONE111",e,t,a),Object.assign(n.fund,a),console.warn("TTT fetchFundLatestSnapshotAction DONE222",e,t,n.fund)}).catch(a=>{console.error(`Failed fetching latest snapshot for ${t}`,a),$t(n.fund),n.calculateFundPerformanceMetrics(n.fund)}),n.fetchUserFundData(e,t),n.fetchFundPendingDepositRedemptionBalance()}catch(a){throw console.error(`Failed fetching fund data for ${t}`,a),a}},$t=e=>{var a;if(!e||!((a=e.navUpdates)!=null&&a.length))return;const t=e.navUpdates,n=t[t.length-1];e.positionTypeCounts=Je(n)},ae=""+new URL("default_avatar.5CRjHovZ.webp",import.meta.url).href,Jt=e=>{const t=new URLSearchParams(e),n=t.get("mode")||"",a=t.get("from");return n in Ue||console.error("Fund clock mode is not in valid options: ",n,e),{mode:Ue[n],...a?{from:a}:{}}},jt=e=>{const t={};return Object.entries(e).forEach(([n,a])=>{const s=n;t[s]=typeof a=="bigint"?a.toString():a}),t},Qe={[x.POLYGON]:[{address:"0x0dCd5D9cF6DFF56E7Ce2cbed1d39369e1B5f2ac4",strategistName:"ShineDAO",strategistUrl:"https://discord.gg/HMhRGBnxub",subtitle:"DAO treasury of community funding and supporting DeFi."},{address:"0xBE0B0C435EA1156F76d3E116Fbd5606743ab179a",strategistName:"The DAO of Capital",strategistUrl:"https://discord.gg/punj9gPZP3",subtitle:"BTC, ETH, stables and gold. Growth, yield, and resilience in one portfolio."},{address:"0xFc3de74eA28474FF02e378F5F8658354E481d7B9",strategistName:"The DAO of Capital",strategistUrl:"https://discord.gg/punj9gPZP3",subtitle:"USDC, USDT and DAI stablecoin staking via AAVE."},{address:"0xc748d5E77B998608Ef84d063b9694f2dBB81a325",strategistName:"soonami.io",strategistUrl:"https://soonami.io/venture-staking",subtitle:"Investing in pre-seed projects through Foundance platform."}],[x.BASE]:[{address:"0x533f164d91e3F8169a7043f7094f44af87Fb7CA4",strategistName:"INDEFI",strategistUrl:"https://indefi.io/",subtitle:"Volatility-driven rebalancing with sustained exposure to ETH appreciation."}],[x.ARBITRUM]:[{address:"0x00a4DCBBB7Eb5d0c4Ef33Ab9763DDE5Cd91A4b10",strategistName:"Flex.hl",strategistUrl:"https://x.com/kinzflx",subtitle:"Adaptive perps strategy built to survive chop and thrive in runs."},{address:"0x5E0f37920DDee57dAbAf5A73B21D51075AeDbEBE",strategistName:"Harmonix",strategistUrl:"https://harmonix.fi/"},{address:"0xABC961AFc18dfE9F062cf9a8046346E92a934D08",strategistName:"QuantCheck Labs",strategistUrl:"https://www.quantchecklabs.com/",subtitle:"Quant-driven perps strategy powered by cross-asset analytics."},{address:"0x5A7638b7b831262081804e88657b2D83E8491b1E",strategistName:"carrotfunding.io",strategistUrl:"https://carrotfunding.io"},{address:"0x58BA86cF363De2Bdbe57ad885B47F1B985EA9F31",strategistName:"Trader Funding",strategistUrl:"",subtitle:"Trader funding vault backing consistently profitable perps traders."}],[x.ETHEREUM]:[{address:"0xaC3D76E29f866702E17f571cccb15937E5A17303",strategistName:"soonami.io",strategistUrl:"https://soonami.io/venture-staking",subtitle:"Native ETH staking and reinvesting yield into soonami.io ecosystem."}]},Qt=async(e,t)=>{var i,o;const n=A(),a=$e(),s=S(),r=(i=n.chainContracts[e])==null?void 0:i.rethinkReaderContract;try{console.debug("getFundMetaData",t,e,r);const d=await n.callWithRetry(e,()=>r.methods.getFundMetaData(t).call());console.log("fundMetaData",d);const{startTime:u,totalDepositBal:p,feeBalance:l,feePerformancePeriod:y,feeManagePeriod:m,fundTokenDecimals:f,fundBaseTokenDecimals:T,fundGovernanceTokenDecimals:g,fundTokenSupply:c,fundGovernanceTokenSupply:R,safeContractBaseTokenBalance:P,fundContractBaseTokenBalance:H,fundMetadata:V,fundBaseTokenSymbol:M,fundGovernanceTokenSymbol:U,fundGovernanceData:z,fundSettings:N}=d,{votingDelay:oe,votingPeriod:de,proposalThreshold:G,lateQuorumVoteExtension:W,quorumNumerator:ue,quorumDenominator:pe,clockMode:rt}=z;N.performancePeriod=y,N.managementPeriod=m,console.debug("fundSettings: ",N);const b=jt(N),$=Jt(rt);console.debug("parsedClockMode: ",$),console.log("parsedFundSettings: ",b),console.debug("fundGovernanceTokenSupply: ",R);const it=n.getCustomContract(e,ne,(b==null?void 0:b.governanceToken)??""),X=await n.callWithRetry(e,()=>it.methods.totalSupply().call());R!==X&&console.warn("[MISMATCH] fundGovernanceTokenSupply: ",R,"fundGovernanceTokenSupplyFixed: ",X);const Ee=X*ue/pe,Z=await a.initializeBlockTimeContext(e),le=(Z==null?void 0:Z.averageBlockTime)||0;console.warn("fetchFundMetaDataAction blockTimeContext",Z);const we=O[e],xe=void 0,B={originalFundSettings:b,lastNAVUpdateTotalNAV:void 0,chainId:e,chainName:we.chainName,chainShort:we.chainShort,address:b.fundAddress||"",title:b.fundName||"N/A",clockMode:$,description:"N/A",safeAddress:b.safe||"",governorAddress:b.governor||"",photoUrl:ae,inceptionDate:u?Q(new Date(Number(u)*1e3)):"",lastNavUpdateTime:xe?Q(new Date(Number(xe)*1e3)):"",fundToken:{symbol:b.fundSymbol,address:b.fundAddress,decimals:Number(f)??18},baseToken:{symbol:M??"",address:b.baseToken,decimals:Number(T)??18},governanceToken:{symbol:U??"",address:b.governanceToken,decimals:Number(g)??18},totalDepositBalance:p||BigInt("0"),governanceTokenTotalSupply:X,fundTokenTotalSupply:c,netDeposits:"",isWhitelistedDeposits:b.isWhitelistedDeposits,allowedDepositAddresses:b.allowedDepositAddrs,allowedManagerAddresses:b.allowedManagers,plannedSettlementPeriod:"",minLiquidAssetShare:"",votingDelay:ce(oe,le,$.mode),votingPeriod:ce(de,le,$.mode),proposalThreshold:!G&&G!==0n?"N/A":`${Et(G)} ${U||"votes"}`,quorumVotes:Ee,quorumVotesFormatted:te(Ee,g),quorumNumerator:ue,quorumDenominator:pe,quorumPercentage:St(ue,pe),lateQuorum:ce(W,le,$.mode),depositFee:b.depositFee.toString(),depositFeeAddress:b.feeCollectors[0],withdrawFee:b.withdrawFee.toString(),withdrawFeeAddress:b.feeCollectors[1],managementPeriod:b.managementPeriod.toString(),managementFee:b.managementFee.toString(),managementFeeAddress:b.feeCollectors[2],performancePeriod:b.performancePeriod.toString(),performanceFee:b.performanceFee.toString(),performanceFeeAddress:b.feeCollectors[3],performaceHurdleRateBps:b.performaceHurdleRateBps,feeCollectors:b.feeCollectors,feeBalance:l*-1n,safeContractBaseTokenBalance:P,fundContractBaseTokenBalance:H,navUpdates:[]};if(console.log("fund fund: ",B),V){const w=JSON.parse(V),{strategistName:ot,strategistUrl:dt,oivChatUrl:ut}=((o=Qe[e])==null?void 0:o.find(ye=>(ye==null?void 0:ye.address)===t))||{strategistName:"",strategistUrl:"",oivChatUrl:""};B.description=w.description,B.photoUrl=w.photoUrl||ae,B.plannedSettlementPeriod=w.plannedSettlementPeriod,B.minLiquidAssetShare=w.minLiquidAssetShare,B.strategistName=(w==null?void 0:w.strategistName)||ot,B.strategistUrl=(w==null?void 0:w.strategistUrl)||dt,B.oivChatUrl=(w==null?void 0:w.oivChatUrl)||ut}return s.chainFunds[e][t]=B,B}catch(d){return console.error("Error in promises: ",d,"fund: ",t),{}}},Ye={abi:[{inputs:[{internalType:"address",name:"oiv",type:"address"},{internalType:"bytes",name:"data",type:"bytes"}],name:"storeNAVData",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"oiv",type:"address"}],name:"getNAVData",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function",constant:!0}]};var re=(e=>(e[e.DepositFee=0]="DepositFee",e[e.WithdrawFee=1]="WithdrawFee",e[e.ManagementFee=2]="ManagementFee",e[e.PerformanceFee=3]="PerformanceFee",e))(re||{});const Yt=L.abi.find(e=>e.name==="collectFees"&&e.type==="function"),Fe=e=>Y(Yt,[e]),Kt=Fe(re.DepositFee),zt=Fe(re.ManagementFee),Xt=Fe(re.PerformanceFee),Zt=(e,t)=>{const n={value:[{isArray:!1,data:"1",internalType:"uint16",name:"role"},{isArray:!1,data:null,internalType:"address",name:"targetAddress"},{isArray:!1,data:null,internalType:"bytes4",name:"functionSig"},{isArray:!0,data:[],internalType:"bool[]",name:"isParamScoped"},{isArray:!0,data:[],internalType:"enum ParameterType[]",name:"paramType"},{isArray:!0,data:[],internalType:"enum Comparison[]",name:"paramComp"},{isArray:!0,data:[],internalType:"bytes[]",name:"compValue"},{isArray:!1,data:"1",internalType:"enum ExecutionOptions",name:"options"}],valueMethodIdx:19},a={value:[{idx:0,isArray:!1,data:"1",internalType:"uint16",name:"role"},{idx:1,isArray:!1,data:null,internalType:"address",name:"targetAddress"}],valueMethodIdx:24};n.value[1].data=e,a.value[1].data=e,n.value[2].data="0xa61f5814";const s=["0x000000000000000000000000"+t.slice(2)],r=[!0],i=["0"];return n.value[3].data=r,n.value[4].data=i,n.value[5].data=i,n.value[6].data=s,[n,a]},en=e=>{var t;return((t=e.find(n=>"pastNAVUpdateIndex"in n))==null?void 0:t.pastNAVUpdateIndex)??0},tn=JSON.parse('[{"inputs":[{"internalType":"address","name":"_owner","type":"address"},{"internalType":"address","name":"_avatar","type":"address"},{"internalType":"address","name":"_target","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"ArraysDifferentLength","type":"error"},{"inputs":[],"name":"ModuleTransactionFailed","type":"error"},{"inputs":[],"name":"NoMembership","type":"error"},{"inputs":[],"name":"SetUpModulesAlreadyCalled","type":"error"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"},{"indexed":false,"internalType":"uint16[]","name":"roles","type":"uint16[]"},{"indexed":false,"internalType":"bool[]","name":"memberOf","type":"bool[]"}],"name":"AssignRoles","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousAvatar","type":"address"},{"indexed":true,"internalType":"address","name":"newAvatar","type":"address"}],"name":"AvatarSet","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"guard","type":"address"}],"name":"ChangedGuard","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"}],"name":"DisabledModule","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"}],"name":"EnabledModule","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"initiator","type":"address"},{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"avatar","type":"address"},{"indexed":false,"internalType":"address","name":"target","type":"address"}],"name":"RolesModSetup","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"},{"indexed":false,"internalType":"uint16","name":"defaultRole","type":"uint16"}],"name":"SetDefaultRole","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"multisendAddress","type":"address"}],"name":"SetMultisendAddress","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousTarget","type":"address"},{"indexed":true,"internalType":"address","name":"newTarget","type":"address"}],"name":"TargetSet","type":"event"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"enum ExecutionOptions","name":"options","type":"uint8"}],"name":"allowTarget","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"module","type":"address"},{"internalType":"uint16[]","name":"_roles","type":"uint16[]"},{"internalType":"bool[]","name":"memberOf","type":"bool[]"}],"name":"assignRoles","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"avatar","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"defaultRoles","outputs":[{"internalType":"uint16","name":"","type":"uint16"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"prevModule","type":"address"},{"internalType":"address","name":"module","type":"address"}],"name":"disableModule","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"module","type":"address"}],"name":"enableModule","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"}],"name":"execTransactionFromModule","outputs":[{"internalType":"bool","name":"success","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"}],"name":"execTransactionFromModuleReturnData","outputs":[{"internalType":"bool","name":"","type":"bool"},{"internalType":"bytes","name":"","type":"bytes"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"},{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"bool","name":"shouldRevert","type":"bool"}],"name":"execTransactionWithRole","outputs":[{"internalType":"bool","name":"success","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"},{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"bool","name":"shouldRevert","type":"bool"}],"name":"execTransactionWithRoleReturnData","outputs":[{"internalType":"bool","name":"success","type":"bool"},{"internalType":"bytes","name":"returnData","type":"bytes"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getGuard","outputs":[{"internalType":"address","name":"_guard","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"start","type":"address"},{"internalType":"uint256","name":"pageSize","type":"uint256"}],"name":"getModulesPaginated","outputs":[{"internalType":"address[]","name":"array","type":"address[]"},{"internalType":"address","name":"next","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"guard","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_module","type":"address"}],"name":"isModuleEnabled","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"multisend","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"}],"name":"revokeTarget","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"},{"internalType":"enum ExecutionOptions","name":"options","type":"uint8"}],"name":"scopeAllowFunction","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"},{"internalType":"bool[]","name":"isParamScoped","type":"bool[]"},{"internalType":"enum ParameterType[]","name":"paramType","type":"uint8[]"},{"internalType":"enum Comparison[]","name":"paramComp","type":"uint8[]"},{"internalType":"bytes[]","name":"compValue","type":"bytes[]"},{"internalType":"enum ExecutionOptions","name":"options","type":"uint8"}],"name":"scopeFunction","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"},{"internalType":"enum ExecutionOptions","name":"options","type":"uint8"}],"name":"scopeFunctionExecutionOptions","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"},{"internalType":"uint256","name":"paramIndex","type":"uint256"},{"internalType":"enum ParameterType","name":"paramType","type":"uint8"},{"internalType":"enum Comparison","name":"paramComp","type":"uint8"},{"internalType":"bytes","name":"compValue","type":"bytes"}],"name":"scopeParameter","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"},{"internalType":"uint256","name":"paramIndex","type":"uint256"},{"internalType":"enum ParameterType","name":"paramType","type":"uint8"},{"internalType":"bytes[]","name":"compValues","type":"bytes[]"}],"name":"scopeParameterAsOneOf","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"}],"name":"scopeRevokeFunction","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"}],"name":"scopeTarget","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_avatar","type":"address"}],"name":"setAvatar","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"module","type":"address"},{"internalType":"uint16","name":"role","type":"uint16"}],"name":"setDefaultRole","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_guard","type":"address"}],"name":"setGuard","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_multisend","type":"address"}],"name":"setMultisend","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_target","type":"address"}],"name":"setTarget","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes","name":"initParams","type":"bytes"}],"name":"setUp","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"target","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"},{"internalType":"uint8","name":"paramIndex","type":"uint8"}],"name":"unscopeParameter","outputs":[],"stateMutability":"nonpayable","type":"function"}]'),nn={abi:tn};var j=(e=>(e[e.NONE=0]="NONE",e[e.SEND=1]="SEND",e[e.DELEGATE_CALL=2]="DELEGATE_CALL",e[e.BOTH=3]="BOTH",e))(j||{}),an=(e=>(e[e.REMOVE=0]="REMOVE",e[e.PENDING=1]="PENDING",e[e.NONE=2]="NONE",e))(an||{}),v=(e=>(e.EQUAL_TO="EqualTo",e.ONE_OF="OneOf",e.GREATER_THAN="GreaterThan",e.LESS_THAN="LessThan",e))(v||{}),C=(e=>(e.STATIC="Static",e.DYNAMIC="Dynamic",e.DYNAMIC32="Dynamic32",e.NO_RESTRICTION="NoRestriction",e))(C||{}),F=(e=>(e[e.INT=0]="INT",e[e.UINT=1]="UINT",e[e.BOOLEAN=2]="BOOLEAN",e[e.BYTES=3]="BYTES",e[e.BYTES_FIXED=4]="BYTES_FIXED",e[e.ADDRESS=5]="ADDRESS",e[e.STRING=6]="STRING",e[e.ARRAY=7]="ARRAY",e[e.TUPLE=8]="TUPLE",e[e.UNSUPPORTED=9]="UNSUPPORTED",e))(F||{}),se=(e=>(e.BLOCKED="None",e.WILDCARDED="Target",e.SCOPED="Function",e))(se||{}),sn=(e=>(e[e.SCOPE_TARGET=0]="SCOPE_TARGET",e[e.SCOPE_FUNCTION=1]="SCOPE_FUNCTION",e[e.SCOPE_PARAM=2]="SCOPE_PARAM",e[e.UPDATE_FUNCTION_EXECUTION_OPTION=3]="UPDATE_FUNCTION_EXECUTION_OPTION",e))(sn||{});function la(e){return e.some(t=>t)?se.SCOPED:se.BLOCKED}var rn=(e=>(e.FALSE="false",e.TRUE="true",e))(rn||{});const ya={[v.EQUAL_TO]:"is equal to",[v.ONE_OF]:"is one of",[v.GREATER_THAN]:"is greater than",[v.LESS_THAN]:"is less than"};function on(e){var t;return e?e.baseType==="address"?F.ADDRESS:e.baseType==="string"?F.STRING:e.baseType==="bool"?F.BOOLEAN:e.baseType==="tuple"?F.TUPLE:e.baseType.startsWith("uint")?F.UINT:e.baseType.startsWith("int")?F.INT:e.baseType==="array"?((t=e.arrayChildren)==null?void 0:t.baseType)==="array"?F.UNSUPPORTED:F.ARRAY:e.baseType.startsWith("bytes")&&e.baseType!=="bytes"?F.BYTES_FIXED:F.BYTES:F.UNSUPPORTED}function ca(e){switch(e){case F.UINT:return[v.EQUAL_TO,v.ONE_OF,v.LESS_THAN,v.GREATER_THAN];case F.BOOLEAN:return[v.EQUAL_TO]}return[v.EQUAL_TO,v.ONE_OF]}function ma(e){return!(e!=null&&e.type)||e.type===se.BLOCKED}function fa(e){return e===F.ARRAY?C.DYNAMIC32:e===F.BYTES||e===F.STRING?C.DYNAMIC:C.STATIC}function Ne(e){return e.stateMutability?!["view","pure"].includes(e.stateMutability):!0}const Ta=e=>{if(!e)return[];const t=new pt(e),n=[];return t.forEachFunction(a=>{Ne(a)&&n.push(a)}),n};function ba(e,t){const n=on(e);return n===F.ARRAY||n===F.TUPLE?JSON.parse(t):t}function ha(e){switch(e){case v.EQUAL_TO:return 0;case v.GREATER_THAN:return 1;case v.LESS_THAN:return 2;case v.ONE_OF:return 3}}const ga={0:v.EQUAL_TO,1:v.GREATER_THAN,2:v.LESS_THAN,3:v.ONE_OF};function Aa(e){switch(e){case C.STATIC:return 0;case C.DYNAMIC:return 1;case C.DYNAMIC32:return 2;case C.NO_RESTRICTION:throw new Error("No restriction should not go on chain. This should be unscoped via unscopeParameter")}}const va={0:C.STATIC,1:C.DYNAMIC,2:C.DYNAMIC32,3:C.NO_RESTRICTION},Fa={0:j.NONE,1:j.SEND,2:j.DELEGATE_CALL,3:j.BOTH},Ke=e=>e.liquid.map(t=>[t.tokenPair||me,t.aggregatorAddress||"",t.functionSignatureWithEncodedInputs||"0x",t.assetTokenAddress||"",t.nonAssetTokenAddress||me,t.isReturnArray||!1,parseInt(t.returnLength)||0,parseInt(t.returnIndex)||0,parseInt(t.pastNAVUpdateIndex)||0]),ze=(e,t)=>{if(!t)throw new Error("Failed preparing NAV Illiquid method, base decimals are not known.");return e.illiquid.map(n=>{var s,r;const a=((s=n.otcTxHashes)==null?void 0:s.map(i=>i.trim()).filter(i=>i!==""))||[];return[Te(((r=n.baseCurrencySpent)==null?void 0:r.toString())??"0",t),parseInt(n.amountAquiredTokens)||0,n.tokenAddress,n.isNFT,a,parseInt(n.nftType)||0,parseInt(n.nftIndex)||0,parseInt(n.pastNAVUpdateIndex)||0]})},Xe=e=>e.nft.map(t=>[t.oracleAddress,t.nftAddress,t.nftType,parseInt(t.nftIndex)||0,parseInt(t.pastNAVUpdateIndex)||0]),Ze=e=>e.composable.map(t=>[t.remoteContractAddress,t.functionSignatures,t.encodedFunctionSignatureWithInputs,parseInt(t.normalizationDecimals)||0,t.isReturnArray,parseInt(t.returnValIndex)||0,parseInt(t.returnArraySize)||0,parseInt(t.returnValType)||0,parseInt(t.pastNAVUpdateIndex)||0,t.isNegative]),et=e=>{var n;if(!e)return;const t=e.internalType??"";if(e.isArray){const a=[];for(let s=0;s<((n=e.data)==null?void 0:n.length);s++)t.startsWith("address")||t.startsWith("bytes")||t.startsWith("int")||t.startsWith("uint")||t.startsWith("enum")?a.push(e.data[s]):t.startsWith("bool")&&(typeof e.data[s]=="boolean"?a.push(e.data[s]):a.push(e.data[s]==="true"));return a}if(t.startsWith("address"))return e.data;if(t.startsWith("bytes"))return e.data;if(t.startsWith("int"))return e.data;if(t.startsWith("uint"))return e.data;if(t.startsWith("enum"))return e.data;if(t.startsWith("bool"))return typeof e.data=="boolean"?e.data:e.data==="true"},Se=(e,t)=>{let n;const a=wt[t.entryType];try{t.description===""?n={}:n=JSON.parse(t.description??"{}")}catch(o){console.warn("Failed to parse NAV entry JSON description string: ",o)}const s=xt(t),r=Mt(s);let i=a;return a===E.Composable&&(s.composable[0].functionSignatures.includes("illiquidCalc")?i=E.Illiquid:s.composable[0].functionSignatures.includes("liquidCalc")&&(i=E.Liquid)),{index:e,positionType:a,displayPositionType:i,positionName:n==null?void 0:n.positionName,valuationSource:n==null?void 0:n.valuationSource,details:s,detailsJson:r,detailsHash:Le(lt(r))}};var dn=(e=>(e.Setup="setup",e.Details="details",e))(dn||{});const Na={setup:{name:"Permission Setup",formTitle:"Set up Permission Function",key:"setup"},details:{name:"Proposal Details",formTitle:"Provide Proposal Information",key:"details"}},ie=nn.abi.filter(e=>e.type==="function"),un=ie.filter(e=>Ne(e)),pn={};ie.forEach((e,t)=>{e.name&&(pn[e.name]=t)});const Ve=ie.map((e,t)=>({title:e.name,value:e.name,valueMethodIdx:t,isWriteFunction:Ne(e)})).filter(e=>e.isWriteFunction),ln={label:"Contract Method",key:"contractMethod",type:I.Select,defaultValue:Ve[0].value,choices:Ve},yn=e=>{const t=["uint","int"],n=["address","bytes"],a=["bool"],s="E.g. 0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045";let r=I.Text,i=`E.g. ${e.type}`.replace("[]",""),o=[D.required],d=[],u;if(t.some(p=>e.type.includes(p)))r=I.Number,e.type.includes("uint8")?o=[D.required,D.isValidUint8]:e.type.includes("uint16")&&(o=[D.required,D.isValidUint16]);else if(n.some(p=>e.type.includes(p))){if(o=[D.required],e.type.includes("address")&&(i=s,o.push(D.isValidAddress)),e.type.includes("bytes")){const p=Number(e.type.replace(/\D/g,""));p!==0&&(i=`E.g. 0x${"00".repeat(p)}`,o.push(D.isValidByteLength(p))),o.push(D.isValidHexString)}}else a.some(p=>e.type.includes(p))&&(r=I.Select,d=[{title:"true",value:!0},{title:"false",value:!1}],u=!1);return{label:e.name,key:e.name,internalType:e.internalType,input:e,type:r,rules:o,placeholder:i,isArray:e.type.includes("[]"),choices:d,defaultValue:u}},Sa=(e,t)=>{const n=[],a=[],s=[];for(let r=0;r<t.length;r++){const i=t[r],o=tt[i.contractMethod].filter(u=>u.key!=="contractMethod").map(u=>et({...u,data:i[u.key]}));console.warn("roleModFunctionData",i.contractMethod,o),console.warn("roleModWriteFunctionAbiMap[trx.contractMethod]",be[i.contractMethod]);const d=Y(be[i.contractMethod],o);n.push(d),a.push(e),s.push(0)}return{encodedRoleModEntries:n,targets:a,gasValues:s}},be={},tt=un.reduce((e,t)=>{be[t.name]=t;const n=t.inputs.map(yn),a=JSON.parse(JSON.stringify(ln));return a.defaultValue=t.name,e[t.name]=[a,...n],e},{}),Ea={setup:tt,details:[{label:"Proposal Title",key:"proposalTitle",type:I.Text,placeholder:"E.g. Proposal Title",charLimit:150,rules:[D.required,D.charLimit(150)]},{label:"Proposal Description",key:"proposalDescription",type:I.Textarea,placeholder:"E.g. Proposal Description",rules:[D.required]},{label:"Transactions Overview",key:"transactionsOverview",type:I.ReadonlyJSON,required:!1},{label:"Transactions Raw JSON",key:"transactionsRawJSON",type:I.ReadonlyJSON,required:!1}]},nt=L.abi.find(e=>e.name==="updateNav"&&e.type==="function"),cn=Ye.abi.find(e=>e.name==="storeNAVData"&&e.type==="function"),wa=(e,t,n=!1)=>{const a=[],s=[];for(const i of e){if(i.deleted)continue;const o=JSON.parse(JSON.stringify(i.details));i.pastNAVUpdateEntryFundAddress&&s.push(i.pastNAVUpdateEntryFundAddress);let d=0;if(i.positionType===E.Liquid)o.liquid=Ke(o);else if(i.positionType===E.Illiquid){if(!t)throw new Error("Failed preparing NAV method, base decimals are not known.");o.illiquid=ze(o,t)}else i.positionType===E.NFT?o.nft=Xe(o):i.positionType===E.Composable&&(o.composable=Ze(o));d=en(o[i.positionType]);let u=o.description;typeof u=="object"&&u!==null&&(u=JSON.stringify(o.description)),a.push([parseInt(o.entryType),J(o.liquid),J(o.illiquid),J(o.nft),J(o.composable),o.isPastNAVUpdate,d,parseInt(o.pastNAVUpdateEntryIndex),u])}console.log("navUpdateEntries: ",a),console.log("pastNavUpdateEntryAddresses: ",s),console.log("processWithdraw: ",n);const r=Y(nt,[a,s,n]);return console.log("encodedNavUpdateEntries: ",r),r},mn=e=>yt(nt,e),xa=(e,t,n=!1,a=!1,s=!1)=>{const r=[t],i=[0],o=[e];return console.log("NAV collectFlowFees: ",n),n&&(r.push(t),i.push(0),o.push(Kt)),console.log("NAV collectManagementFees: ",a),a&&(r.push(t),i.push(0),o.push(zt)),console.log("NAV collectPerformanceFees: ",s),s&&(r.push(t),i.push(0),o.push(Xt)),{targets:r,gasValues:i,calldatas:o}},Ma=(e,t,n,a)=>{const{getNAVExecutorBeaconProxyAddress:s}=K(),r=s(n),i=Y(cn,[t,e]),o=fn(t,n,a);return console.warn("encodedNavUpdateEntries",t,e),console.warn("encodedDataStoreNAVDataNavUpdateEntries",i),{targets:[r].concat(o.targets),gasValues:[0].concat(o.gasValues),calldatas:[i].concat(o.calldatas)}},fn=(e,t,n)=>{const{getNAVExecutorBeaconProxyAddress:a}=K(),s=a(t),r=Zt(e,s),[i,o,d]=Tn(r,n);return{targets:o,gasValues:d,calldatas:i}},Tn=(e,t)=>{console.log("roleModAddress: ",t);const n=[],a=[],s=[];for(let r=0;r<e.length;r++){const i=ie[e[r].valueMethodIdx];console.log("roleModFunctionABI: ",JSON.stringify(i,null,2));const o=[];for(let u=0;u<e[r].value.length;u++)o.push(et(e[r].value[u]));const d=Y(i,o);console.log("roleModFunctionData: ",r,JSON.stringify(o,null,2)),n.push(d),a.push(t),s.push(0)}return[n,a,s]},at={[x.POLYGON]:{},[x.ARBITRUM]:{},[x.ETHEREUM]:{},[x.BASE]:{"0x533f164d91e3F8169a7043f7094f44af87Fb7CA4":[69]}},bn=async(e,t)=>{try{const n=JSON.parse(JSON.stringify(J(t),qe),He);await _e.setItem(e,n),console.log(`Saved data to ${e}`)}catch(n){console.error(`Error saving data to ${e}:`,n)}},hn=async(e,t={})=>{try{return await _e.getItem(e)||t}catch(n){return console.error(`Error loading data from ${e}:`,n),null}},gn=async()=>{var r,i;const e=S(),t=A(),n=e.fund;if(!n||!(n!=null&&n.address))return;const a=(r=t.chainContracts[n.chainId])==null?void 0:r.rethinkReaderContract;try{const o=await t.callWithRetry(n.chainId,()=>a.methods.getFundNAVData(n==null?void 0:n.address).call());let d=await e.parseFundNAVUpdates(n.chainId,o,e.selectedFundAddress);console.log("FUND NAV DATA",d);const u=((i=at[n.chainId])==null?void 0:i[n.address])||[];if(d=u.length?d.filter(l=>!u.includes(l.index)):d,!d.length){const l=await An(n.chainId,n.address);console.log("FETCHED GET NAV DATA",l),e.fundInitialNAVMethods=await Be(e.selectedFundAddress,l),e.fundManagedNAVMethods=e.fundInitialNAVMethods,e.refreshSimulateNAVCounter++}const p=d[d.length-1];n.lastNAVUpdateTotalNAV=d.length?p.totalNAV||0n:n.totalDepositBalance||0n,n.navUpdates=d}catch(o){console.error("Error calling getNAVDataForFund: ",o,"fund: ",n==null?void 0:n.address)}const s=JSON.parse(JSON.stringify(e.fundLastNAVUpdateMethods,qe),He);e.fundManagedNAVMethods=await Be(e.selectedFundAddress,s),e.refreshSimulateNAVCounter++},An=async(e,t)=>{const n=A(),a=[];console.debug("getNAVData",e,t);const{getNAVExecutorBeaconProxyAddress:s}=K(),r=s(e);if(!t)return a;try{const i=n.getCustomContract(e,Ye.abi,r),o=await n.callWithRetry(e,()=>i.methods.getNAVData(t).call(),1,[310]),d=mn(o);for(const[u,p]of d.navUpdateData.entries()){const l=Se(u,p);a.push(l)}}catch(i){if(i.code!==ct)throw console.error("Failed loading NAV methods data from getNAVData.",i),i}return console.debug("getNAVData parsed NAV methods",e,t,a),a},Be=async(e,t)=>{var r;const n=await hn("navUpdateEntries");(r=n[e])!=null&&r.length||(n[e]=t,bn("navUpdateEntries",n));const a=n[e]||[],s=new Map(t.map(i=>[i.detailsHash,i]));return a.forEach(i=>{i.isNew=!s.has(i.detailsHash),s.set(i.detailsHash,i)}),Array.from(s.values())};function vn(e){const t=q(),n=S();console.log("start calculateFundsPerformanceMetricsAction ",e);for(const a of t.chainFunds[e])n.calculateFundPerformanceMetrics(a)}const Fn=Ae(),Nn=Fn.public.ENV_EXCLUDE_TEST_FUNDS,Sn=mt("excludeTestFunds",Nn),En={"0x89":[{address:"0xf48E3fa13cb2390e472cf1CA64F941eB7BD27475",alwaysExclude:!0},{address:"0x0657DC652F88B55Dd16f5D6cE687672264f9b61E",alwaysExclude:!0},{address:"0x8fAE33f10854c20a811246849A0d4131caf72125",alwaysExclude:!0},{address:"0x6DFbEE70f1250C2dECb3E9bCb2BE3AF19b15e631",alwaysExclude:!0},{address:"0x82CBA6D1A6dCeb408d7F048493262b83c9744f4D",alwaysExclude:!1},{address:"0xcfD904C4C857784686029995886d627da1aeFbe4",alwaysExclude:!1},{address:"0xe93CB20Fc113355753B6D237c3949E0452981dC3",alwaysExclude:!0},{address:"0x6edC5f675C5A20e867aeF0633033a17EA256637E",alwaysExclude:!0},{address:"0x920fdA0F59bDc852eD19e3ad975a808101ea2a29",alwaysExclude:!0},{address:"0x1550D564fEBE8c398F3cc398c9ac2a9e89E89A4F",alwaysExclude:!1},{address:"0x07094Bb5f175A4E6b074e5E79F6439a8A929533B",alwaysExclude:!1},{address:"0x98F1c2035680E4215cD5726a11279da96C07835F",alwaysExclude:!1},{address:"0xdac03eD03EFDa65A1488c7f3f0302636491726B6",alwaysExclude:!0},{address:"0xBb1E02AcA8F7Cb2403c0Bf3aaA74001d38Beb488",alwaysExclude:!0},{address:"0x1673458dDf6C0ea24ce5598918F3cA1e58f2d795",alwaysExclude:!1}],"0xa4b1":[{address:"0xA5138779Bb08C8DE44692e183c586817a0bcEb42",alwaysExclude:!1},{address:"0x74759a4607B97360956AbFd44cA4B2A0EC2A27C9",alwaysExclude:!1},{address:"0xd1FCcFb737E1b436Da057011Dc56231035285688",alwaysExclude:!1},{address:"0x80b5426A71c19Da522ddDeD4745eADE57a51E334",alwaysExclude:!1},{address:"0x4DF9aD4B872D8E906990205aD055Bc00c39EEa74",alwaysExclude:!1},{address:"0xbaA81241A186BC547Ec9e7a306755D4079b559cD",alwaysExclude:!1},{address:"0xB9e1dC350af83a3127aDc8CFB48a9B4abADCA184",alwaysExclude:!1},{address:"0xe3c31b33FCBd905E978aCEa64b2b043Cc81DDA7c",alwaysExclude:!0},{address:"0xC27eE955a44F0A9e7AC509dD54E8221eE06A9592",alwaysExclude:!0},{address:"0x539a56974295B8BF7023F2d85144Ca0010953ee2",alwaysExclude:!0},{address:"0x5A7638b7b831262081804e88657b2D83E8491b1E",alwaysExclude:!1},{address:"0x5E0f37920DDee57dAbAf5A73B21D51075AeDbEBE",alwaysExclude:!1},{address:"0x1D672d59724082EeeB575d1c7f42A6e5d1e327be",alwaysExclude:!0},{address:"0x9674B98e146c6bB120604a12E2EB03AC957BB6C6",alwaysExclude:!0},{address:"0xDD0B24e283f9084129380a1aEc325e05e691E47A",alwaysExclude:!0},{address:"0xB637Af0447faABDc10151152DD359cf947584120",alwaysExclude:!0},{address:"0xACfc595Fb72b530323E13D231B7B1849184a616c",alwaysExclude:!0},{address:"0x64e64f1EFfF211E253f0F6C7de64E575F32c1076",alwaysExclude:!0},{address:"0x47bFca13dBcEDc40B0911c2440e11eafea102f16",alwaysExclude:!0},{address:"0x37b2237594C3D72718bEEBFeE46B9c9FbdE4eAdc",alwaysExclude:!0},{address:"0x6D69C6cdacDD56b45FF0040042Ef776AB8E7e208",alwaysExclude:!0},{address:"0x76f30a490cCA1fC054B878cC93608471cA7683d3",alwaysExclude:!0},{address:"0xe338BEF930AD5F47B2dAB67c6690470e6a42aeFB",alwaysExclude:!0},{address:"0x6F8d5123A4aDB30ea9a2149b290e6b4421f6770A",alwaysExclude:!0},{address:"0x390DDAb10363a10c9B848dfa3AF4E800544D0476",alwaysExclude:!0},{address:"0x7e030800a54B501904798322a81dDe1D9DFEc121",alwaysExclude:!1},{address:"0xe9286fF990279De1F2305C626775b40EBd9d5c5a",alwaysExclude:!1},{address:"0x41633a238A1e7f7Dd19A8fe391AA9C6d38aD477a",alwaysExclude:!1},{address:"0xd1A5500f1776b306cA820C4408CA95922e1BDe98",alwaysExclude:!1},{address:"0xbaA05704375dC04a540f0abfE1c4cbA352397777",alwaysExclude:!0},{address:"0x70F79b65b36ecB3947D4d50d7A991edC94b980b7",alwaysExclude:!0}],"0xfc":[],"0x1":[{address:"0x7ed95418063d5b61bDE7b40D65F93739c0CFdcf4",alwaysExclude:!1},{address:"0x51cf0Bc0f5312d824a55B83B2c032Fb8c96c249a",alwaysExclude:!1},{address:"0xB6aB76d451B98a992FB84A93602527CC30cd3b22",alwaysExclude:!1},{address:"0x938f2a213464e7307aD19CeD57D3F809A2B0a3Df",alwaysExclude:!1},{address:"0xB8686BA67E17b986F4b57A089789CE8A9Ac7ECB0",alwaysExclude:!1},{address:"0xFcA1004B60DcEC14E7dC17E39f37ADfC2c62678D",alwaysExclude:!1}],"0x2105":[{address:"0x1D66EB6cC3b80c76B6fF08aC13f93a2DAEA4C855",alwaysExclude:!1},{address:"0xFC5fF4dc70EaEc998863668212B01cBE51000A4b",alwaysExclude:!1},{address:"0xC38e9E111CCBd435d9DE53ED2Dd7Db3993839238",alwaysExclude:!1},{address:"0x61d5e3dC0907EADa4D9B06D8B33Cd96c3510b533",alwaysExclude:!1},{address:"0x016623a2b54F7a6DAdB35D3400557a1b79466429",alwaysExclude:!1},{address:"0x2e40fDbA4d07E6b7aBCcBCCe3f6D28bDea727395",alwaysExclude:!1},{address:"0x34f1Ec0A0af19d622B281488C1B1ba0B5aE20860",alwaysExclude:!0},{address:"0x23C44260731B8614aa7F3B28AB0bafDb1610743c",alwaysExclude:!0},{address:"0x16dd2b60DEc7d3fE7C08f6B29732Fb51dDd2c176",alwaysExclude:!0},{address:"0x86acCa1a926FEa47985Df8Ef5A8c0d0cDA650a62",alwaysExclude:!0},{address:"0x457960e6946ed94e82512992ba9dAaBDa5539010",alwaysExclude:!0}],"0x3e7":[{address:"0x7ed95418063d5b61bDE7b40D65F93739c0CFdcf4",alwaysExclude:!0}]},wn=Object.fromEntries(Object.entries(En).map(([e,t])=>{const n=t.filter(a=>Sn?!0:a.alwaysExclude).map(a=>a.address.toLowerCase());return[e,n]}));async function xn(){const e=q();async function t(a){var u,p;if(!a)return;let s=e.chainFundsInfoArrays[a];s!=null&&s.length||(s=await e.fetchFundsInfoArrays(a));const r=[],i=[[],[]],o={};for(let l=0;l<s[0].length;l++){const y=s[0][l],m=s[1][l];(u=wn[a])!=null&&u.includes(y.toLowerCase())||(i[0].push(y),i[1].push(m),o[y]=m,r.push(y))}if(console.debug(`Chain ${a} - Filtered Funds: `,i),e.chainFundsInfoArrays[a]=i,(p=e.chainFunds[a])!=null&&p.length)return;const d=await e.fetchFundsMetaData(a,r,o);e.chainFunds[a]=d,Gt(d).then(l=>{e.chainFunds[a]=l,console.debug(`Chain ${a} - Funds with Current Value: `,l)}).catch(async l=>{console.error("Failed to fetch latest snapshots",a,l),e.chainFunds[a]=d,console.debug(`Chain ${a} - Funds Metadata (without Current Value): `,d);try{await e.fetchFundsNavMethods(a,i,!1)}catch(y){console.error("Failed fetchFundsNavMethods",a,i,y);return}try{await e.calculateFundsPerformanceMetrics(a)}catch(y){console.error("Failed calculateFundsPerformanceMetrics",a,y)}}),console.debug(`Funds fetched for chain: ${a}`)}const n=ft.map(a=>t(a));await Promise.allSettled(n),console.warn("ALL FUNDS FETCHED: ",e.chainFunds)}async function Mn(e){var i,o;const t=A(),n=(i=t.chainContracts[e])==null?void 0:i.fundFactoryContract,a=(o=t.chainContracts[e])==null?void 0:o.fundFactoryContractV2;if(!n)throw new Error(`No fund factory contract found for chainId: ${e}`);const s=await t.callWithRetry(e,()=>n.methods.registeredFundsLength().call()),r=await t.callWithRetry(e,()=>n.methods.registeredFundsData(0,s).call());if(a){console.log("fundsV2 fetch length",e);try{const d=await t.callWithRetry(e,()=>a.methods.registeredFundsLength().call());if(d>0){const u=await t.callWithRetry(e,()=>a.methods.registeredFundsData(0,d).call());return[[...r[0],...u[0]],[...r[1],...u[1]]]}}catch(d){console.warn(`Error fetching data from fundFactoryContractV2: ${d}`)}}return r}async function Dn(e,t,n){var d,u,p,l,y,m,f;console.log("process fund fetchFundsMetaDataAction fetchFundsMetaDataAction fetchFundsMetaDataAction ",e);const a=A(),s=fe([]),r=(d=a.chainContracts[e])==null?void 0:d.rethinkReaderContract;if(!r)throw new Error(`No reader contract found for chainId: ${e}`);const i=O[e];let o;console.log("process fund fundsMetaData",e,t);try{o=await r.methods.getFundsMetaData(t).call()}catch{o=await Cn(e,t,1)}try{console.log("process fund fundsMetaData done",e,"fundsMetaData:",o);for(const[T,g]of t.entries()){const c=o[T];try{if(!c){console.warn("fetchFundsMetaDataAction Skip fund, no fundMetaData: ",e,T,g);continue}const R=(c==null?void 0:c.totalDepositBal)||0n,P=Number(c.fundBaseTokenDecimals),H=Number(c.fundTokenDecimals),V=c.startTime,M=void 0,U=fe({chainId:e,chainName:i.chainName,chainShort:i.chainShort,address:g,title:c.fundName||"N/A",description:"N/A",safeAddress:"",governorAddress:"",photoUrl:ae,inceptionDate:V?Q(new Date(Number(V)*1e3)):"",lastNavUpdateTime:M?Q(new Date(Number(M)*1e3)):"",fundToken:{symbol:n[g].fundSymbol,address:g,decimals:H},fundTokenTotalSupply:c.fundTokenSupply||0n,baseToken:{address:((u=c.fundSettings)==null?void 0:u.baseToken)||"",symbol:c.fundBaseTokenSymbol,decimals:P},governanceToken:{symbol:c.fundGovernanceTokenSymbol,address:((p=c.fundSettings)==null?void 0:p.governanceToken)||"",decimals:Number(c.fundGovernanceTokenDecimals)},governanceTokenTotalSupply:c.fundGovernanceTokenSupply||0n,totalDepositBalance:R,cumulativeReturnPercent:void 0,monthlyReturnPercent:void 0,sharpeRatio:void 0,positionTypeCounts:[],sharePrice:void 0,netDeposits:"",isWhitelistedDeposits:!0,allowedDepositAddresses:((l=c.fundSettings)==null?void 0:l.allowedDepositAddrs)||[],allowedManagerAddresses:((y=c.fundSettings)==null?void 0:y.allowedManagers)||[],plannedSettlementPeriod:"",minLiquidAssetShare:"",votingDelay:"",votingPeriod:"",proposalThreshold:"",quorumVotes:0n,quorumVotesFormatted:"0",quorumNumerator:BigInt(0),quorumDenominator:BigInt(0),quorumPercentage:"N/A",lateQuorum:"",depositFee:"",depositFeeAddress:"",withdrawFee:"",withdrawFeeAddress:"",managementPeriod:"",managementFee:"",managementFeeAddress:"",performancePeriod:"",performanceFee:"",performanceFeeAddress:"",performaceHurdleRateBps:"",feeCollectors:((m=c.fundSettings)==null?void 0:m.feeCollectors)||[],feeBalance:c.feeBalance||0n,safeContractBaseTokenBalance:c.safeContractBaseTokenBalance||0n,fundContractBaseTokenBalance:c.fundContractBaseTokenBalance||0n,navUpdates:[],isNavUpdatesLoading:!0}),z=c.fundMetadata;if(z){const N=JSON.parse(z),{strategistName:oe,strategistUrl:de,oivChatUrl:G}=((f=Qe[e])==null?void 0:f.find(W=>(W==null?void 0:W.address)===g))||{strategistName:"",strategistUrl:"",oivChatUrl:""};U.description=N.description,U.photoUrl=N.photoUrl||ae,U.plannedSettlementPeriod=N.plannedSettlementPeriod,U.minLiquidAssetShare=N.minLiquidAssetShare,U.strategistName=(N==null?void 0:N.strategistName)||oe,U.strategistUrl=(N==null?void 0:N.strategistUrl)||de,U.oivChatUrl=(N==null?void 0:N.oivChatUrl)||G}s.push(U)}catch(R){console.error("fetchFundsMetaDataAction Error parsing fund metadata: ",R,e,T,g,c)}}return s}catch(T){return console.error("Error calling getFundNavMetaData: ",T," addresses: ",t),s}}async function Cn(e,t,n=3){var i;const s=(i=A().chainContracts[e])==null?void 0:i.rethinkReaderContract;if(!s)throw new Error(`No reader contract found for chainId: ${e}`);const r=[];for(let o=0;o<t.length;o+=n){const d=t.slice(o,o+n);console.log("Fetching metadata for batch:",d);try{const u=await s.methods.getFundsMetaData(d).call();r.push(...u)}catch(u){console.error("Batch failed:",d,u)}}return r}const Un={[x.POLYGON]:["0xd87d9b63abe927264903466398cabf9e105ac2fae7c6dc76f822d8ef89e7012d","0xe63fd752a9fdc61a6bb0ac72d9134f09f1f85778192fa6d10278bd9a09a425e9","0x36e7ba53628d044345c9d4e0e9b917f5479d1d4a3e212a0e5b56493f67958020","0x6798edd8ad8861e9e653967ad7938d3646b3058d1a5b6dc98352d99648f45e43","0xeaf175c9485c6b69e0d2005b58a57da04d12c8b0f27bae21547abebdf527c374","0x94f12e7002169840f86b41a8dd9b238449dcf449c2f9be33e3d3717c4bdb3b84","0x37c0cad1bac6a4cdd3a7e5f13162b8b1c7fd8db96ce2557de5db67e1f8213ece","0x003651b0da2306f94cde72d015b08ba7d647d94cddd832a0ece2814a433abf5f","0xb749dd887a361f0a54620e6b951cdbe81b247fd13579b1adccbebb3f20d2fdc5","0xb2ff5e623b7d7968f1be9368581d2a8b81a196be14fd49bf17f2d81cc6a5a792","0xb39cda6e5b4682c22be024de190ef1b4d51272080717f6736d23336d66816d90","0x2c7539dd92643763ddfeb50e7128163bd84b23888ef23aa51b8699c3062f7afe","0xd0725050839976f202c5b166fc8ace2bdf0efbebff6b6c1948a4ad1bc381dab2","0x052b2ebc7e0f9a5bf5a1669a37adece81720835d78a2c59017ef13067815be5a","0x49c45e0947c491f5335b0e7928042945fe18d8068b9177b8abb869d8197eab68","0x46288396afeaf4a1627e8ecfabbd155b6af4c57c915634e39773d4cfe204cb54","0x0090f1dd1b1b6d4e795ee88b9e68106c6850652c3a8d20b60abb698d837fdfa5","0x193875a6a73b0fdb7f91a8d1fec9720631c0e15a77381bb8705ae664820ff191","0x3f1ebea95611c81d5d1796f2b8ba5aa0a4c096be233b1b6e364d672a90b51541","0x185b86eb262389d024f24547dbe747fac1fd105d4fdb289760271d283f8455bc","0x89af9028f446bd5dfa641ae943850706f94954a90276b37bec6d85c240b3fba2","0xd35f068cd38e3889ea64c766e5f0bc2dc3115b277da66a8f45ae03a8b36bbb56"],[x.ARBITRUM]:["0x0293c6201842b711a6e597b77d14aee1fc2705dfa681303d6ec20f7a2fe8df18","0xb2ff5e623b7d7968f1be9368581d2a8b81a196be14fd49bf17f2d81cc6a5a792","0xb39cda6e5b4682c22be024de190ef1b4d51272080717f6736d23336d66816d90","0x2c7539dd92643763ddfeb50e7128163bd84b23888ef23aa51b8699c3062f7afe","0xd0725050839976f202c5b166fc8ace2bdf0efbebff6b6c1948a4ad1bc381dab2","0x052b2ebc7e0f9a5bf5a1669a37adece81720835d78a2c59017ef13067815be5a","0x49c45e0947c491f5335b0e7928042945fe18d8068b9177b8abb869d8197eab68","0x46288396afeaf4a1627e8ecfabbd155b6af4c57c915634e39773d4cfe204cb54","0x0090f1dd1b1b6d4e795ee88b9e68106c6850652c3a8d20b60abb698d837fdfa5","0x193875a6a73b0fdb7f91a8d1fec9720631c0e15a77381bb8705ae664820ff191","0x3f1ebea95611c81d5d1796f2b8ba5aa0a4c096be233b1b6e364d672a90b51541","0x185b86eb262389d024f24547dbe747fac1fd105d4fdb289760271d283f8455bc","0x89af9028f446bd5dfa641ae943850706f94954a90276b37bec6d85c240b3fba2","0x19c959f6f3fd6989839cd304b866bfdfe1a80e1b0592ed518f1f8f2dd90a4411","0x6c80ba925bb107ec6de84d455971bffe3a68ff07ae25cd48438831cae43ab2d4","0xde0634bfae9120b4f389d806e0d8dd97207216faad976d71023ba224d91635de","0xfcb42c544584c67c31f19b4d61dcc1eecffed421c4b48c2d50d58a89c106c90e","0x1d4074ac2806f50033711a64f9722b63115d188999a192557c6d5b229cfce103","0x74ea80401cbaa208e2b9774b9c14b859463bcb68d2aaf826a9cc217216cdbb7d","0x6e39f72f7a4776f59ede9bf1c0325f9f79535b8a655e572baaefa75670aae2c1"],[x.ETHEREUM]:[],[x.BASE]:["0x4226e636db1dbaa1da860ce7df92d151aaea7f23934b94a21bc75d2c1d6233ee","0x50a4f3bc878614729c8dc9365a4ad9ea717e089870d706459c85e1f8fb89ac94"]};var Ie;const Vn=((Ie=L.abi.find(e=>e.name==="getNavEntry"&&e.type==="function"))==null?void 0:Ie.outputs)||[];var Pe;const Bn=((Pe=Ge.abi.find(e=>e.name==="getNAVParts"&&e.type==="function"))==null?void 0:Pe.outputs)||[],st=e=>We(Vn,e)[0],kn=e=>We(Bn,e)[0],Rn=!0;async function In(e,t,n=!0){var l;console.log("start calculating fund nav data ",e);const a=q(),s=A(),r=t[0],i=(l=s.chainContracts[e])==null?void 0:l.rethinkReaderContract;if(!i)throw new Error(`No reader contract found for chainId: ${e}`);const o=await i.methods.getFundsNAVData(r).call(),d=[];a.navMethodDetailsHashToFundAddress={};for(const[y,m]of o.entries()){const f=r[y];await Pn(e,m,f,y,a,t,d)}const u=new Map;for(const y of d)y.detailsHash&&!u.has(y.detailsHash)&&u.set(y.detailsHash,y);const p=Array.from(u.values());n&&(a.allNavMethods[e]=d,a.uniqueNavMethods[e]=p)}async function Pn(e,t,n,a,s,r,i){var l,y,m,f,T,g;if(s.chainFundNAVUpdates[e][n]=[],!((l=t.encodedNavUpdate)!=null&&l.length))return;let o=await s.fundStore.parseFundNAVUpdates(e,t,n);const d=((y=at[e])==null?void 0:y[n])||[];console.log("EXCLUDED INDEXES2",d),o=d.length?o.filter(c=>!d.includes(c.index)):o,s.chainFundNAVUpdates[e][n]=o,(f=(m=s.chainFunds)==null?void 0:m[e])!=null&&f[a]&&(s.chainFunds[e][a].navUpdates=o);const u=o[o.length-1],p=(T=s.chainFunds[e])==null?void 0:T[a];for(const[c,R]of t.encodedNavUpdate.entries())try{const P=st(R);for(const[H,V]of P.entries()){if(V.isPastNAVUpdate||V.pastNAVUpdateIndex!==0n)continue;const M=Se(H,V);Rn&&M.detailsHash&&((g=Un[e])!=null&&g.includes(M.detailsHash))||(M.pastNAVUpdateEntryFundAddress=n,M.pastNAVUpdateEntrySafeAddress=r[1][a].safe,i.push(M),M.detailsHash?s.navMethodDetailsHashToFundAddress[M.detailsHash]=n:console.error("Missing detailsHash for NAV method ",c,V))}}catch(P){console.log("Error processing NAV methods: ",P)}p&&(p.positionTypeCounts=Je(u),p.lastNAVUpdateTotalNAV=o.length?u.totalNAV||0n:p.totalDepositBalance||0n)}const q=ge({id:"funds",state:()=>({chainFunds:{},chainFundsInfoArrays:{},chainFundNAVUpdates:Object.fromEntries(Object.keys(O).map(e=>[e,{}])),allNavMethods:Object.fromEntries(Object.keys(O).map(e=>[e,[]])),uniqueNavMethods:Object.fromEntries(Object.keys(O).map(e=>[e,[]])),navMethodDetailsHashToFundAddress:{}}),getters:{funds(){return Object.values(this.chainFunds).reduce((e,t)=>e.concat(t),[])},fundStore(){return S()},web3Store(){return A()},chainAddressLabelMap(){const e={};for(const t in this.chainFunds.keys){e[t]={};for(const n of this.chainFunds[t])e[t][n.safeAddress]=n.title+" Safe",e[t][n.address]=n.title+" Vault"}return e}},actions:{fetchFundsInfoArrays(e){return h("fetchFundsInfoArraysAction",()=>Mn(e))},fetchFunds(){return h("fetchFundsAction",()=>xn())},fetchFundsMetaData(e,t,n){return h("fetchFundsMetaDataAction",()=>Dn(e,t,n))},fetchFundsNavMethods(e,t,n=!0){return h("fetchFundsNavMethodsAction",()=>In(e,t,n))},calculateFundsPerformanceMetrics(e){return h("calculateFundsPerformanceMetricsAction",()=>vn(e))}}}),On=async(e,t,n=!1)=>{var l,y,m,f,T,g;const a=S(),s=q(),r=A(),i=ve();if(!((l=s.allNavMethods[e])!=null&&l.length)){const c=await s.fetchFundsInfoArrays(e);console.log("[CURRENT NAV] simulate fetch all nav methods"),await s.fetchFundsNavMethods(e,c)}console.log("[CURRENT NAV] START SIMULATE:");const o=((y=a.fund)==null?void 0:y.safeAddress)||"",d=((f=(m=a.fund)==null?void 0:m.baseToken)==null?void 0:f.decimals)||18,u=((g=(T=a.fund)==null?void 0:T.baseToken)==null?void 0:g.symbol)||"",p=[];for(const c of a.fundLastNAVUpdateMethods)p.push(i.requestConcurrencyLimit(()=>r.callWithRetry(e,()=>a.fetchSimulatedNAVMethodValue(e,t,o,d,u,c,!1,n),1,[-32603])));await Promise.allSettled(p)},Ln=async(e,t,n,a,s,r,i=!1,o=!1)=>{var y;const d=q(),u=A(),p=ve();if(console.log("fetchSimulatedNAVMethodValueAction: ",r,"safeAddress",n,"baseDecimals",a,"baseSymbol",s),!r.detailsHash){console.error("No detailsHash provided in navEntry.",r);return}if(!a||!s){console.error("simulateNAVMethodValue error: No fund base decimals or symbol.");return}if(!n){console.error("simulateNAVMethodValue error: No fund safe address.");return}const l=(y=u.chainContracts[e])==null?void 0:y.navCalculatorContract;try{r.foundMatchingPastNAVUpdateEntryFundAddress=!0,r.pastNAVUpdateEntryFundAddress||(r.pastNAVUpdateEntryFundAddress=d.navMethodDetailsHashToFundAddress[r.detailsHash??""]),r.pastNAVUpdateEntryFundAddress||(r.pastNAVUpdateEntryFundAddress=t,r.foundMatchingPastNAVUpdateEntryFundAddress=!1);let m=Dt[r.positionType];const f=[];if(r.positionType===E.Liquid?(f.push(Ke(r.details)),f.push(n)):r.positionType===E.Illiquid?(f.push(ze(r.details,a)),f.push(n)):r.positionType===E.NFT?f.push(Xe(r.details)):r.positionType===E.Composable&&(f.push(Ze(r.details)),console.warn("IS NON INIT TRUE"),i&&(m=m.replace("ReadOnly","NonInitReadOnly"))),f.push(t,0,!1,parseInt(r.details.pastNAVUpdateIndex),parseInt(r.details.pastNAVUpdateEntryIndex),r.pastNAVUpdateEntryFundAddress),i&&r.positionType===E.Composable){const{rethinkContractAddresses:T}=K(),g=o?"GovernableFundFactoryV1.5BeaconProxy":"GovernableFundFactoryBeaconProxy";f.push(T[g][e],p.activeAccountAddress)}console.debug("simulate json: ",JSON.stringify(f,null,2)),r.simulatedNavFormatted="N/A",r.simulatedNav=0n;try{const T=await u.callWithRetry(e,()=>l.methods[m](...f).call(),1,[-32603,310]);console.warn("simulated value: ",T);const g=T?te(T,a,!0,!1):"0";r.simulatedNavFormatted=g+" "+s,r.simulatedNav=T,r.isSimulatedNavError=!1}catch(T){r.isSimulatedNavError=!0,console.error("simulateNAVMethodValue: Failed simulating value for entry, check if there was some difference when hashing details on INAVMethod detailsHash: ",r,T)}}catch(m){console.error("simulateNAVMethodValue error: ",m)}},_n=async()=>{var n,a,s,r;const e=S(),t=A();if(e.fundUserData.baseTokenBalance=BigInt("0"),!((a=(n=e.fund)==null?void 0:n.baseToken)!=null&&a.address)){console.log("Fund baseToken.address is not set.");return}if(!e.activeAccountAddress){console.log("activeAccountAddress is not set.");return}return e.fundUserData.baseTokenBalance=await t.callWithRetry(e.selectedFundChain,()=>e.fundBaseTokenContract.methods.balanceOf(e.activeAccountAddress).call()),console.log(`user base token balance of ${(r=(s=e.fund)==null?void 0:s.baseToken)==null?void 0:r.symbol} is ${e.fundUserData.baseTokenBalance}`),e.fundUserData.baseTokenBalance},qn=async()=>{var n,a,s,r;const e=S(),t=A();if(e.fundUserData.fundAllowance=BigInt("0"),!((a=(n=e.fund)==null?void 0:n.baseToken)!=null&&a.address)){console.log("Fund baseToken.address is not set.");return}return e.activeAccountAddress?(e.fundUserData.fundAllowance=await t.callWithRetry(e.selectedFundChain,()=>e.fundBaseTokenContract.methods.allowance(e.activeAccountAddress,e.selectedFundAddress).call()),console.log(`user fund allowance of ${(r=(s=e.fund)==null?void 0:s.baseToken)==null?void 0:r.symbol} is ${e.fundUserData.fundAllowance}`),e.fundUserData.fundAllowance):console.error("Active account not found")},Hn=async(e,t)=>{var m,f,T;console.debug("fetchUserFundDataAction, refresh user balances",e,t);const n=S(),a=A();n.fetchUserFundDepositRedemptionRequests();const s=(m=a.chainContracts[e])==null?void 0:m.rethinkReaderContract,r=n.activeAccountAddress;if(!r||!s)return;const i=await a.callWithRetry(e,()=>s.methods.getFundUserData(t,r).call()),{baseTokenBalance:o,fundTokenBalance:d,governanceTokenBalance:u,fundAllowance:p,fundShareValue:l,fundDelegateAddress:y}=i;((f=n.fund)==null?void 0:f.address)!==((T=n.fund)==null?void 0:T.governanceToken.address)?(n.fundUserData.fundDelegateAddress=await a.callWithRetry(e,()=>n.fundGovernanceTokenContract.methods.delegates(n.activeAccountAddress).call()),y!==n.fundUserData.fundDelegateAddress&&console.warn("[MISMATCH] wrong delegate to address from reader contract",y,"should be:",n.fundUserData.fundDelegateAddress)):n.fundUserData.fundDelegateAddress=y,n.fundUserData.baseTokenBalance=BigInt(o),n.fundUserData.fundTokenBalance=BigInt(d),n.fundUserData.governanceTokenBalance=BigInt(u),n.fundUserData.fundAllowance=BigInt(p),n.fundUserData.fundShareValue=BigInt(l)},Gn=async()=>{var n,a;const e=S(),t=A();if(e.fundUserData.fundDelegateAddress="",!((a=(n=e.fund)==null?void 0:n.governanceToken)!=null&&a.address)){console.log("Fund governanceToken.address is not set.");return}if(!e.activeAccountAddress){console.log("activeAccountAddress is not set.");return}return console.warn("FETCH userFundDelegateAddress"),e.fundUserData.fundDelegateAddress=await t.callWithRetry(e.selectedFundChain,()=>e.fundGovernanceTokenContract.methods.delegates(e.activeAccountAddress).call()),console.warn("FETCH userFundDelegateAddress",e.fundUserData.fundDelegateAddress),e.fundUserData.fundDelegateAddress};var he=(e=>(e.Deposit="Deposit",e.Redemption="Redemption",e))(he||{});const Wn={Deposit:273,Redemption:274},$n=async()=>{const e=S();if(!e.activeAccountAddress)return console.error("Active account not found");if(!e.selectedFundAddress)return"";const[t,n]=await Promise.allSettled([()=>e.fetchUserFundTransactionRequest(he.Deposit),()=>e.fetchUserFundTransactionRequest(he.Redemption)].map(r=>e.accountStore.requestConcurrencyLimit(r))),a=t.status==="fulfilled"?t.value:void 0,s=n.status==="fulfilled"?n.value:void 0;e.fundUserData.depositRequest=a,e.fundUserData.redemptionRequest=s},Jn=async()=>{var a;const e=S(),t=A();if(e.fundUserData.fundShareValue=BigInt("0"),!e.activeAccountAddress)return console.error("Active account not found");if(!((a=e.fund)!=null&&a.fundTokenTotalSupply))return e.fundUserData.fundShareValue;let n=BigInt("0");try{n=await t.callWithRetry(e.selectedFundChain,()=>e.fundContract.methods.valueOf(e.activeAccountAddress).call())}catch(s){console.error("The total fund balance is probably 0, which is why MetaMask may be showing the 'Internal JSON-RPC... division by 0' error. -> ",s)}return console.log("balanceWei user fund share value:",n),e.fundUserData.fundShareValue=n,e.fundUserData.fundShareValue},jn=async()=>{var n,a,s,r;const e=S(),t=A();if(e.fundUserData.fundTokenBalance=BigInt("0"),!((a=(n=e.fund)==null?void 0:n.fundToken)!=null&&a.address)){console.log("Fund fundToken.address is not set.");return}if(!e.activeAccountAddress){console.log("activeAccountAddress is not set.");return}return e.fundUserData.fundTokenBalance=await t.callWithRetry(e.selectedFundChain,()=>e.fundContract.methods.balanceOf(e.activeAccountAddress).call()),console.log(`user fund token balance of ${(r=(s=e.fund)==null?void 0:s.fundToken)==null?void 0:r.symbol} is ${e.fundUserData.fundTokenBalance}`),e.fundUserData.fundTokenBalance};function ke(e){return e.startsWith("0x")?e.slice(2):e}function Qn(e,t){const n=ke(Me(Tt(t),32)),s=ke(Me(bt(e),32))+n;return Le("0x"+s)}function Yn(e){return"0x"+(BigInt(e)+BigInt(1)).toString(16)}const Kn=async e=>{const t=S(),n=A(),a=t.fundAddress,s=t.selectedFundChain;if(!s)return;const r=n.chainProviders[s];if(!t.activeAccountAddress||!a)return;const i=Wn[e],o=Qn(t.activeAccountAddress,i),d=Yn(o);console.debug("[FETCH REQUEST] AMOUNT",e);try{const u=await n.callWithRetry(s,()=>r==null?void 0:r.eth.getStorageAt(a,o));console.debug("[FETCH REQUEST] AMOUNT fetched",e,u);let p=De(u);p=p==="0x"?0n:BigInt(p),console.debug("[FETCH REQUEST] fetch TS",e);const l=await n.callWithRetry(s,()=>r==null?void 0:r.eth.getStorageAt(a,d));console.debug("[FETCH REQUEST] TS",e,l);let y=De(l);return y=y==="0x"?0:Number(y)*1e3,{amount:p,timestamp:y,type:e}}catch(u){console.error(`Failed fetching deposit/withdrawal request ${a} slot: ${i}. -> `,u)}},zn=async()=>{var n,a,s,r;const e=S(),t=A();if(e.selectedFundChain){if(e.fundUserData.governanceTokenBalance=BigInt("0"),!((a=(n=e.fund)==null?void 0:n.governanceToken)!=null&&a.address)){console.log("Fund governanceToken.address is not set.");return}if(!e.activeAccountAddress){console.log("activeAccountAddress is not set.");return}e.fundUserData.governanceTokenBalance=await t.callWithRetry(e.selectedFundChain,()=>e.fundGovernanceTokenContract.methods.balanceOf(e.activeAccountAddress).call()),console.log(`user governance token balance is ${e.fundUserData.governanceTokenBalance} ${(r=(s=e.fund)==null?void 0:s.fundToken)==null?void 0:r.symbol}`)}},Xn=async(e,t,n)=>{var d,u;const a=[];t.encodedNavParts.forEach(p=>{const l=kn(p);a.push({baseAssetOIVBal:l.baseAssetOIVBal,baseAssetSafeBal:l.baseAssetSafeBal,feeBal:l.feeBal,totalNAV:l.totalNAV})});const s=fe([]),r=t.updateTimes.length,i=t.updateTimes;for(let p=0;p<r;p++){const l=Number(i[p]*1000n);s.push({index:p+1,date:i[p]?Q(new Date(l)):`#${(p+1).toString()}}`,timestamp:l,navParts:a[p],totalNAV:(d=a[p])==null?void 0:d.totalNAV,entries:[]})}t.encodedNavUpdate.forEach((p,l)=>{let y=[];try{y=st(p)}catch(m){console.error("Error decoding navUpdate entry: ",m)}for(const[m,f]of y.entries()){const T=Se(m,f);s[l].entries.push(T)}});const o=((u=s[s.length-1])==null?void 0:u.entries)??[];for(let p=0;p<o.length;p++)await Zn(e,n,p,o[p]);return s},Zn=async(e,t,n,a)=>{var o;const r=(o=A().chainContracts[e])==null?void 0:o.navCalculatorContract;if(!r)throw new Error(`No navCalculatorContract found for chainId: ${e}`);const i=Ct[a.positionType];a.pastNavValue=void 0,a.pastNavValueLoading=!0,a.pastNavValueError=!1;try{const d=await r.methods[i](t,n).call();a.pastNavValue=d.reduce((u,p)=>u+p,0n)}catch(d){a.pastNavValueError=!0,console.error(`Failed to fetch NAV method last NAV value ${n}:`,a,d)}a.pastNavValueLoading=!1},ea=async()=>{const e=S(),{getNAVExecutorBeaconProxyAddress:t}=K();try{const n=t(e.selectedFundChain);if(!n){e.toastStore.errorToast("The NAV Executor address is not available for this network. Please contact the Rethink Finance support.");return}return await e.fundContract.send("executeNAVUpdate",{},n).on("transactionHash",a=>{console.log("tx hash: "+a),e.toastStore.warningToast("The transaction has been submitted. Please wait for it to be confirmed.")}).on("receipt",a=>{console.log(a),a.status?e.toastStore.successToast("The recalculation of vault NAV has Succeeded"):e.toastStore.errorToast("The recalculation of vault NAV has failed. Please contact the Rethink Finance support.")}).on("error",a=>{throw console.log(a),e.toastStore.errorToast("There has been an error. Please contact the Rethink Finance support."),a})}catch(n){throw console.error("Error updating NAV: ",n),e.toastStore.errorToast("There has been an error. Please contact the Rethink Finance support."),n}},ta={abi:[{inputs:[],name:"InvalidShortString",type:"error"},{inputs:[{internalType:"string",name:"str",type:"string"}],name:"StringTooLong",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"delegator",type:"address"},{indexed:!0,internalType:"address",name:"fromDelegate",type:"address"},{indexed:!0,internalType:"address",name:"toDelegate",type:"address"}],name:"DelegateChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"delegate",type:"address"},{indexed:!1,internalType:"uint256",name:"previousBalance",type:"uint256"},{indexed:!1,internalType:"uint256",name:"newBalance",type:"uint256"}],name:"DelegateVotesChanged",type:"event"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"clock",outputs:[{internalType:"uint48",name:"",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[],name:"CLOCK_MODE",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint32",name:"pos",type:"uint32"}],name:"checkpoints",outputs:[{components:[{internalType:"uint32",name:"fromBlock",type:"uint32"},{internalType:"uint224",name:"votes",type:"uint224"}],internalType:"struct ERC20Votes.Checkpoint",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"numCheckpoints",outputs:[{internalType:"uint32",name:"",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"delegates",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getVotes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"getPastVotes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"getPastTotalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"delegatee",type:"address"}],name:"delegate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"delegatee",type:"address"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"expiry",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"delegateBySig",outputs:[],stateMutability:"nonpayable",type:"function"}]},na=JSON.parse('[{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"owner","type":"address"}],"name":"AddedOwner","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"approvedHash","type":"bytes32"},{"indexed":true,"internalType":"address","name":"owner","type":"address"}],"name":"ApproveHash","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"handler","type":"address"}],"name":"ChangedFallbackHandler","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"guard","type":"address"}],"name":"ChangedGuard","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"threshold","type":"uint256"}],"name":"ChangedThreshold","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"}],"name":"DisabledModule","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"}],"name":"EnabledModule","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"bytes32","name":"txHash","type":"bytes32"},{"indexed":false,"internalType":"uint256","name":"payment","type":"uint256"}],"name":"ExecutionFailure","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"module","type":"address"}],"name":"ExecutionFromModuleFailure","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"module","type":"address"}],"name":"ExecutionFromModuleSuccess","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"bytes32","name":"txHash","type":"bytes32"},{"indexed":false,"internalType":"uint256","name":"payment","type":"uint256"}],"name":"ExecutionSuccess","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"owner","type":"address"}],"name":"RemovedOwner","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"},{"indexed":false,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"},{"indexed":false,"internalType":"bytes","name":"data","type":"bytes"},{"indexed":false,"internalType":"enum Enum.Operation","name":"operation","type":"uint8"}],"name":"SafeModuleTransaction","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"},{"indexed":false,"internalType":"bytes","name":"data","type":"bytes"},{"indexed":false,"internalType":"enum Enum.Operation","name":"operation","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"safeTxGas","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"baseGas","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"gasPrice","type":"uint256"},{"indexed":false,"internalType":"address","name":"gasToken","type":"address"},{"indexed":false,"internalType":"address payable","name":"refundReceiver","type":"address"},{"indexed":false,"internalType":"bytes","name":"signatures","type":"bytes"},{"indexed":false,"internalType":"bytes","name":"additionalInfo","type":"bytes"}],"name":"SafeMultiSigTransaction","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"sender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"SafeReceived","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"initiator","type":"address"},{"indexed":false,"internalType":"address[]","name":"owners","type":"address[]"},{"indexed":false,"internalType":"uint256","name":"threshold","type":"uint256"},{"indexed":false,"internalType":"address","name":"initializer","type":"address"},{"indexed":false,"internalType":"address","name":"fallbackHandler","type":"address"}],"name":"SafeSetup","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"msgHash","type":"bytes32"}],"name":"SignMsg","type":"event"},{"stateMutability":"nonpayable","type":"fallback"},{"inputs":[],"name":"VERSION","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"uint256","name":"_threshold","type":"uint256"}],"name":"addOwnerWithThreshold","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"hashToApprove","type":"bytes32"}],"name":"approveHash","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"approvedHashes","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_threshold","type":"uint256"}],"name":"changeThreshold","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"dataHash","type":"bytes32"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"bytes","name":"signatures","type":"bytes"},{"internalType":"uint256","name":"requiredSignatures","type":"uint256"}],"name":"checkNSignatures","outputs":[],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"dataHash","type":"bytes32"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"bytes","name":"signatures","type":"bytes"}],"name":"checkSignatures","outputs":[],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"prevModule","type":"address"},{"internalType":"address","name":"module","type":"address"}],"name":"disableModule","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"domainSeparator","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"module","type":"address"}],"name":"enableModule","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"},{"internalType":"uint256","name":"safeTxGas","type":"uint256"},{"internalType":"uint256","name":"baseGas","type":"uint256"},{"internalType":"uint256","name":"gasPrice","type":"uint256"},{"internalType":"address","name":"gasToken","type":"address"},{"internalType":"address","name":"refundReceiver","type":"address"},{"internalType":"uint256","name":"_nonce","type":"uint256"}],"name":"encodeTransactionData","outputs":[{"internalType":"bytes","name":"","type":"bytes"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"},{"internalType":"uint256","name":"safeTxGas","type":"uint256"},{"internalType":"uint256","name":"baseGas","type":"uint256"},{"internalType":"uint256","name":"gasPrice","type":"uint256"},{"internalType":"address","name":"gasToken","type":"address"},{"internalType":"address payable","name":"refundReceiver","type":"address"},{"internalType":"bytes","name":"signatures","type":"bytes"}],"name":"execTransaction","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"}],"name":"execTransactionFromModule","outputs":[{"internalType":"bool","name":"success","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"}],"name":"execTransactionFromModuleReturnData","outputs":[{"internalType":"bool","name":"success","type":"bool"},{"internalType":"bytes","name":"returnData","type":"bytes"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getChainId","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"start","type":"address"},{"internalType":"uint256","name":"pageSize","type":"uint256"}],"name":"getModulesPaginated","outputs":[{"internalType":"address[]","name":"array","type":"address[]"},{"internalType":"address","name":"next","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getOwners","outputs":[{"internalType":"address[]","name":"","type":"address[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"offset","type":"uint256"},{"internalType":"uint256","name":"length","type":"uint256"}],"name":"getStorageAt","outputs":[{"internalType":"bytes","name":"","type":"bytes"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getThreshold","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"},{"internalType":"uint256","name":"safeTxGas","type":"uint256"},{"internalType":"uint256","name":"baseGas","type":"uint256"},{"internalType":"uint256","name":"gasPrice","type":"uint256"},{"internalType":"address","name":"gasToken","type":"address"},{"internalType":"address","name":"refundReceiver","type":"address"},{"internalType":"uint256","name":"_nonce","type":"uint256"}],"name":"getTransactionHash","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"module","type":"address"}],"name":"isModuleEnabled","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"isOwner","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"nonce","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"prevOwner","type":"address"},{"internalType":"address","name":"owner","type":"address"},{"internalType":"uint256","name":"_threshold","type":"uint256"}],"name":"removeOwner","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"}],"name":"requiredTxGas","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"handler","type":"address"}],"name":"setFallbackHandler","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"guard","type":"address"}],"name":"setGuard","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address[]","name":"_owners","type":"address[]"},{"internalType":"uint256","name":"_threshold","type":"uint256"},{"internalType":"address","name":"to","type":"address"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"address","name":"fallbackHandler","type":"address"},{"internalType":"address","name":"paymentToken","type":"address"},{"internalType":"uint256","name":"payment","type":"uint256"},{"internalType":"address payable","name":"paymentReceiver","type":"address"}],"name":"setup","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"signedMessages","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"targetContract","type":"address"},{"internalType":"bytes","name":"calldataPayload","type":"bytes"}],"name":"simulateAndRevert","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"prevOwner","type":"address"},{"internalType":"address","name":"oldOwner","type":"address"},{"internalType":"address","name":"newOwner","type":"address"}],"name":"swapOwner","outputs":[],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}]'),aa={abi:na},sa=async(e,t)=>{const n=A();if(!e)throw new Error("No vault chainId provided, cannot fetch vault settings.");if(!t)throw new Error("No fundAddress provided, cannot fetch vault settings.");const a=n.getCustomContract(e,L.abi,t);console.log("GET fund settings");const s=await n.callWithRetry(e,()=>a.methods.getFundSettings().call());return console.log("fund settings:",s),s},ra=async e=>{const t=S(),n=A();if(!e)return"";let a=t.fundRoleModAddress[e];if(a)return a;const s="0x0000000000000000000000000000000000000001";return a=(await n.callWithRetry(t.selectedFundChain,()=>t.fundSafeContract.methods.getModulesPaginated(s,10).call()))[0][1],t.fundRoleModAddress[e]=a,a},Re={baseTokenBalance:0n,fundTokenBalance:0n,governanceTokenBalance:0n,fundAllowance:0n,fundShareValue:0n,fundDelegateAddress:"",depositRequest:void 0,redemptionRequest:void 0},S=ge({id:"fund",state:()=>({chainFunds:Object.fromEntries(Object.keys(O).map(e=>[e,{}])),chainAddressSourceCode:Object.fromEntries(Object.keys(O).map(e=>[e,{}])),fundUserData:structuredClone(Re),selectedFundChain:x.ETHEREUM,selectedFundAddress:"",fundManagedNAVMethods:[],fundInitialNAVMethods:[],fundRoleModAddress:{},refreshSimulateNAVCounter:0}),getters:{accountStore(){return ve()},activeAccountAddress(){var e;return(e=this.accountStore.activeAccount)==null?void 0:e.address},web3Store(){return A()},fundsStore(){return q()},toastStore(){return ht()},fundAddress(){var e;return((e=this.fund)==null?void 0:e.address)??this.selectedFundAddress??""},fund(){var e,t;return(t=(e=this.chainFunds)==null?void 0:e[this.selectedFundChain])==null?void 0:t[this.selectedFundAddress]},addressLabelMap(){var t,n,a,s;const e={};return(t=this.fund)!=null&&t.safeAddress&&(e[this.fund.safeAddress]=((n=this.fund)==null?void 0:n.title)+" Safe"),(a=this.fund)!=null&&a.address&&(e[this.fund.address]=((s=this.fund)==null?void 0:s.title)+" Vault"),e},isUsingZodiacPilotExtension(){var e,t;return((e=this.activeAccountAddress)==null?void 0:e.toLowerCase())===((t=this.fund)==null?void 0:t.safeAddress.toLowerCase())},baseToFundTokenExchangeRate(){var a,s,r,i,o,d,u,p,l,y,m,f,T;if(!((s=(a=this.fund)==null?void 0:a.baseToken)!=null&&s.decimals)||!((i=(r=this.fund)==null?void 0:r.fundToken)!=null&&i.decimals))return k.fromString("0");if(!this.fundLastNAVUpdate){if(!((o=this.fund)!=null&&o.baseToken)||!((d=this.fund)!=null&&d.fundToken))return k.fromString("0");if(((u=this.fund)==null?void 0:u.fundToken.decimals)===((p=this.fund)==null?void 0:p.baseToken.decimals))return k.fromString("1");const g=Number((l=this.fund)==null?void 0:l.fundToken.decimals)-Number((y=this.fund)==null?void 0:y.baseToken.decimals);let c=k.fromString("1"+"0".repeat(Math.abs(g)));return g>=0&&(c=k.fromString("1").div(c)),c}if(!this.fundLastNAVUpdate.totalNAV||!((m=this.fund)!=null&&m.fundTokenTotalSupply))return k.fromString("0");const e=((f=this.fund)==null?void 0:f.totalSimulatedNav)||this.fundLastNAVUpdate.totalNAV;console.warn("Total Simulated NAV: ",(T=this.fund)==null?void 0:T.totalSimulatedNav,"Last NAV: ",this.fundLastNAVUpdate.totalNAV);const t=k.fromString(ee(e,this.fund.baseToken.decimals));return k.fromString(ee(this.fund.fundTokenTotalSupply,this.fund.fundToken.decimals)).div(t)},fundToBaseTokenExchangeRate(){return this.baseToFundTokenExchangeRate.eq(k.fromString("0"))?this.baseToFundTokenExchangeRate:k.fromString("1").div(this.baseToFundTokenExchangeRate)},userDepositRequest(){return this.fundUserData.depositRequest},userRedemptionRequest(){return this.fundUserData.redemptionRequest},userCurrentValue(){var t,n,a,s;if((t=this.fundLastNAVUpdate)!=null&&t.timestamp)return((n=this.fundUserData)==null?void 0:n.fundShareValue)||0n;const e=((a=this.fund)==null?void 0:a.fundTokenTotalSupply)||0n;return e?(this.fundTotalNAV*((s=this.fundUserData)==null?void 0:s.fundTokenBalance)||0n)/e:0n},fundTotalNAV(){var e,t,n;return(e=this.fundLastNAVUpdate)!=null&&e.timestamp?((t=this.fund)==null?void 0:t.lastNAVUpdateTotalNAV)||0n:((n=this.fund)==null?void 0:n.totalDepositBalance)||0n},fundTotalNAVFormattedShort(){var e;return(e=this.fund)!=null&&e.address?this.getFormattedBaseTokenValue(this.fundTotalNAV):"N/A"},selectedFundSlug(){var e,t;return(this.selectedFundChain||"")+"-"+(((e=this.fund)==null?void 0:e.fundToken.symbol)||"")+"-"+(((t=this.fund)==null?void 0:t.address)||"")},fundLastNAVUpdate(){var t,n,a,s;const e=(n=(t=this.fund)==null?void 0:t.navUpdates)==null?void 0:n.length;if(e)return console.warn("fundLastNAVUpdate",(a=this.fund)==null?void 0:a.navUpdates[e-1]),(s=this.fund)==null?void 0:s.navUpdates[e-1]},fundLastNAVUpdateMethods(){var e;return((e=this.fundLastNAVUpdate)==null?void 0:e.entries)||[]},userDepositRequestExists(){var e;return(((e=this.fundUserData.depositRequest)==null?void 0:e.amount)||0)>0},userRedemptionRequestExists(){var e;return(((e=this.fundUserData.redemptionRequest)==null?void 0:e.amount)||0)>0},userFundSuggestedAllowance(){var n,a;const e=((n=this.fundUserData)==null?void 0:n.baseTokenBalance)||0n,t=((a=this.fundUserData.depositRequest)==null?void 0:a.amount)||0n;return e+t},userFundSuggestedAllowanceFormatted(){var e;return ee(this.userFundSuggestedAllowance,(e=this.fund)==null?void 0:e.baseToken.decimals)},isUserWalletWhitelisted(){var t,n,a;return(t=this.fund)!=null&&t.isWhitelistedDeposits?(((n=this.fund)==null?void 0:n.allowedDepositAddresses)||[]).map(s=>s.toLowerCase()).includes(((a=this.activeAccountAddress)==null?void 0:a.toLowerCase())||""):!0},shouldUserDelegate(){var e,t;return((e=this.fundUserData)==null?void 0:e.fundDelegateAddress)===me||!((t=this.fundUserData)!=null&&t.fundDelegateAddress)},shouldUserRequestDeposit(){return!this.userDepositRequestExists},shouldUserApproveAllowance(){var e,t;return this.userDepositRequestExists&&(((e=this.fundUserData)==null?void 0:e.fundAllowance)||0n)<(((t=this.fundUserData.depositRequest)==null?void 0:t.amount)||0n)},canUserProcessDeposit(){return!this.shouldUserRequestDeposit&&!this.shouldUserApproveAllowance},shouldUserWaitSettlementOrCancelDeposit(){var e,t,n,a,s;return console.log(`Should process deposit: fundLastNAVUpdate.timestamp: ${(e=this.fundLastNAVUpdate)==null?void 0:e.timestamp} 
        userDepositRequest.timestamp ${(t=this.fundUserData.depositRequest)==null?void 0:t.timestamp}`),!this.canUserProcessDeposit||!((n=this.fundLastNAVUpdate)!=null&&n.timestamp)||!((a=this.fundUserData.depositRequest)!=null&&a.timestamp)?!1:this.fundUserData.depositRequest.timestamp>=((s=this.fundLastNAVUpdate)==null?void 0:s.timestamp)},shouldUserWaitSettlementOrCancelRedemption(){var e,t,n,a,s;return console.log(`Should process withdraw: fundLastNAVUpdate.timestamp: ${(e=this.fundLastNAVUpdate)==null?void 0:e.timestamp} 
        userDepositRequest.timestamp ${(t=this.fundUserData.redemptionRequest)==null?void 0:t.timestamp}`),!((n=this.fundLastNAVUpdate)!=null&&n.timestamp)||!((a=this.fundUserData.redemptionRequest)!=null&&a.timestamp)?!1:this.fundUserData.redemptionRequest.timestamp>=((s=this.fundLastNAVUpdate)==null?void 0:s.timestamp)},totalCurrentSimulatedNAV(){var t,n,a;return(this.fundLastNAVUpdateMethods.reduce((s,r)=>s+(r.simulatedNav||0n),0n)||0n)+(((t=this.fund)==null?void 0:t.fundContractBaseTokenBalance)||0n)+(((n=this.fund)==null?void 0:n.safeContractBaseTokenBalance)||0n)+(((a=this.fund)==null?void 0:a.feeBalance)||0n)},getFormattedBaseTokenValue:e=>(t,n=!0,a=!1,s,r)=>{var p,l,y,m;const i=(l=(p=e.chainFunds)==null?void 0:p[e.selectedFundChain])==null?void 0:l[e.selectedFundAddress],o=s||((y=i==null?void 0:i.baseToken)==null?void 0:y.symbol),d=r||((m=i==null?void 0:i.baseToken)==null?void 0:m.decimals)||18,u=t?te(t,d,n,a):"0";return o?u+" "+o:u},getFormattedFundTokenValue:e=>(t,n=!0,a=!1)=>{var d,u;const s=(u=(d=e.chainFunds)==null?void 0:d[e.selectedFundChain])==null?void 0:u[e.selectedFundAddress],r=s==null?void 0:s.fundToken.symbol,i=s==null?void 0:s.fundToken.decimals;return i?(t?te(t,i,n,a):"0")+" "+r:t},navCalculatorContract(){return this.web3Store.getCustomContract(this.selectedFundChain,Ge.abi,this.web3Store.NAVCalculatorBeaconProxyAddress)},fundContract(){return this.web3Store.getCustomContract(this.selectedFundChain,L.abi,this.selectedFundAddress)},fundSafeContract(){var e;return this.web3Store.getCustomContract(this.selectedFundChain,aa.abi,(e=this.fund)==null?void 0:e.safeAddress)},fundGovernorContract(){var e;return this.web3Store.getCustomContract(this.selectedFundChain,Ut.abi,(e=this.fund)==null?void 0:e.governorAddress)},fundBaseTokenContract(){var e,t;return this.web3Store.getCustomContract(this.selectedFundChain,ne,(t=(e=this.fund)==null?void 0:e.baseToken)==null?void 0:t.address)},fundGovernanceTokenContract(){var e;return this.web3Store.getCustomContract(this.selectedFundChain,ta.abi,(e=this.fund)==null?void 0:e.governanceToken.address)}},actions:{resetFundData(e,t){this.chainFunds[e][t]=void 0,this.fundUserData.depositRequest=void 0,this.fundUserData.redemptionRequest=void 0,this.fundManagedNAVMethods=[],this.fundInitialNAVMethods=[],this.fundRoleModAddress={},this.fundUserData=structuredClone(Re)},async fetchAddressSourceCode(e,t){var s;if(!t)return;if(this.chainAddressSourceCode[e][t])return this.chainAddressSourceCode[e][t];const{$getExplorer:n}=Oe();let a;try{a=n(e)}catch{this.chainAddressSourceCode[e][t]=void 0;return}if(t.toLowerCase()===((s=this.fund)==null?void 0:s.address.toLowerCase())){const r={ContractName:this.fund.title+" (GovernableFund)",ABI:JSON.stringify(L.abi)};return this.chainAddressSourceCode[e][t]=r,r}try{const r=await a.sourceCode(t);if(r.Proxy==="0"){try{const i=this.web3Store.getCustomContract(e,ne,t);r.symbol=await i.methods.symbol().call()}catch{}this.chainAddressSourceCode[e][t]=r}return r}catch{this.chainAddressSourceCode[e][t]=void 0;return}},async getAddressLabel(e,t){var a,s;if(!t)return;if(this.addressLabelMap[e])return this.addressLabelMap[e];if((a=this.fundsStore.chainAddressLabelMap[t])!=null&&a[e])return(s=this.fundsStore.chainAddressLabelMap[t])==null?void 0:s[e];const n=await this.fetchAddressSourceCode(t,e);if(n!=null&&n.symbol){let r=n==null?void 0:n.symbol;if(n!=null&&n.ContractName)return r+=` (${n.ContractName})`,r}return n==null?void 0:n.ContractName},fetchFundData(e,t){return h("fetchFundDataAction",()=>Wt(e,t))},fetchFundSettings(e,t){return h("fetchFundSettingsAction",()=>sa(e,t))},fetchFundNAVData(){return h("fetchFundNAVDataAction",()=>gn())},fetchUserFundData(e,t){return h("fetchUserFundDataAction",()=>Hn(e,t))},fetchFundMetaData(e,t){return h("fetchFundMetaDataAction",()=>Qt(e,t))},fetchFundPendingDepositRedemptionBalance(){this.fund&&(this.fund.pendingDepositBalanceError=!1,this.fund.pendingRedemptionBalanceError=!1,this.fund.pendingDepositBalanceLoading=!0,this.fund.pendingRedemptionBalanceLoading=!0,this.web3Store.callWithRetry(this.selectedFundChain,()=>this.fundContract.methods.getCurrentPendingDepositBal().call()).then(e=>{this.fund&&(this.fund.pendingDepositBalance=e)}).catch(e=>{console.error("failed fetching fund deposit requests balance.",e),this.fund&&(this.fund.pendingDepositBalanceError=!0)}).finally(()=>{this.fund&&(this.fund.pendingDepositBalanceLoading=!1)}),this.web3Store.callWithRetry(this.selectedFundChain,()=>this.fundContract.methods.getCurrentPendingWithdrawalBal().call()).then(e=>{this.fund&&(this.fund.pendingRedemptionBalance=e)}).catch(e=>{console.error("failed fetching fund redemption requests balance.",e),this.fund&&(this.fund.pendingRedemptionBalanceError=!0)}).finally(()=>{this.fund&&(this.fund.pendingRedemptionBalanceLoading=!1)}))},simulateCurrentNAV(e=!1){return h("fetchSimulateCurrentNAVAction",()=>On(this.selectedFundChain,this.fundAddress,e))},fetchSimulatedNAVMethodValue(e,t,n,a,s,r,i=!1,o=!1){return h("fetchSimulatedNAVMethodValueAction",()=>Ln(e,t,n,a,s,r,i,o))},parseFundNAVUpdates(e,t,n){return h("parseFundNAVUpdatesAction",()=>Xn(e,t,n))},fetchUserBaseTokenBalance(){return h("fetchUserBaseTokenBalanceAction",()=>_n())},fetchUserFundTokenBalance(){return h("fetchUserFundTokenBalanceAction",()=>jn())},fetchUserGovernanceTokenBalance(){return h("fetchUserGovernanceTokenBalanceAction",()=>zn())},fetchUserFundDelegateAddress(){return h("fetchUserFundDelegateAddressAction",()=>Gn())},fetchUserFundAllowance(){return h("fetchUserFundAllowanceAction",()=>qn())},fetchUserFundShareValue(){return h("fetchUserFundShareValueAction",()=>Jn())},fetchUserFundDepositRedemptionRequests(){return h("fetchUserFundDepositRedemptionRequestsAction",()=>$n())},fetchUserFundTransactionRequest(e){return h("fetchUserFundTransactionRequestAction",()=>Kn(e))},async fetchFundContractBaseTokenBalance(){var t;if(!((t=this.fund)!=null&&t.address))return;this.fund.fundContractBaseTokenBalanceLoading=!0;let e=BigInt("0");try{e=await this.web3Store.callWithRetry(this.selectedFundChain,()=>{var n;return this.fundBaseTokenContract.methods.balanceOf((n=this.fund)==null?void 0:n.address).call()}),this.fund.fundContractBaseTokenBalanceError=!1}catch(n){this.fund.fundContractBaseTokenBalanceError=!0,console.error("Failed fetching fetchFundBaseTokenBalance error. -> ",n)}this.fund.fundContractBaseTokenBalance=e,this.fund.fundContractBaseTokenBalanceLoading=!1},fetchRoleModAddress(e){return h("fetchRoleModAddressAddressAction",()=>ra(e))},postUpdateNAV(){return h("postUpdateNAVAction",()=>ea())},calculateFundPerformanceMetrics(e){return h("calculateFundPerformanceMetricsAction",()=>It(e))}}});export{_ as A,Qe as B,se as C,Na as D,ne as E,h as F,aa as G,ma as H,la as I,on as J,F as K,sn as L,ba as M,Ye as N,fa as O,v as P,rn as Q,Ut as R,ca as S,ya as T,Se as U,be as V,An as W,fn as X,he as Y,nn as Z,dn as a,Ea as b,Sa as c,Fa as d,va as e,ga as f,Ta as g,j as h,Vt as i,q as j,hn as k,wa as l,xa as m,Ma as n,an as o,tt as p,Aa as q,C as r,bn as s,ha as t,S as u,pn as v,ie as w,Ve as x,et as y,L as z};

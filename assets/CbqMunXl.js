import te from"./DpsThwoF.js";import se from"./H7YDYKaw.js";import ae from"./CRSZcHhx.js";import{d as ne,u as oe,cZ as le,r as L,h as B,f as _,b as C,a as p,w as k,p as w,cu as I,cY as F,V as ie,e as y,q as $,c as x,cF as N,c8 as V,l as re,o as r,G as q,Q as ue,d4 as ce,_ as de}from"./_BmmGIGi.js";import{V as pe}from"./DpICAjib.js";import{V as me}from"./E_YhHG9T.js";import{V as _e}from"./B9vFmp28.js";import"./CVAO7RcL.js";import"./cVa1OdO9.js";import"./D_-Msn7h.js";import"./BlSCcxsD.js";import"./BJ2h6DUM.js";import"./D5-R3KnC.js";import"./B5L2f44s.js";import"./C7URMWzZ.js";import"./DcNhhkuR.js";import"./CsjIet9h.js";import"./C4hVFzQI.js";import"./DeSAm6LB.js";import"./Cx6b7hxJ.js";const ve={class:"section-stepper"},fe={class:"main_header__title"},ye={class:"buttons"},be={class:"stepper"},Se={class:"main_card stepper__main-steps"},he=["onClick"],ke={class:"main-step__count"},Ne={key:0,class:"sub-steps"},Ve=["onClick"],ge={class:"sub-steps__label"},Ce={class:"sub-steps__icons"},we={class:"sub-steps__feedback-icons"},xe=["onClick"],Le={class:"main_card stepper__step-content"},$e=ne({__name:"Stepper",props:{entry:{type:Array,default:()=>[]},fieldsMap:{type:Object,default:()=>({})},title:{type:String,default:""},tooltipText:{type:String,default:""},tooltipClick:{type:Function,default:()=>{}},submitLabel:{type:String,default:"Submit"},submitEvent:{type:Function,default:()=>{}},isSubmitLoading:{type:Boolean,default:!1},alwaysShowLastStep:{type:Boolean,default:!1}},emits:["fields-changed"],setup(b,{emit:J}){const K=oe(),M=le(),j=J,a=b,T=L(),E=L(!1),S=a.entry.map(e=>e.stepName),o=L(S[0]),l=L(0),O=B(()=>{const{steps:e,subStepKey:t}=a.entry.find(n=>n.stepName===o.value);return e[l.value][t]}),z=B(()=>{var e,t;if(O.value){const n=(t=(e=a.entry.find(u=>u.stepName===o.value))==null?void 0:e.steps)==null?void 0:t[l.value];return j("fields-changed",o.value,l.value,n),a.fieldsMap[o.value][O.value]||[]}return a.fieldsMap[o.value]||[]}),g=B(()=>{var e,t,n;return a.alwaysShowLastStep?!0:o.value===S[S.length-1]&&l.value===((n=(t=(e=a.entry)==null?void 0:e[S.length-1])==null?void 0:t.steps)==null?void 0:n.length)-1}),G=e=>[{"main-step--active":o.value===e.stepName},{"main-step--error":e.steps.some(t=>t.isValid===!1)},{"main-step--success":e.steps.every(t=>t.isValid===!0)}],H=e=>{o.value!==e&&(o.value=e,l.value=0)},P=(e,t)=>{o.value=e.stepName,l.value=t},Q=e=>{var u,c,f,s,m,i,d,v;o.value=e.stepName;const t=a.entry.findIndex(h=>h.stepName===e.stepName),n=JSON.parse(JSON.stringify((c=(u=a.entry)==null?void 0:u[t])==null?void 0:c.stepDefaultValues));(m=(s=(f=a.entry)==null?void 0:f[t])==null?void 0:s.steps)==null||m.push(n),l.value=((v=(d=(i=a.entry)==null?void 0:i[t])==null?void 0:d.steps)==null?void 0:v.length)-1,o.value=e.stepName},R=(e,t)=>{var u,c,f,s,m,i,d,v,h,U,A,D;const n=a.entry.findIndex(ee=>ee.stepName===e.stepName);((f=(c=(u=a.entry)==null?void 0:u[n])==null?void 0:c.steps)==null?void 0:f.length)!==1&&((i=(m=(s=a.entry)==null?void 0:s[n])==null?void 0:m.steps)==null||i.splice(t,1),l.value===((h=(v=(d=a.entry)==null?void 0:d[n])==null?void 0:v.steps)==null?void 0:h.length)&&(l.value=((D=(A=(U=a.entry)==null?void 0:U[n])==null?void 0:A.steps)==null?void 0:D.length)-1))},Y=()=>{const e=a.entry.map(t=>t.steps.every(n=>n.isValid===!0));E.value=e.every(t=>t===!0)},Z=()=>{g.value?W():X()},W=()=>{var e;E.value?a.submitEvent():((e=T.value)==null||e.validate(),K.warningToast("Please fill all the required fields"))},X=()=>{var t,n,u;const e=a.entry.findIndex(c=>c.stepName===o.value);if(l.value===((u=(n=(t=a.entry)==null?void 0:t[e])==null?void 0:n.steps)==null?void 0:u.length)-1){const c=S.indexOf(o.value)+1;o.value=S[c],l.value=0}else l.value=l.value+1};return(e,t)=>{const n=te,u=se,c=re("Icon"),f=ae;return r(),_("section",ve,[C(n,null,{default:k(()=>[p("div",fe,[w(e.$slots,"title",{},()=>[$(V(b.title),1)],!0),w(e.$slots,"subtitle",{},void 0,!0)]),p("div",ye,[w(e.$slots,"buttons",{},void 0,!0),C(ie,{type:y(g)?"submit":"button",loading:b.isSubmitLoading,disabled:y(g)&&!y(M).isConnected,onClick:Z},{default:k(()=>[$(V(y(g)?b.submitLabel:"Next")+" ",1),y(g)&&!y(M).isConnected?(r(),x(me,{key:0,"model-value":!0,activator:"parent",location:"top","onUpdate:modelValue":s=>!0},{default:k(()=>t[0]||(t[0]=[$(" Connect your wallet to create a proposal. ")])),_:1})):N("",!0)]),_:1},8,["type","loading","disabled"])])]),_:3}),p("div",be,[p("div",Se,[(r(!0),_(I,null,F(b.entry,(s,m)=>(r(),_("div",{key:m,class:q(["main-step",G(s)])},[p("div",{class:"main-step__title",onClick:i=>H(s.stepName)},[p("div",ke,V(m+1),1),$(" "+V(s.stepLabel),1)],8,he),s.multipleSteps?(r(),_("div",Ne,[(r(!0),_(I,null,F(s.steps,(i,d)=>{var v;return r(),_("div",{key:d,class:q(["sub-steps__sub-step",{"sub-steps__sub-step--active":d===l.value&&s.stepName===o.value}]),onClick:h=>P(s,d)},[t[1]||(t[1]=p("div",{class:"sub-steps__dashed-line"},null,-1)),p("div",ge,V(i[s.subStepKey]??s.subStepLabel+" "+(d+1)),1),p("div",Ce,[s.steps&&((v=s.steps)==null?void 0:v.length)>1&&d===l.value&&s.stepName===o.value?(r(),x(u,{key:0,small:"",class:"sub-steps__delete-button",onClick:ce(h=>R(s,d),["stop"])},{default:k(()=>[C(ue,{icon:"mdi-delete",color:"error"})]),_:2},1032,["onClick"])):N("",!0),p("div",we,[i.isValid===!1?(r(),x(c,{key:0,icon:"weui:error-outlined",width:"1rem",class:"sub-steps__icon error"})):i.isValid===!0?(r(),x(c,{key:1,icon:"material-symbols:check-circle-outline",width:"1rem",class:"sub-steps__icon success"})):N("",!0)])])],10,Ve)}),128)),s.stepName===o.value?(r(),_("div",{key:0,class:"sub-steps__add-new-step",onClick:i=>Q(s)}," Add "+V(s.subStepLabel)+" + ",9,xe)):N("",!0)])):N("",!0)],2))),128)),w(e.$slots,"post-steps-content",{},void 0,!0)]),p("div",Le,[w(e.$slots,"pre-content",{},void 0,!0),C(pe,{ref_key:"form",ref:T},{default:k(()=>[(r(!0),_(I,null,F(b.entry,(s,m)=>(r(),_("div",{key:m,class:"form__content"},[s.stepName===o.value?(r(),x(_e,{key:0},{default:k(()=>{var i;return[C(f,{"model-value":(i=s==null?void 0:s.steps)==null?void 0:i[l.value],fields:y(z),title:s.formTitle,text:s.formText,onValidate:Y},null,8,["model-value","fields","title","text"])]}),_:2},1024)):N("",!0)]))),128))]),_:1},512)])])])}}}),Ye=de($e,[["__scopeId","data-v-c1875401"]]);export{Ye as default};

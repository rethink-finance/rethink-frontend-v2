const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CE5scWAc.js","./D3HDfnxy.js","./entry.CUOGr28A.css","./D35O9kdy.js"])))=>i.map(i=>d[i]);
import{fM as _w,fN as bw,dt as Gr,fA as hr,dx as Ew}from"./D3HDfnxy.js";import{H as Sw,b as uh,I as Qr,J as as,K as Vl,d as ee,C as Iw,f as Bl,e as nr,g as Ji,h as cs,i as tr,j as Yi,k as hh,l as Kl,m as Ow,n as Pw,o as Wl,p as da,q as Nw,w as us,t as hs,E as jt,u as Aw,y as Lt,P as lh,Q as Cw,v as Rw,x as pa,z as ga,B as ya,D as Rr,_ as Tw,G as Jr}from"./BCcgNO-W.js";import{r as xw}from"./DQ172AOg.js";var Co={},$i={},ve={},Ro={},fh;function $w(){return fh||(fh=1,function(o){Object.defineProperty(o,"__esModule",{value:!0});function t(d,v){var S=d>>>16&65535,I=d&65535,R=v>>>16&65535,x=v&65535;return I*x+(S*x+I*R<<16>>>0)|0}o.mul=Math.imul||t;function i(d,v){return d+v|0}o.add=i;function n(d,v){return d-v|0}o.sub=n;function a(d,v){return d<<v|d>>>32-v}o.rotl=a;function h(d,v){return d<<32-v|d>>>v}o.rotr=h;function p(d){return typeof d=="number"&&isFinite(d)&&Math.floor(d)===d}o.isInteger=Number.isInteger||p,o.MAX_SAFE_INTEGER=9007199254740991,o.isSafeInteger=function(d){return o.isInteger(d)&&d>=-o.MAX_SAFE_INTEGER&&d<=o.MAX_SAFE_INTEGER}}(Ro)),Ro}var dh;function ls(){if(dh)return ve;dh=1,Object.defineProperty(ve,"__esModule",{value:!0});var o=$w();function t(U,P){return P===void 0&&(P=0),(U[P+0]<<8|U[P+1])<<16>>16}ve.readInt16BE=t;function i(U,P){return P===void 0&&(P=0),(U[P+0]<<8|U[P+1])>>>0}ve.readUint16BE=i;function n(U,P){return P===void 0&&(P=0),(U[P+1]<<8|U[P])<<16>>16}ve.readInt16LE=n;function a(U,P){return P===void 0&&(P=0),(U[P+1]<<8|U[P])>>>0}ve.readUint16LE=a;function h(U,P,$){return P===void 0&&(P=new Uint8Array(2)),$===void 0&&($=0),P[$+0]=U>>>8,P[$+1]=U>>>0,P}ve.writeUint16BE=h,ve.writeInt16BE=h;function p(U,P,$){return P===void 0&&(P=new Uint8Array(2)),$===void 0&&($=0),P[$+0]=U>>>0,P[$+1]=U>>>8,P}ve.writeUint16LE=p,ve.writeInt16LE=p;function d(U,P){return P===void 0&&(P=0),U[P]<<24|U[P+1]<<16|U[P+2]<<8|U[P+3]}ve.readInt32BE=d;function v(U,P){return P===void 0&&(P=0),(U[P]<<24|U[P+1]<<16|U[P+2]<<8|U[P+3])>>>0}ve.readUint32BE=v;function S(U,P){return P===void 0&&(P=0),U[P+3]<<24|U[P+2]<<16|U[P+1]<<8|U[P]}ve.readInt32LE=S;function I(U,P){return P===void 0&&(P=0),(U[P+3]<<24|U[P+2]<<16|U[P+1]<<8|U[P])>>>0}ve.readUint32LE=I;function R(U,P,$){return P===void 0&&(P=new Uint8Array(4)),$===void 0&&($=0),P[$+0]=U>>>24,P[$+1]=U>>>16,P[$+2]=U>>>8,P[$+3]=U>>>0,P}ve.writeUint32BE=R,ve.writeInt32BE=R;function x(U,P,$){return P===void 0&&(P=new Uint8Array(4)),$===void 0&&($=0),P[$+0]=U>>>0,P[$+1]=U>>>8,P[$+2]=U>>>16,P[$+3]=U>>>24,P}ve.writeUint32LE=x,ve.writeInt32LE=x;function A(U,P){P===void 0&&(P=0);var $=d(U,P),K=d(U,P+4);return $*4294967296+K-(K>>31)*4294967296}ve.readInt64BE=A;function j(U,P){P===void 0&&(P=0);var $=v(U,P),K=v(U,P+4);return $*4294967296+K}ve.readUint64BE=j;function z(U,P){P===void 0&&(P=0);var $=S(U,P),K=S(U,P+4);return K*4294967296+$-($>>31)*4294967296}ve.readInt64LE=z;function F(U,P){P===void 0&&(P=0);var $=I(U,P),K=I(U,P+4);return K*4294967296+$}ve.readUint64LE=F;function V(U,P,$){return P===void 0&&(P=new Uint8Array(8)),$===void 0&&($=0),R(U/4294967296>>>0,P,$),R(U>>>0,P,$+4),P}ve.writeUint64BE=V,ve.writeInt64BE=V;function l(U,P,$){return P===void 0&&(P=new Uint8Array(8)),$===void 0&&($=0),x(U>>>0,P,$),x(U/4294967296>>>0,P,$+4),P}ve.writeUint64LE=l,ve.writeInt64LE=l;function w(U,P,$){if($===void 0&&($=0),U%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(U/8>P.length-$)throw new Error("readUintBE: array is too short for the given bitLength");for(var K=0,ae=1,te=U/8+$-1;te>=$;te--)K+=P[te]*ae,ae*=256;return K}ve.readUintBE=w;function g(U,P,$){if($===void 0&&($=0),U%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(U/8>P.length-$)throw new Error("readUintLE: array is too short for the given bitLength");for(var K=0,ae=1,te=$;te<$+U/8;te++)K+=P[te]*ae,ae*=256;return K}ve.readUintLE=g;function y(U,P,$,K){if($===void 0&&($=new Uint8Array(U/8)),K===void 0&&(K=0),U%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!o.isSafeInteger(P))throw new Error("writeUintBE value must be an integer");for(var ae=1,te=U/8+K-1;te>=K;te--)$[te]=P/ae&255,ae*=256;return $}ve.writeUintBE=y;function E(U,P,$,K){if($===void 0&&($=new Uint8Array(U/8)),K===void 0&&(K=0),U%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!o.isSafeInteger(P))throw new Error("writeUintLE value must be an integer");for(var ae=1,te=K;te<K+U/8;te++)$[te]=P/ae&255,ae*=256;return $}ve.writeUintLE=E;function u(U,P){P===void 0&&(P=0);var $=new DataView(U.buffer,U.byteOffset,U.byteLength);return $.getFloat32(P)}ve.readFloat32BE=u;function b(U,P){P===void 0&&(P=0);var $=new DataView(U.buffer,U.byteOffset,U.byteLength);return $.getFloat32(P,!0)}ve.readFloat32LE=b;function H(U,P){P===void 0&&(P=0);var $=new DataView(U.buffer,U.byteOffset,U.byteLength);return $.getFloat64(P)}ve.readFloat64BE=H;function J(U,P){P===void 0&&(P=0);var $=new DataView(U.buffer,U.byteOffset,U.byteLength);return $.getFloat64(P,!0)}ve.readFloat64LE=J;function ne(U,P,$){P===void 0&&(P=new Uint8Array(4)),$===void 0&&($=0);var K=new DataView(P.buffer,P.byteOffset,P.byteLength);return K.setFloat32($,U),P}ve.writeFloat32BE=ne;function he(U,P,$){P===void 0&&(P=new Uint8Array(4)),$===void 0&&($=0);var K=new DataView(P.buffer,P.byteOffset,P.byteLength);return K.setFloat32($,U,!0),P}ve.writeFloat32LE=he;function le(U,P,$){P===void 0&&(P=new Uint8Array(8)),$===void 0&&($=0);var K=new DataView(P.buffer,P.byteOffset,P.byteLength);return K.setFloat64($,U),P}ve.writeFloat64BE=le;function re(U,P,$){P===void 0&&(P=new Uint8Array(8)),$===void 0&&($=0);var K=new DataView(P.buffer,P.byteOffset,P.byteLength);return K.setFloat64($,U,!0),P}return ve.writeFloat64LE=re,ve}var Kn={},ph;function _r(){if(ph)return Kn;ph=1,Object.defineProperty(Kn,"__esModule",{value:!0});function o(t){for(var i=0;i<t.length;i++)t[i]=0;return t}return Kn.wipe=o,Kn}var gh;function Uw(){if(gh)return $i;gh=1,Object.defineProperty($i,"__esModule",{value:!0});var o=ls(),t=_r(),i=20;function n(d,v,S){for(var I=1634760805,R=857760878,x=2036477234,A=1797285236,j=S[3]<<24|S[2]<<16|S[1]<<8|S[0],z=S[7]<<24|S[6]<<16|S[5]<<8|S[4],F=S[11]<<24|S[10]<<16|S[9]<<8|S[8],V=S[15]<<24|S[14]<<16|S[13]<<8|S[12],l=S[19]<<24|S[18]<<16|S[17]<<8|S[16],w=S[23]<<24|S[22]<<16|S[21]<<8|S[20],g=S[27]<<24|S[26]<<16|S[25]<<8|S[24],y=S[31]<<24|S[30]<<16|S[29]<<8|S[28],E=v[3]<<24|v[2]<<16|v[1]<<8|v[0],u=v[7]<<24|v[6]<<16|v[5]<<8|v[4],b=v[11]<<24|v[10]<<16|v[9]<<8|v[8],H=v[15]<<24|v[14]<<16|v[13]<<8|v[12],J=I,ne=R,he=x,le=A,re=j,U=z,P=F,$=V,K=l,ae=w,te=g,ce=y,ue=E,B=u,Y=b,Z=H,ye=0;ye<i;ye+=2)J=J+re|0,ue^=J,ue=ue>>>16|ue<<16,K=K+ue|0,re^=K,re=re>>>20|re<<12,ne=ne+U|0,B^=ne,B=B>>>16|B<<16,ae=ae+B|0,U^=ae,U=U>>>20|U<<12,he=he+P|0,Y^=he,Y=Y>>>16|Y<<16,te=te+Y|0,P^=te,P=P>>>20|P<<12,le=le+$|0,Z^=le,Z=Z>>>16|Z<<16,ce=ce+Z|0,$^=ce,$=$>>>20|$<<12,he=he+P|0,Y^=he,Y=Y>>>24|Y<<8,te=te+Y|0,P^=te,P=P>>>25|P<<7,le=le+$|0,Z^=le,Z=Z>>>24|Z<<8,ce=ce+Z|0,$^=ce,$=$>>>25|$<<7,ne=ne+U|0,B^=ne,B=B>>>24|B<<8,ae=ae+B|0,U^=ae,U=U>>>25|U<<7,J=J+re|0,ue^=J,ue=ue>>>24|ue<<8,K=K+ue|0,re^=K,re=re>>>25|re<<7,J=J+U|0,Z^=J,Z=Z>>>16|Z<<16,te=te+Z|0,U^=te,U=U>>>20|U<<12,ne=ne+P|0,ue^=ne,ue=ue>>>16|ue<<16,ce=ce+ue|0,P^=ce,P=P>>>20|P<<12,he=he+$|0,B^=he,B=B>>>16|B<<16,K=K+B|0,$^=K,$=$>>>20|$<<12,le=le+re|0,Y^=le,Y=Y>>>16|Y<<16,ae=ae+Y|0,re^=ae,re=re>>>20|re<<12,he=he+$|0,B^=he,B=B>>>24|B<<8,K=K+B|0,$^=K,$=$>>>25|$<<7,le=le+re|0,Y^=le,Y=Y>>>24|Y<<8,ae=ae+Y|0,re^=ae,re=re>>>25|re<<7,ne=ne+P|0,ue^=ne,ue=ue>>>24|ue<<8,ce=ce+ue|0,P^=ce,P=P>>>25|P<<7,J=J+U|0,Z^=J,Z=Z>>>24|Z<<8,te=te+Z|0,U^=te,U=U>>>25|U<<7;o.writeUint32LE(J+I|0,d,0),o.writeUint32LE(ne+R|0,d,4),o.writeUint32LE(he+x|0,d,8),o.writeUint32LE(le+A|0,d,12),o.writeUint32LE(re+j|0,d,16),o.writeUint32LE(U+z|0,d,20),o.writeUint32LE(P+F|0,d,24),o.writeUint32LE($+V|0,d,28),o.writeUint32LE(K+l|0,d,32),o.writeUint32LE(ae+w|0,d,36),o.writeUint32LE(te+g|0,d,40),o.writeUint32LE(ce+y|0,d,44),o.writeUint32LE(ue+E|0,d,48),o.writeUint32LE(B+u|0,d,52),o.writeUint32LE(Y+b|0,d,56),o.writeUint32LE(Z+H|0,d,60)}function a(d,v,S,I,R){if(R===void 0&&(R=0),d.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(I.length<S.length)throw new Error("ChaCha: destination is shorter than source");var x,A;if(R===0){if(v.length!==8&&v.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");x=new Uint8Array(16),A=x.length-v.length,x.set(v,A)}else{if(v.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");x=v,A=R}for(var j=new Uint8Array(64),z=0;z<S.length;z+=64){n(j,x,d);for(var F=z;F<z+64&&F<S.length;F++)I[F]=S[F]^j[F-z];p(x,0,A)}return t.wipe(j),R===0&&t.wipe(x),I}$i.streamXOR=a;function h(d,v,S,I){return I===void 0&&(I=0),t.wipe(S),a(d,v,S,S,I)}$i.stream=h;function p(d,v,S){for(var I=1;S--;)I=I+(d[v]&255)|0,d[v]=I&255,I>>>=8,v++;if(I>0)throw new Error("ChaCha: counter overflow")}return $i}var To={},Br={},yh;function ma(){if(yh)return Br;yh=1,Object.defineProperty(Br,"__esModule",{value:!0});function o(a,h,p){return~(a-1)&h|a-1&p}Br.select=o;function t(a,h){return(a|0)-(h|0)-1>>>31&1}Br.lessOrEqual=t;function i(a,h){if(a.length!==h.length)return 0;for(var p=0,d=0;d<a.length;d++)p|=a[d]^h[d];return 1&p-1>>>8}Br.compare=i;function n(a,h){return a.length===0||h.length===0?!1:i(a,h)!==0}return Br.equal=n,Br}var mh;function Dw(){return mh||(mh=1,function(o){Object.defineProperty(o,"__esModule",{value:!0});var t=ma(),i=_r();o.DIGEST_LENGTH=16;var n=function(){function p(d){this.digestLength=o.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var v=d[0]|d[1]<<8;this._r[0]=v&8191;var S=d[2]|d[3]<<8;this._r[1]=(v>>>13|S<<3)&8191;var I=d[4]|d[5]<<8;this._r[2]=(S>>>10|I<<6)&7939;var R=d[6]|d[7]<<8;this._r[3]=(I>>>7|R<<9)&8191;var x=d[8]|d[9]<<8;this._r[4]=(R>>>4|x<<12)&255,this._r[5]=x>>>1&8190;var A=d[10]|d[11]<<8;this._r[6]=(x>>>14|A<<2)&8191;var j=d[12]|d[13]<<8;this._r[7]=(A>>>11|j<<5)&8065;var z=d[14]|d[15]<<8;this._r[8]=(j>>>8|z<<8)&8191,this._r[9]=z>>>5&127,this._pad[0]=d[16]|d[17]<<8,this._pad[1]=d[18]|d[19]<<8,this._pad[2]=d[20]|d[21]<<8,this._pad[3]=d[22]|d[23]<<8,this._pad[4]=d[24]|d[25]<<8,this._pad[5]=d[26]|d[27]<<8,this._pad[6]=d[28]|d[29]<<8,this._pad[7]=d[30]|d[31]<<8}return p.prototype._blocks=function(d,v,S){for(var I=this._fin?0:2048,R=this._h[0],x=this._h[1],A=this._h[2],j=this._h[3],z=this._h[4],F=this._h[5],V=this._h[6],l=this._h[7],w=this._h[8],g=this._h[9],y=this._r[0],E=this._r[1],u=this._r[2],b=this._r[3],H=this._r[4],J=this._r[5],ne=this._r[6],he=this._r[7],le=this._r[8],re=this._r[9];S>=16;){var U=d[v+0]|d[v+1]<<8;R+=U&8191;var P=d[v+2]|d[v+3]<<8;x+=(U>>>13|P<<3)&8191;var $=d[v+4]|d[v+5]<<8;A+=(P>>>10|$<<6)&8191;var K=d[v+6]|d[v+7]<<8;j+=($>>>7|K<<9)&8191;var ae=d[v+8]|d[v+9]<<8;z+=(K>>>4|ae<<12)&8191,F+=ae>>>1&8191;var te=d[v+10]|d[v+11]<<8;V+=(ae>>>14|te<<2)&8191;var ce=d[v+12]|d[v+13]<<8;l+=(te>>>11|ce<<5)&8191;var ue=d[v+14]|d[v+15]<<8;w+=(ce>>>8|ue<<8)&8191,g+=ue>>>5|I;var B=0,Y=B;Y+=R*y,Y+=x*(5*re),Y+=A*(5*le),Y+=j*(5*he),Y+=z*(5*ne),B=Y>>>13,Y&=8191,Y+=F*(5*J),Y+=V*(5*H),Y+=l*(5*b),Y+=w*(5*u),Y+=g*(5*E),B+=Y>>>13,Y&=8191;var Z=B;Z+=R*E,Z+=x*y,Z+=A*(5*re),Z+=j*(5*le),Z+=z*(5*he),B=Z>>>13,Z&=8191,Z+=F*(5*ne),Z+=V*(5*J),Z+=l*(5*H),Z+=w*(5*b),Z+=g*(5*u),B+=Z>>>13,Z&=8191;var ye=B;ye+=R*u,ye+=x*E,ye+=A*y,ye+=j*(5*re),ye+=z*(5*le),B=ye>>>13,ye&=8191,ye+=F*(5*he),ye+=V*(5*ne),ye+=l*(5*J),ye+=w*(5*H),ye+=g*(5*b),B+=ye>>>13,ye&=8191;var Ie=B;Ie+=R*b,Ie+=x*u,Ie+=A*E,Ie+=j*y,Ie+=z*(5*re),B=Ie>>>13,Ie&=8191,Ie+=F*(5*le),Ie+=V*(5*he),Ie+=l*(5*ne),Ie+=w*(5*J),Ie+=g*(5*H),B+=Ie>>>13,Ie&=8191;var be=B;be+=R*H,be+=x*b,be+=A*u,be+=j*E,be+=z*y,B=be>>>13,be&=8191,be+=F*(5*re),be+=V*(5*le),be+=l*(5*he),be+=w*(5*ne),be+=g*(5*J),B+=be>>>13,be&=8191;var Se=B;Se+=R*J,Se+=x*H,Se+=A*b,Se+=j*u,Se+=z*E,B=Se>>>13,Se&=8191,Se+=F*y,Se+=V*(5*re),Se+=l*(5*le),Se+=w*(5*he),Se+=g*(5*ne),B+=Se>>>13,Se&=8191;var Ce=B;Ce+=R*ne,Ce+=x*J,Ce+=A*H,Ce+=j*b,Ce+=z*u,B=Ce>>>13,Ce&=8191,Ce+=F*E,Ce+=V*y,Ce+=l*(5*re),Ce+=w*(5*le),Ce+=g*(5*he),B+=Ce>>>13,Ce&=8191;var Oe=B;Oe+=R*he,Oe+=x*ne,Oe+=A*J,Oe+=j*H,Oe+=z*b,B=Oe>>>13,Oe&=8191,Oe+=F*u,Oe+=V*E,Oe+=l*y,Oe+=w*(5*re),Oe+=g*(5*le),B+=Oe>>>13,Oe&=8191;var Ne=B;Ne+=R*le,Ne+=x*he,Ne+=A*ne,Ne+=j*J,Ne+=z*H,B=Ne>>>13,Ne&=8191,Ne+=F*b,Ne+=V*u,Ne+=l*E,Ne+=w*y,Ne+=g*(5*re),B+=Ne>>>13,Ne&=8191;var xe=B;xe+=R*re,xe+=x*le,xe+=A*he,xe+=j*ne,xe+=z*J,B=xe>>>13,xe&=8191,xe+=F*H,xe+=V*b,xe+=l*u,xe+=w*E,xe+=g*y,B+=xe>>>13,xe&=8191,B=(B<<2)+B|0,B=B+Y|0,Y=B&8191,B=B>>>13,Z+=B,R=Y,x=Z,A=ye,j=Ie,z=be,F=Se,V=Ce,l=Oe,w=Ne,g=xe,v+=16,S-=16}this._h[0]=R,this._h[1]=x,this._h[2]=A,this._h[3]=j,this._h[4]=z,this._h[5]=F,this._h[6]=V,this._h[7]=l,this._h[8]=w,this._h[9]=g},p.prototype.finish=function(d,v){v===void 0&&(v=0);var S=new Uint16Array(10),I,R,x,A;if(this._leftover){for(A=this._leftover,this._buffer[A++]=1;A<16;A++)this._buffer[A]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(I=this._h[1]>>>13,this._h[1]&=8191,A=2;A<10;A++)this._h[A]+=I,I=this._h[A]>>>13,this._h[A]&=8191;for(this._h[0]+=I*5,I=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=I,I=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=I,S[0]=this._h[0]+5,I=S[0]>>>13,S[0]&=8191,A=1;A<10;A++)S[A]=this._h[A]+I,I=S[A]>>>13,S[A]&=8191;for(S[9]-=8192,R=(I^1)-1,A=0;A<10;A++)S[A]&=R;for(R=~R,A=0;A<10;A++)this._h[A]=this._h[A]&R|S[A];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,x=this._h[0]+this._pad[0],this._h[0]=x&65535,A=1;A<8;A++)x=(this._h[A]+this._pad[A]|0)+(x>>>16)|0,this._h[A]=x&65535;return d[v+0]=this._h[0]>>>0,d[v+1]=this._h[0]>>>8,d[v+2]=this._h[1]>>>0,d[v+3]=this._h[1]>>>8,d[v+4]=this._h[2]>>>0,d[v+5]=this._h[2]>>>8,d[v+6]=this._h[3]>>>0,d[v+7]=this._h[3]>>>8,d[v+8]=this._h[4]>>>0,d[v+9]=this._h[4]>>>8,d[v+10]=this._h[5]>>>0,d[v+11]=this._h[5]>>>8,d[v+12]=this._h[6]>>>0,d[v+13]=this._h[6]>>>8,d[v+14]=this._h[7]>>>0,d[v+15]=this._h[7]>>>8,this._finished=!0,this},p.prototype.update=function(d){var v=0,S=d.length,I;if(this._leftover){I=16-this._leftover,I>S&&(I=S);for(var R=0;R<I;R++)this._buffer[this._leftover+R]=d[v+R];if(S-=I,v+=I,this._leftover+=I,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(S>=16&&(I=S-S%16,this._blocks(d,v,I),v+=I,S-=I),S){for(var R=0;R<S;R++)this._buffer[this._leftover+R]=d[v+R];this._leftover+=S}return this},p.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var d=new Uint8Array(16);return this.finish(d),d},p.prototype.clean=function(){return i.wipe(this._buffer),i.wipe(this._r),i.wipe(this._h),i.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},p}();o.Poly1305=n;function a(p,d){var v=new n(p);v.update(d);var S=v.digest();return v.clean(),S}o.oneTimeAuth=a;function h(p,d){return p.length!==o.DIGEST_LENGTH||d.length!==o.DIGEST_LENGTH?!1:t.equal(p,d)}o.equal=h}(To)),To}var vh;function jw(){return vh||(vh=1,function(o){Object.defineProperty(o,"__esModule",{value:!0});var t=Uw(),i=Dw(),n=_r(),a=ls(),h=ma();o.KEY_LENGTH=32,o.NONCE_LENGTH=12,o.TAG_LENGTH=16;var p=new Uint8Array(16),d=function(){function v(S){if(this.nonceLength=o.NONCE_LENGTH,this.tagLength=o.TAG_LENGTH,S.length!==o.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(S)}return v.prototype.seal=function(S,I,R,x){if(S.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var A=new Uint8Array(16);A.set(S,A.length-S.length);var j=new Uint8Array(32);t.stream(this._key,A,j,4);var z=I.length+this.tagLength,F;if(x){if(x.length!==z)throw new Error("ChaCha20Poly1305: incorrect destination length");F=x}else F=new Uint8Array(z);return t.streamXOR(this._key,A,I,F,4),this._authenticate(F.subarray(F.length-this.tagLength,F.length),j,F.subarray(0,F.length-this.tagLength),R),n.wipe(A),F},v.prototype.open=function(S,I,R,x){if(S.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(I.length<this.tagLength)return null;var A=new Uint8Array(16);A.set(S,A.length-S.length);var j=new Uint8Array(32);t.stream(this._key,A,j,4);var z=new Uint8Array(this.tagLength);if(this._authenticate(z,j,I.subarray(0,I.length-this.tagLength),R),!h.equal(z,I.subarray(I.length-this.tagLength,I.length)))return null;var F=I.length-this.tagLength,V;if(x){if(x.length!==F)throw new Error("ChaCha20Poly1305: incorrect destination length");V=x}else V=new Uint8Array(F);return t.streamXOR(this._key,A,I.subarray(0,I.length-this.tagLength),V,4),n.wipe(A),V},v.prototype.clean=function(){return n.wipe(this._key),this},v.prototype._authenticate=function(S,I,R,x){var A=new i.Poly1305(I);x&&(A.update(x),x.length%16>0&&A.update(p.subarray(x.length%16))),A.update(R),R.length%16>0&&A.update(p.subarray(R.length%16));var j=new Uint8Array(8);x&&a.writeUint64LE(x.length,j),A.update(j),a.writeUint64LE(R.length,j),A.update(j);for(var z=A.digest(),F=0;F<z.length;F++)S[F]=z[F];A.clean(),n.wipe(z),n.wipe(j)},v}();o.ChaCha20Poly1305=d}(Co)),Co}var Gl=jw(),Wn={},pi={},Gn={},wh;function Lw(){if(wh)return Gn;wh=1,Object.defineProperty(Gn,"__esModule",{value:!0});function o(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}return Gn.isSerializableHash=o,Gn}var _h;function qw(){if(_h)return pi;_h=1,Object.defineProperty(pi,"__esModule",{value:!0});var o=Lw(),t=ma(),i=_r(),n=function(){function h(p,d){this._finished=!1,this._inner=new p,this._outer=new p,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var v=new Uint8Array(this.blockSize);d.length>this.blockSize?this._inner.update(d).finish(v).clean():v.set(d);for(var S=0;S<v.length;S++)v[S]^=54;this._inner.update(v);for(var S=0;S<v.length;S++)v[S]^=106;this._outer.update(v),o.isSerializableHash(this._inner)&&o.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),i.wipe(v)}return h.prototype.reset=function(){if(!o.isSerializableHash(this._inner)||!o.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},h.prototype.clean=function(){o.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),o.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},h.prototype.update=function(p){return this._inner.update(p),this},h.prototype.finish=function(p){return this._finished?(this._outer.finish(p),this):(this._inner.finish(p),this._outer.update(p.subarray(0,this.digestLength)).finish(p),this._finished=!0,this)},h.prototype.digest=function(){var p=new Uint8Array(this.digestLength);return this.finish(p),p},h.prototype.saveState=function(){if(!o.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},h.prototype.restoreState=function(p){if(!o.isSerializableHash(this._inner)||!o.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(p),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},h.prototype.cleanSavedState=function(p){if(!o.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(p)},h}();pi.HMAC=n;function a(h,p,d){var v=new n(h,p);v.update(d);var S=v.digest();return v.clean(),S}return pi.hmac=a,pi.equal=t.equal,pi}var bh;function Mw(){if(bh)return Wn;bh=1,Object.defineProperty(Wn,"__esModule",{value:!0});var o=qw(),t=_r(),i=function(){function n(a,h,p,d){p===void 0&&(p=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=a,this._info=d;var v=o.hmac(this._hash,p,h);this._hmac=new o.HMAC(a,v),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var a=this._counter[0];if(a===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),a>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(a){for(var h=new Uint8Array(a),p=0;p<h.length;p++)this._bufpos===this._buffer.length&&this._fillBuffer(),h[p]=this._buffer[this._bufpos++];return h},n.prototype.clean=function(){this._hmac.clean(),t.wipe(this._buffer),t.wipe(this._counter),this._bufpos=0},n}();return Wn.HKDF=i,Wn}var Fw=Mw(),xo={},Ui={},Di={},Eh;function zw(){if(Eh)return Di;Eh=1,Object.defineProperty(Di,"__esModule",{value:!0}),Di.BrowserRandomSource=void 0;const o=65536;class t{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const n=typeof self<"u"?self.crypto||self.msCrypto:null;n&&n.getRandomValues!==void 0&&(this._crypto=n,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(n){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const a=new Uint8Array(n);for(let h=0;h<a.length;h+=o)this._crypto.getRandomValues(a.subarray(h,h+Math.min(a.length-h,o)));return a}}return Di.BrowserRandomSource=t,Di}var ji={},Sh;function kw(){if(Sh)return ji;Sh=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.NodeRandomSource=void 0;const o=_r();class t{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof _w<"u"){const n=Sw();n&&n.randomBytes&&(this._crypto=n,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(n){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let a=this._crypto.randomBytes(n);if(a.length!==n)throw new Error("NodeRandomSource: got fewer bytes than requested");const h=new Uint8Array(n);for(let p=0;p<h.length;p++)h[p]=a[p];return(0,o.wipe)(a),h}}return ji.NodeRandomSource=t,ji}var Ih;function Hw(){if(Ih)return Ui;Ih=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.SystemRandomSource=void 0;const o=zw(),t=kw();class i{constructor(){if(this.isAvailable=!1,this.name="",this._source=new o.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new t.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(a){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(a)}}return Ui.SystemRandomSource=i,Ui}var Oh;function Ql(){return Oh||(Oh=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.randomStringForEntropy=o.randomString=o.randomUint32=o.randomBytes=o.defaultRandomSource=void 0;const t=Hw(),i=ls(),n=_r();o.defaultRandomSource=new t.SystemRandomSource;function a(S,I=o.defaultRandomSource){return I.randomBytes(S)}o.randomBytes=a;function h(S=o.defaultRandomSource){const I=a(4,S),R=(0,i.readUint32LE)(I);return(0,n.wipe)(I),R}o.randomUint32=h;const p="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function d(S,I=p,R=o.defaultRandomSource){if(I.length<2)throw new Error("randomString charset is too short");if(I.length>256)throw new Error("randomString charset is too long");let x="";const A=I.length,j=256-256%A;for(;S>0;){const z=a(Math.ceil(S*256/j),R);for(let F=0;F<z.length&&S>0;F++){const V=z[F];V<j&&(x+=I.charAt(V%A),S--)}(0,n.wipe)(z)}return x}o.randomString=d;function v(S,I=p,R=o.defaultRandomSource){const x=Math.ceil(S/(Math.log(I.length)/Math.LN2));return d(x,I,R)}o.randomStringForEntropy=v}(xo)),xo}var Jl=Ql(),$o={},Ph;function Vw(){return Ph||(Ph=1,function(o){Object.defineProperty(o,"__esModule",{value:!0});var t=ls(),i=_r();o.DIGEST_LENGTH=32,o.BLOCK_SIZE=64;var n=function(){function d(){this.digestLength=o.DIGEST_LENGTH,this.blockSize=o.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return d.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},d.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},d.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._temp),this.reset()},d.prototype.update=function(v,S){if(S===void 0&&(S=v.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var I=0;if(this._bytesHashed+=S,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&S>0;)this._buffer[this._bufferLength++]=v[I++],S--;this._bufferLength===this.blockSize&&(h(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(S>=this.blockSize&&(I=h(this._temp,this._state,v,I,S),S%=this.blockSize);S>0;)this._buffer[this._bufferLength++]=v[I++],S--;return this},d.prototype.finish=function(v){if(!this._finished){var S=this._bytesHashed,I=this._bufferLength,R=S/536870912|0,x=S<<3,A=S%64<56?64:128;this._buffer[I]=128;for(var j=I+1;j<A-8;j++)this._buffer[j]=0;t.writeUint32BE(R,this._buffer,A-8),t.writeUint32BE(x,this._buffer,A-4),h(this._temp,this._state,this._buffer,0,A),this._finished=!0}for(var j=0;j<this.digestLength/4;j++)t.writeUint32BE(this._state[j],v,j*4);return this},d.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},d.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},d.prototype.restoreState=function(v){return this._state.set(v.state),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},d.prototype.cleanSavedState=function(v){i.wipe(v.state),v.buffer&&i.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},d}();o.SHA256=n;var a=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function h(d,v,S,I,R){for(;R>=64;){for(var x=v[0],A=v[1],j=v[2],z=v[3],F=v[4],V=v[5],l=v[6],w=v[7],g=0;g<16;g++){var y=I+g*4;d[g]=t.readUint32BE(S,y)}for(var g=16;g<64;g++){var E=d[g-2],u=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10;E=d[g-15];var b=(E>>>7|E<<25)^(E>>>18|E<<14)^E>>>3;d[g]=(u+d[g-7]|0)+(b+d[g-16]|0)}for(var g=0;g<64;g++){var u=(((F>>>6|F<<26)^(F>>>11|F<<21)^(F>>>25|F<<7))+(F&V^~F&l)|0)+(w+(a[g]+d[g]|0)|0)|0,b=((x>>>2|x<<30)^(x>>>13|x<<19)^(x>>>22|x<<10))+(x&A^x&j^A&j)|0;w=l,l=V,V=F,F=z+u|0,z=j,j=A,A=x,x=u+b|0}v[0]+=x,v[1]+=A,v[2]+=j,v[3]+=z,v[4]+=F,v[5]+=V,v[6]+=l,v[7]+=w,I+=64,R-=64}return I}function p(d){var v=new n;v.update(d);var S=v.digest();return v.clean(),S}o.hash=p}($o)),$o}var va=Vw(),Uo={},Nh;function Bw(){return Nh||(Nh=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),o.sharedKey=o.generateKeyPair=o.generateKeyPairFromSeed=o.scalarMultBase=o.scalarMult=o.SHARED_KEY_LENGTH=o.SECRET_KEY_LENGTH=o.PUBLIC_KEY_LENGTH=void 0;const t=Ql(),i=_r();o.PUBLIC_KEY_LENGTH=32,o.SECRET_KEY_LENGTH=32,o.SHARED_KEY_LENGTH=32;function n(g){const y=new Float64Array(16);if(g)for(let E=0;E<g.length;E++)y[E]=g[E];return y}const a=new Uint8Array(32);a[0]=9;const h=n([56129,1]);function p(g){let y=1;for(let E=0;E<16;E++){let u=g[E]+y+65535;y=Math.floor(u/65536),g[E]=u-y*65536}g[0]+=y-1+37*(y-1)}function d(g,y,E){const u=~(E-1);for(let b=0;b<16;b++){const H=u&(g[b]^y[b]);g[b]^=H,y[b]^=H}}function v(g,y){const E=n(),u=n();for(let b=0;b<16;b++)u[b]=y[b];p(u),p(u),p(u);for(let b=0;b<2;b++){E[0]=u[0]-65517;for(let J=1;J<15;J++)E[J]=u[J]-65535-(E[J-1]>>16&1),E[J-1]&=65535;E[15]=u[15]-32767-(E[14]>>16&1);const H=E[15]>>16&1;E[14]&=65535,d(u,E,1-H)}for(let b=0;b<16;b++)g[2*b]=u[b]&255,g[2*b+1]=u[b]>>8}function S(g,y){for(let E=0;E<16;E++)g[E]=y[2*E]+(y[2*E+1]<<8);g[15]&=32767}function I(g,y,E){for(let u=0;u<16;u++)g[u]=y[u]+E[u]}function R(g,y,E){for(let u=0;u<16;u++)g[u]=y[u]-E[u]}function x(g,y,E){let u,b,H=0,J=0,ne=0,he=0,le=0,re=0,U=0,P=0,$=0,K=0,ae=0,te=0,ce=0,ue=0,B=0,Y=0,Z=0,ye=0,Ie=0,be=0,Se=0,Ce=0,Oe=0,Ne=0,xe=0,ot=0,qt=0,Dr=0,It=0,Xr=0,rn=0,ke=E[0],Te=E[1],He=E[2],Ge=E[3],ut=E[4],Ve=E[5],ht=E[6],Be=E[7],Fe=E[8],Ze=E[9],Xe=E[10],et=E[11],tt=E[12],rt=E[13],it=E[14],nt=E[15];u=y[0],H+=u*ke,J+=u*Te,ne+=u*He,he+=u*Ge,le+=u*ut,re+=u*Ve,U+=u*ht,P+=u*Be,$+=u*Fe,K+=u*Ze,ae+=u*Xe,te+=u*et,ce+=u*tt,ue+=u*rt,B+=u*it,Y+=u*nt,u=y[1],J+=u*ke,ne+=u*Te,he+=u*He,le+=u*Ge,re+=u*ut,U+=u*Ve,P+=u*ht,$+=u*Be,K+=u*Fe,ae+=u*Ze,te+=u*Xe,ce+=u*et,ue+=u*tt,B+=u*rt,Y+=u*it,Z+=u*nt,u=y[2],ne+=u*ke,he+=u*Te,le+=u*He,re+=u*Ge,U+=u*ut,P+=u*Ve,$+=u*ht,K+=u*Be,ae+=u*Fe,te+=u*Ze,ce+=u*Xe,ue+=u*et,B+=u*tt,Y+=u*rt,Z+=u*it,ye+=u*nt,u=y[3],he+=u*ke,le+=u*Te,re+=u*He,U+=u*Ge,P+=u*ut,$+=u*Ve,K+=u*ht,ae+=u*Be,te+=u*Fe,ce+=u*Ze,ue+=u*Xe,B+=u*et,Y+=u*tt,Z+=u*rt,ye+=u*it,Ie+=u*nt,u=y[4],le+=u*ke,re+=u*Te,U+=u*He,P+=u*Ge,$+=u*ut,K+=u*Ve,ae+=u*ht,te+=u*Be,ce+=u*Fe,ue+=u*Ze,B+=u*Xe,Y+=u*et,Z+=u*tt,ye+=u*rt,Ie+=u*it,be+=u*nt,u=y[5],re+=u*ke,U+=u*Te,P+=u*He,$+=u*Ge,K+=u*ut,ae+=u*Ve,te+=u*ht,ce+=u*Be,ue+=u*Fe,B+=u*Ze,Y+=u*Xe,Z+=u*et,ye+=u*tt,Ie+=u*rt,be+=u*it,Se+=u*nt,u=y[6],U+=u*ke,P+=u*Te,$+=u*He,K+=u*Ge,ae+=u*ut,te+=u*Ve,ce+=u*ht,ue+=u*Be,B+=u*Fe,Y+=u*Ze,Z+=u*Xe,ye+=u*et,Ie+=u*tt,be+=u*rt,Se+=u*it,Ce+=u*nt,u=y[7],P+=u*ke,$+=u*Te,K+=u*He,ae+=u*Ge,te+=u*ut,ce+=u*Ve,ue+=u*ht,B+=u*Be,Y+=u*Fe,Z+=u*Ze,ye+=u*Xe,Ie+=u*et,be+=u*tt,Se+=u*rt,Ce+=u*it,Oe+=u*nt,u=y[8],$+=u*ke,K+=u*Te,ae+=u*He,te+=u*Ge,ce+=u*ut,ue+=u*Ve,B+=u*ht,Y+=u*Be,Z+=u*Fe,ye+=u*Ze,Ie+=u*Xe,be+=u*et,Se+=u*tt,Ce+=u*rt,Oe+=u*it,Ne+=u*nt,u=y[9],K+=u*ke,ae+=u*Te,te+=u*He,ce+=u*Ge,ue+=u*ut,B+=u*Ve,Y+=u*ht,Z+=u*Be,ye+=u*Fe,Ie+=u*Ze,be+=u*Xe,Se+=u*et,Ce+=u*tt,Oe+=u*rt,Ne+=u*it,xe+=u*nt,u=y[10],ae+=u*ke,te+=u*Te,ce+=u*He,ue+=u*Ge,B+=u*ut,Y+=u*Ve,Z+=u*ht,ye+=u*Be,Ie+=u*Fe,be+=u*Ze,Se+=u*Xe,Ce+=u*et,Oe+=u*tt,Ne+=u*rt,xe+=u*it,ot+=u*nt,u=y[11],te+=u*ke,ce+=u*Te,ue+=u*He,B+=u*Ge,Y+=u*ut,Z+=u*Ve,ye+=u*ht,Ie+=u*Be,be+=u*Fe,Se+=u*Ze,Ce+=u*Xe,Oe+=u*et,Ne+=u*tt,xe+=u*rt,ot+=u*it,qt+=u*nt,u=y[12],ce+=u*ke,ue+=u*Te,B+=u*He,Y+=u*Ge,Z+=u*ut,ye+=u*Ve,Ie+=u*ht,be+=u*Be,Se+=u*Fe,Ce+=u*Ze,Oe+=u*Xe,Ne+=u*et,xe+=u*tt,ot+=u*rt,qt+=u*it,Dr+=u*nt,u=y[13],ue+=u*ke,B+=u*Te,Y+=u*He,Z+=u*Ge,ye+=u*ut,Ie+=u*Ve,be+=u*ht,Se+=u*Be,Ce+=u*Fe,Oe+=u*Ze,Ne+=u*Xe,xe+=u*et,ot+=u*tt,qt+=u*rt,Dr+=u*it,It+=u*nt,u=y[14],B+=u*ke,Y+=u*Te,Z+=u*He,ye+=u*Ge,Ie+=u*ut,be+=u*Ve,Se+=u*ht,Ce+=u*Be,Oe+=u*Fe,Ne+=u*Ze,xe+=u*Xe,ot+=u*et,qt+=u*tt,Dr+=u*rt,It+=u*it,Xr+=u*nt,u=y[15],Y+=u*ke,Z+=u*Te,ye+=u*He,Ie+=u*Ge,be+=u*ut,Se+=u*Ve,Ce+=u*ht,Oe+=u*Be,Ne+=u*Fe,xe+=u*Ze,ot+=u*Xe,qt+=u*et,Dr+=u*tt,It+=u*rt,Xr+=u*it,rn+=u*nt,H+=38*Z,J+=38*ye,ne+=38*Ie,he+=38*be,le+=38*Se,re+=38*Ce,U+=38*Oe,P+=38*Ne,$+=38*xe,K+=38*ot,ae+=38*qt,te+=38*Dr,ce+=38*It,ue+=38*Xr,B+=38*rn,b=1,u=H+b+65535,b=Math.floor(u/65536),H=u-b*65536,u=J+b+65535,b=Math.floor(u/65536),J=u-b*65536,u=ne+b+65535,b=Math.floor(u/65536),ne=u-b*65536,u=he+b+65535,b=Math.floor(u/65536),he=u-b*65536,u=le+b+65535,b=Math.floor(u/65536),le=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=U+b+65535,b=Math.floor(u/65536),U=u-b*65536,u=P+b+65535,b=Math.floor(u/65536),P=u-b*65536,u=$+b+65535,b=Math.floor(u/65536),$=u-b*65536,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=ae+b+65535,b=Math.floor(u/65536),ae=u-b*65536,u=te+b+65535,b=Math.floor(u/65536),te=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=ue+b+65535,b=Math.floor(u/65536),ue=u-b*65536,u=B+b+65535,b=Math.floor(u/65536),B=u-b*65536,u=Y+b+65535,b=Math.floor(u/65536),Y=u-b*65536,H+=b-1+37*(b-1),b=1,u=H+b+65535,b=Math.floor(u/65536),H=u-b*65536,u=J+b+65535,b=Math.floor(u/65536),J=u-b*65536,u=ne+b+65535,b=Math.floor(u/65536),ne=u-b*65536,u=he+b+65535,b=Math.floor(u/65536),he=u-b*65536,u=le+b+65535,b=Math.floor(u/65536),le=u-b*65536,u=re+b+65535,b=Math.floor(u/65536),re=u-b*65536,u=U+b+65535,b=Math.floor(u/65536),U=u-b*65536,u=P+b+65535,b=Math.floor(u/65536),P=u-b*65536,u=$+b+65535,b=Math.floor(u/65536),$=u-b*65536,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=ae+b+65535,b=Math.floor(u/65536),ae=u-b*65536,u=te+b+65535,b=Math.floor(u/65536),te=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=ue+b+65535,b=Math.floor(u/65536),ue=u-b*65536,u=B+b+65535,b=Math.floor(u/65536),B=u-b*65536,u=Y+b+65535,b=Math.floor(u/65536),Y=u-b*65536,H+=b-1+37*(b-1),g[0]=H,g[1]=J,g[2]=ne,g[3]=he,g[4]=le,g[5]=re,g[6]=U,g[7]=P,g[8]=$,g[9]=K,g[10]=ae,g[11]=te,g[12]=ce,g[13]=ue,g[14]=B,g[15]=Y}function A(g,y){x(g,y,y)}function j(g,y){const E=n();for(let u=0;u<16;u++)E[u]=y[u];for(let u=253;u>=0;u--)A(E,E),u!==2&&u!==4&&x(E,E,y);for(let u=0;u<16;u++)g[u]=E[u]}function z(g,y){const E=new Uint8Array(32),u=new Float64Array(80),b=n(),H=n(),J=n(),ne=n(),he=n(),le=n();for(let $=0;$<31;$++)E[$]=g[$];E[31]=g[31]&127|64,E[0]&=248,S(u,y);for(let $=0;$<16;$++)H[$]=u[$];b[0]=ne[0]=1;for(let $=254;$>=0;--$){const K=E[$>>>3]>>>($&7)&1;d(b,H,K),d(J,ne,K),I(he,b,J),R(b,b,J),I(J,H,ne),R(H,H,ne),A(ne,he),A(le,b),x(b,J,b),x(J,H,he),I(he,b,J),R(b,b,J),A(H,b),R(J,ne,le),x(b,J,h),I(b,b,ne),x(J,J,b),x(b,ne,le),x(ne,H,u),A(H,he),d(b,H,K),d(J,ne,K)}for(let $=0;$<16;$++)u[$+16]=b[$],u[$+32]=J[$],u[$+48]=H[$],u[$+64]=ne[$];const re=u.subarray(32),U=u.subarray(16);j(re,re),x(U,U,re);const P=new Uint8Array(32);return v(P,U),P}o.scalarMult=z;function F(g){return z(g,a)}o.scalarMultBase=F;function V(g){if(g.length!==o.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${o.SECRET_KEY_LENGTH} bytes`);const y=new Uint8Array(g);return{publicKey:F(y),secretKey:y}}o.generateKeyPairFromSeed=V;function l(g){const y=(0,t.randomBytes)(32,g),E=V(y);return(0,i.wipe)(y),E}o.generateKeyPair=l;function w(g,y,E=!1){if(g.length!==o.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(y.length!==o.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const u=z(g,y);if(E){let b=0;for(let H=0;H<u.length;H++)b|=u[H];if(b===0)throw new Error("X25519: invalid shared key")}return u}o.sharedKey=w}(Uo)),Uo}var Yl=Bw();function wa(o){return globalThis.Buffer!=null?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):o}function Zl(o=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?wa(globalThis.Buffer.allocUnsafe(o)):new Uint8Array(o)}function Ah(o,t){t||(t=o.reduce((a,h)=>a+h.length,0));const i=Zl(t);let n=0;for(const a of o)i.set(a,n),n+=a.length;return wa(i)}function Xl(o,t,i,n){return{name:o,prefix:t,encoder:{name:o,prefix:t,encode:i},decoder:{decode:n}}}const Ch=Xl("utf8","u",o=>"u"+new TextDecoder("utf8").decode(o),o=>new TextEncoder().encode(o.substring(1))),Do=Xl("ascii","a",o=>{let t="a";for(let i=0;i<o.length;i++)t+=String.fromCharCode(o[i]);return t},o=>{o=o.substring(1);const t=Zl(o.length);for(let i=0;i<o.length;i++)t[i]=o.charCodeAt(i);return t}),ef={utf8:Ch,"utf-8":Ch,hex:uh.base16,latin1:Do,ascii:Do,binary:Do,...uh};function ir(o,t="utf8"){const i=ef[t];if(!i)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?wa(globalThis.Buffer.from(o,"utf-8")):i.decoder.decode(`${i.prefix}${o}`)}function Qt(o,t="utf8"){const i=ef[t];if(!i)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(o.buffer,o.byteOffset,o.byteLength).toString("utf8"):i.encoder.encode(o).substring(1)}var Ue={},Rh;function tf(){if(Rh)return Ue;Rh=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.getLocalStorage=Ue.getLocalStorageOrThrow=Ue.getCrypto=Ue.getCryptoOrThrow=Ue.getLocation=Ue.getLocationOrThrow=Ue.getNavigator=Ue.getNavigatorOrThrow=Ue.getDocument=Ue.getDocumentOrThrow=Ue.getFromWindowOrThrow=Ue.getFromWindow=void 0;function o(x){let A;return typeof window<"u"&&typeof window[x]<"u"&&(A=window[x]),A}Ue.getFromWindow=o;function t(x){const A=o(x);if(!A)throw new Error(`${x} is not defined in Window`);return A}Ue.getFromWindowOrThrow=t;function i(){return t("document")}Ue.getDocumentOrThrow=i;function n(){return o("document")}Ue.getDocument=n;function a(){return t("navigator")}Ue.getNavigatorOrThrow=a;function h(){return o("navigator")}Ue.getNavigator=h;function p(){return t("location")}Ue.getLocationOrThrow=p;function d(){return o("location")}Ue.getLocation=d;function v(){return t("crypto")}Ue.getCryptoOrThrow=v;function S(){return o("crypto")}Ue.getCrypto=S;function I(){return t("localStorage")}Ue.getLocalStorageOrThrow=I;function R(){return o("localStorage")}return Ue.getLocalStorage=R,Ue}tf();var Li={},Th;function Kw(){if(Th)return Li;Th=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.getWindowMetadata=void 0;const o=tf();function t(){let i,n;try{i=o.getDocumentOrThrow(),n=o.getLocationOrThrow()}catch{return null}function a(){const A=i.getElementsByTagName("link"),j=[];for(let z=0;z<A.length;z++){const F=A[z],V=F.getAttribute("rel");if(V&&V.toLowerCase().indexOf("icon")>-1){const l=F.getAttribute("href");if(l)if(l.toLowerCase().indexOf("https:")===-1&&l.toLowerCase().indexOf("http:")===-1&&l.indexOf("//")!==0){let w=n.protocol+"//"+n.host;if(l.indexOf("/")===0)w+=l;else{const g=n.pathname.split("/");g.pop();const y=g.join("/");w+=y+"/"+l}j.push(w)}else if(l.indexOf("//")===0){const w=n.protocol+l;j.push(w)}else j.push(l)}}return j}function h(...A){const j=i.getElementsByTagName("meta");for(let z=0;z<j.length;z++){const F=j[z],V=["itemprop","property","name"].map(l=>F.getAttribute(l)).filter(l=>l?A.includes(l):!1);if(V.length&&V){const l=F.getAttribute("content");if(l)return l}}return""}function p(){let A=h("name","og:site_name","og:title","twitter:title");return A||(A=i.title),A}function d(){return h("description","og:description","twitter:description","keywords")}const v=p(),S=d(),I=n.origin,R=a();return{description:S,url:I,icons:R,name:v}}return Li.getWindowMetadata=t,Li}Kw();var jo={},Lo,xh;function _a(){return xh||(xh=1,Lo=o=>encodeURIComponent(o).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`)),Lo}var qo,$h;function ba(){if($h)return qo;$h=1;var o="%[a-f0-9]{2}",t=new RegExp("("+o+")|([^%]+?)","gi"),i=new RegExp("("+o+")+","gi");function n(p,d){try{return[decodeURIComponent(p.join(""))]}catch{}if(p.length===1)return p;d=d||1;var v=p.slice(0,d),S=p.slice(d);return Array.prototype.concat.call([],n(v),n(S))}function a(p){try{return decodeURIComponent(p)}catch{for(var d=p.match(t)||[],v=1;v<d.length;v++)p=n(d,v).join(""),d=p.match(t)||[];return p}}function h(p){for(var d={"%FE%FF":"��","%FF%FE":"��"},v=i.exec(p);v;){try{d[v[0]]=decodeURIComponent(v[0])}catch{var S=a(v[0]);S!==v[0]&&(d[v[0]]=S)}v=i.exec(p)}d["%C2"]="�";for(var I=Object.keys(d),R=0;R<I.length;R++){var x=I[R];p=p.replace(new RegExp(x,"g"),d[x])}return p}return qo=function(p){if(typeof p!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof p+"`");try{return p=p.replace(/\+/g," "),decodeURIComponent(p)}catch{return h(p)}},qo}var Mo,Uh;function Ea(){return Uh||(Uh=1,Mo=(o,t)=>{if(!(typeof o=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[o];const i=o.indexOf(t);return i===-1?[o]:[o.slice(0,i),o.slice(i+t.length)]}),Mo}var Fo,Dh;function Sa(){return Dh||(Dh=1,Fo=function(o,t){for(var i={},n=Object.keys(o),a=Array.isArray(t),h=0;h<n.length;h++){var p=n[h],d=o[p];(a?t.indexOf(p)!==-1:t(p,d,o))&&(i[p]=d)}return i}),Fo}var jh;function Ww(){return jh||(jh=1,function(o){const t=_a(),i=ba(),n=Ea(),a=Sa(),h=l=>l==null,p=Symbol("encodeFragmentIdentifier");function d(l){switch(l.arrayFormat){case"index":return w=>(g,y)=>{const E=g.length;return y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?g:y===null?[...g,[I(w,l),"[",E,"]"].join("")]:[...g,[I(w,l),"[",I(E,l),"]=",I(y,l)].join("")]};case"bracket":return w=>(g,y)=>y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?g:y===null?[...g,[I(w,l),"[]"].join("")]:[...g,[I(w,l),"[]=",I(y,l)].join("")];case"colon-list-separator":return w=>(g,y)=>y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?g:y===null?[...g,[I(w,l),":list="].join("")]:[...g,[I(w,l),":list=",I(y,l)].join("")];case"comma":case"separator":case"bracket-separator":{const w=l.arrayFormat==="bracket-separator"?"[]=":"=";return g=>(y,E)=>E===void 0||l.skipNull&&E===null||l.skipEmptyString&&E===""?y:(E=E===null?"":E,y.length===0?[[I(g,l),w,I(E,l)].join("")]:[[y,I(E,l)].join(l.arrayFormatSeparator)])}default:return w=>(g,y)=>y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?g:y===null?[...g,I(w,l)]:[...g,[I(w,l),"=",I(y,l)].join("")]}}function v(l){let w;switch(l.arrayFormat){case"index":return(g,y,E)=>{if(w=/\[(\d*)\]$/.exec(g),g=g.replace(/\[\d*\]$/,""),!w){E[g]=y;return}E[g]===void 0&&(E[g]={}),E[g][w[1]]=y};case"bracket":return(g,y,E)=>{if(w=/(\[\])$/.exec(g),g=g.replace(/\[\]$/,""),!w){E[g]=y;return}if(E[g]===void 0){E[g]=[y];return}E[g]=[].concat(E[g],y)};case"colon-list-separator":return(g,y,E)=>{if(w=/(:list)$/.exec(g),g=g.replace(/:list$/,""),!w){E[g]=y;return}if(E[g]===void 0){E[g]=[y];return}E[g]=[].concat(E[g],y)};case"comma":case"separator":return(g,y,E)=>{const u=typeof y=="string"&&y.includes(l.arrayFormatSeparator),b=typeof y=="string"&&!u&&R(y,l).includes(l.arrayFormatSeparator);y=b?R(y,l):y;const H=u||b?y.split(l.arrayFormatSeparator).map(J=>R(J,l)):y===null?y:R(y,l);E[g]=H};case"bracket-separator":return(g,y,E)=>{const u=/(\[\])$/.test(g);if(g=g.replace(/\[\]$/,""),!u){E[g]=y&&R(y,l);return}const b=y===null?[]:y.split(l.arrayFormatSeparator).map(H=>R(H,l));if(E[g]===void 0){E[g]=b;return}E[g]=[].concat(E[g],b)};default:return(g,y,E)=>{if(E[g]===void 0){E[g]=y;return}E[g]=[].concat(E[g],y)}}}function S(l){if(typeof l!="string"||l.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function I(l,w){return w.encode?w.strict?t(l):encodeURIComponent(l):l}function R(l,w){return w.decode?i(l):l}function x(l){return Array.isArray(l)?l.sort():typeof l=="object"?x(Object.keys(l)).sort((w,g)=>Number(w)-Number(g)).map(w=>l[w]):l}function A(l){const w=l.indexOf("#");return w!==-1&&(l=l.slice(0,w)),l}function j(l){let w="";const g=l.indexOf("#");return g!==-1&&(w=l.slice(g)),w}function z(l){l=A(l);const w=l.indexOf("?");return w===-1?"":l.slice(w+1)}function F(l,w){return w.parseNumbers&&!Number.isNaN(Number(l))&&typeof l=="string"&&l.trim()!==""?l=Number(l):w.parseBooleans&&l!==null&&(l.toLowerCase()==="true"||l.toLowerCase()==="false")&&(l=l.toLowerCase()==="true"),l}function V(l,w){w=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},w),S(w.arrayFormatSeparator);const g=v(w),y=Object.create(null);if(typeof l!="string"||(l=l.trim().replace(/^[?#&]/,""),!l))return y;for(const E of l.split("&")){if(E==="")continue;let[u,b]=n(w.decode?E.replace(/\+/g," "):E,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(w.arrayFormat)?b:R(b,w),g(R(u,w),b,y)}for(const E of Object.keys(y)){const u=y[E];if(typeof u=="object"&&u!==null)for(const b of Object.keys(u))u[b]=F(u[b],w);else y[E]=F(u,w)}return w.sort===!1?y:(w.sort===!0?Object.keys(y).sort():Object.keys(y).sort(w.sort)).reduce((E,u)=>{const b=y[u];return b&&typeof b=="object"&&!Array.isArray(b)?E[u]=x(b):E[u]=b,E},Object.create(null))}o.extract=z,o.parse=V,o.stringify=(l,w)=>{if(!l)return"";w=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},w),S(w.arrayFormatSeparator);const g=b=>w.skipNull&&h(l[b])||w.skipEmptyString&&l[b]==="",y=d(w),E={};for(const b of Object.keys(l))g(b)||(E[b]=l[b]);const u=Object.keys(E);return w.sort!==!1&&u.sort(w.sort),u.map(b=>{const H=l[b];return H===void 0?"":H===null?I(b,w):Array.isArray(H)?H.length===0&&w.arrayFormat==="bracket-separator"?I(b,w)+"[]":H.reduce(y(b),[]).join("&"):I(b,w)+"="+I(H,w)}).filter(b=>b.length>0).join("&")},o.parseUrl=(l,w)=>{w=Object.assign({decode:!0},w);const[g,y]=n(l,"#");return Object.assign({url:g.split("?")[0]||"",query:V(z(l),w)},w&&w.parseFragmentIdentifier&&y?{fragmentIdentifier:R(y,w)}:{})},o.stringifyUrl=(l,w)=>{w=Object.assign({encode:!0,strict:!0,[p]:!0},w);const g=A(l.url).split("?")[0]||"",y=o.extract(l.url),E=o.parse(y,{sort:!1}),u=Object.assign(E,l.query);let b=o.stringify(u,w);b&&(b=`?${b}`);let H=j(l.url);return l.fragmentIdentifier&&(H=`#${w[p]?I(l.fragmentIdentifier,w):l.fragmentIdentifier}`),`${g}${b}${H}`},o.pick=(l,w,g)=>{g=Object.assign({parseFragmentIdentifier:!0,[p]:!1},g);const{url:y,query:E,fragmentIdentifier:u}=o.parseUrl(l,g);return o.stringifyUrl({url:y,query:a(E,w),fragmentIdentifier:u},g)},o.exclude=(l,w,g)=>{const y=Array.isArray(w)?E=>!w.includes(E):(E,u)=>!w(E,u);return o.pick(l,y,g)}}(jo)),jo}Ww();function Gw(o,t=[]){const i=[];return Object.keys(o).forEach(n=>{if(t.length&&!t.includes(n))return;const a=o[n];i.push(...a.accounts)}),i}const Qw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function Jw(o,t){const{message:i,code:n}=Qw[o];return{message:i,code:n}}function ra(o,t){return!!Array.isArray(o)}var zo={},qi={},ko={},Mi={};const Yw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Qr},Symbol.toStringTag,{value:"Module"})),Zw=bw(Yw);var Lh;function Xw(){if(Lh)return Mi;Lh=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.IHeartBeat=void 0;const o=Zw;class t extends o.IEvents{constructor(n){super()}}return Mi.IHeartBeat=t,Mi}var qh;function rf(){return qh||(qh=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),as.__exportStar(Xw(),o)}(ko)),ko}var Ho={},Kr={},Mh;function e_(){if(Mh)return Kr;Mh=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.HEARTBEAT_EVENTS=Kr.HEARTBEAT_INTERVAL=void 0;const o=Vl();return Kr.HEARTBEAT_INTERVAL=o.FIVE_SECONDS,Kr.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Kr}var Fh;function nf(){return Fh||(Fh=1,function(o){Object.defineProperty(o,"__esModule",{value:!0}),as.__exportStar(e_(),o)}(Ho)),Ho}var zh;function t_(){if(zh)return qi;zh=1,Object.defineProperty(qi,"__esModule",{value:!0}),qi.HeartBeat=void 0;const o=as,t=xw(),i=Vl(),n=rf(),a=nf();class h extends n.IHeartBeat{constructor(d){super(d),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(d==null?void 0:d.interval)||a.HEARTBEAT_INTERVAL}static init(d){return o.__awaiter(this,void 0,void 0,function*(){const v=new h(d);return yield v.init(),v})}init(){return o.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(d,v){this.events.on(d,v)}once(d,v){this.events.once(d,v)}off(d,v){this.events.off(d,v)}removeListener(d,v){this.events.removeListener(d,v)}initialize(){return o.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),i.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return qi.HeartBeat=h,qi}var kh;function r_(){return kh||(kh=1,function(o){Object.defineProperty(o,"__esModule",{value:!0});const t=as;t.__exportStar(t_(),o),t.__exportStar(rf(),o),t.__exportStar(nf(),o)}(zo)),zo}var Zi=r_();class i_ extends Qr{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class n_ extends Qr{constructor(t,i){super(),this.core=t,this.logger=i,this.records=new Map}}class s_{constructor(t,i){this.logger=t,this.core=i}}let o_=class extends Qr{constructor(t,i){super(),this.relayer=t,this.logger=i}},a_=class extends Qr{constructor(t){super()}},c_=class{constructor(t,i,n,a){this.core=t,this.logger=i,this.name=n}};class u_ extends Qr{constructor(t,i){super(),this.relayer=t,this.logger=i}}let h_=class extends Qr{constructor(t,i){super(),this.core=t,this.logger=i}},l_=class{constructor(t,i){this.projectId=t,this.logger=i}},f_=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},d_=class{constructor(t){this.client=t}};var Hh=function(o,t,i){if(i||arguments.length===2)for(var n=0,a=t.length,h;n<a;n++)(h||!(n in t))&&(h||(h=Array.prototype.slice.call(t,0,n)),h[n]=t[n]);return o.concat(h||Array.prototype.slice.call(t))},p_=function(){function o(t,i,n){this.name=t,this.version=i,this.os=n,this.type="browser"}return o}(),g_=function(){function o(t){this.version=t,this.type="node",this.name="node",this.os=Gr.platform}return o}(),y_=function(){function o(t,i,n,a){this.name=t,this.version=i,this.os=n,this.bot=a,this.type="bot-device"}return o}(),m_=function(){function o(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return o}(),v_=function(){function o(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return o}(),w_=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,__=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Vh=3,b_=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",w_]],Bh=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function E_(o){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new v_:typeof navigator<"u"?I_(navigator.userAgent):P_()}function S_(o){return o!==""&&b_.reduce(function(t,i){var n=i[0],a=i[1];if(t)return t;var h=a.exec(o);return!!h&&[n,h]},!1)}function I_(o){var t=S_(o);if(!t)return null;var i=t[0],n=t[1];if(i==="searchbot")return new m_;var a=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);a?a.length<Vh&&(a=Hh(Hh([],a,!0),N_(Vh-a.length),!0)):a=[];var h=a.join("."),p=O_(o),d=__.exec(o);return d&&d[1]?new y_(i,h,p,d[1]):new p_(i,h,p)}function O_(o){for(var t=0,i=Bh.length;t<i;t++){var n=Bh[t],a=n[0],h=n[1],p=h.exec(o);if(p)return a}return null}function P_(){var o=typeof Gr<"u"&&Gr.version;return o?new g_(Gr.version.slice(1)):null}function N_(o){for(var t=[],i=0;i<o;i++)t.push("0");return t}var De={},Kh;function sf(){if(Kh)return De;Kh=1,Object.defineProperty(De,"__esModule",{value:!0}),De.getLocalStorage=De.getLocalStorageOrThrow=De.getCrypto=De.getCryptoOrThrow=De.getLocation=De.getLocationOrThrow=De.getNavigator=De.getNavigatorOrThrow=De.getDocument=De.getDocumentOrThrow=De.getFromWindowOrThrow=De.getFromWindow=void 0;function o(x){let A;return typeof window<"u"&&typeof window[x]<"u"&&(A=window[x]),A}De.getFromWindow=o;function t(x){const A=o(x);if(!A)throw new Error(`${x} is not defined in Window`);return A}De.getFromWindowOrThrow=t;function i(){return t("document")}De.getDocumentOrThrow=i;function n(){return o("document")}De.getDocument=n;function a(){return t("navigator")}De.getNavigatorOrThrow=a;function h(){return o("navigator")}De.getNavigator=h;function p(){return t("location")}De.getLocationOrThrow=p;function d(){return o("location")}De.getLocation=d;function v(){return t("crypto")}De.getCryptoOrThrow=v;function S(){return o("crypto")}De.getCrypto=S;function I(){return t("localStorage")}De.getLocalStorageOrThrow=I;function R(){return o("localStorage")}return De.getLocalStorage=R,De}var ts=sf(),Fi={},Wh;function A_(){if(Wh)return Fi;Wh=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.getWindowMetadata=void 0;const o=sf();function t(){let i,n;try{i=o.getDocumentOrThrow(),n=o.getLocationOrThrow()}catch{return null}function a(){const A=i.getElementsByTagName("link"),j=[];for(let z=0;z<A.length;z++){const F=A[z],V=F.getAttribute("rel");if(V&&V.toLowerCase().indexOf("icon")>-1){const l=F.getAttribute("href");if(l)if(l.toLowerCase().indexOf("https:")===-1&&l.toLowerCase().indexOf("http:")===-1&&l.indexOf("//")!==0){let w=n.protocol+"//"+n.host;if(l.indexOf("/")===0)w+=l;else{const g=n.pathname.split("/");g.pop();const y=g.join("/");w+=y+"/"+l}j.push(w)}else if(l.indexOf("//")===0){const w=n.protocol+l;j.push(w)}else j.push(l)}}return j}function h(...A){const j=i.getElementsByTagName("meta");for(let z=0;z<j.length;z++){const F=j[z],V=["itemprop","property","name"].map(l=>F.getAttribute(l)).filter(l=>l?A.includes(l):!1);if(V.length&&V){const l=F.getAttribute("content");if(l)return l}}return""}function p(){let A=h("name","og:site_name","og:title","twitter:title");return A||(A=i.title),A}function d(){return h("description","og:description","twitter:description","keywords")}const v=p(),S=d(),I=n.origin,R=a();return{description:S,url:I,icons:R,name:v}}return Fi.getWindowMetadata=t,Fi}var C_=A_(),Vo={},Gh;function R_(){return Gh||(Gh=1,function(o){const t=_a(),i=ba(),n=Ea(),a=Sa(),h=l=>l==null,p=Symbol("encodeFragmentIdentifier");function d(l){switch(l.arrayFormat){case"index":return w=>(g,y)=>{const E=g.length;return y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?g:y===null?[...g,[I(w,l),"[",E,"]"].join("")]:[...g,[I(w,l),"[",I(E,l),"]=",I(y,l)].join("")]};case"bracket":return w=>(g,y)=>y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?g:y===null?[...g,[I(w,l),"[]"].join("")]:[...g,[I(w,l),"[]=",I(y,l)].join("")];case"colon-list-separator":return w=>(g,y)=>y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?g:y===null?[...g,[I(w,l),":list="].join("")]:[...g,[I(w,l),":list=",I(y,l)].join("")];case"comma":case"separator":case"bracket-separator":{const w=l.arrayFormat==="bracket-separator"?"[]=":"=";return g=>(y,E)=>E===void 0||l.skipNull&&E===null||l.skipEmptyString&&E===""?y:(E=E===null?"":E,y.length===0?[[I(g,l),w,I(E,l)].join("")]:[[y,I(E,l)].join(l.arrayFormatSeparator)])}default:return w=>(g,y)=>y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?g:y===null?[...g,I(w,l)]:[...g,[I(w,l),"=",I(y,l)].join("")]}}function v(l){let w;switch(l.arrayFormat){case"index":return(g,y,E)=>{if(w=/\[(\d*)\]$/.exec(g),g=g.replace(/\[\d*\]$/,""),!w){E[g]=y;return}E[g]===void 0&&(E[g]={}),E[g][w[1]]=y};case"bracket":return(g,y,E)=>{if(w=/(\[\])$/.exec(g),g=g.replace(/\[\]$/,""),!w){E[g]=y;return}if(E[g]===void 0){E[g]=[y];return}E[g]=[].concat(E[g],y)};case"colon-list-separator":return(g,y,E)=>{if(w=/(:list)$/.exec(g),g=g.replace(/:list$/,""),!w){E[g]=y;return}if(E[g]===void 0){E[g]=[y];return}E[g]=[].concat(E[g],y)};case"comma":case"separator":return(g,y,E)=>{const u=typeof y=="string"&&y.includes(l.arrayFormatSeparator),b=typeof y=="string"&&!u&&R(y,l).includes(l.arrayFormatSeparator);y=b?R(y,l):y;const H=u||b?y.split(l.arrayFormatSeparator).map(J=>R(J,l)):y===null?y:R(y,l);E[g]=H};case"bracket-separator":return(g,y,E)=>{const u=/(\[\])$/.test(g);if(g=g.replace(/\[\]$/,""),!u){E[g]=y&&R(y,l);return}const b=y===null?[]:y.split(l.arrayFormatSeparator).map(H=>R(H,l));if(E[g]===void 0){E[g]=b;return}E[g]=[].concat(E[g],b)};default:return(g,y,E)=>{if(E[g]===void 0){E[g]=y;return}E[g]=[].concat(E[g],y)}}}function S(l){if(typeof l!="string"||l.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function I(l,w){return w.encode?w.strict?t(l):encodeURIComponent(l):l}function R(l,w){return w.decode?i(l):l}function x(l){return Array.isArray(l)?l.sort():typeof l=="object"?x(Object.keys(l)).sort((w,g)=>Number(w)-Number(g)).map(w=>l[w]):l}function A(l){const w=l.indexOf("#");return w!==-1&&(l=l.slice(0,w)),l}function j(l){let w="";const g=l.indexOf("#");return g!==-1&&(w=l.slice(g)),w}function z(l){l=A(l);const w=l.indexOf("?");return w===-1?"":l.slice(w+1)}function F(l,w){return w.parseNumbers&&!Number.isNaN(Number(l))&&typeof l=="string"&&l.trim()!==""?l=Number(l):w.parseBooleans&&l!==null&&(l.toLowerCase()==="true"||l.toLowerCase()==="false")&&(l=l.toLowerCase()==="true"),l}function V(l,w){w=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},w),S(w.arrayFormatSeparator);const g=v(w),y=Object.create(null);if(typeof l!="string"||(l=l.trim().replace(/^[?#&]/,""),!l))return y;for(const E of l.split("&")){if(E==="")continue;let[u,b]=n(w.decode?E.replace(/\+/g," "):E,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(w.arrayFormat)?b:R(b,w),g(R(u,w),b,y)}for(const E of Object.keys(y)){const u=y[E];if(typeof u=="object"&&u!==null)for(const b of Object.keys(u))u[b]=F(u[b],w);else y[E]=F(u,w)}return w.sort===!1?y:(w.sort===!0?Object.keys(y).sort():Object.keys(y).sort(w.sort)).reduce((E,u)=>{const b=y[u];return b&&typeof b=="object"&&!Array.isArray(b)?E[u]=x(b):E[u]=b,E},Object.create(null))}o.extract=z,o.parse=V,o.stringify=(l,w)=>{if(!l)return"";w=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},w),S(w.arrayFormatSeparator);const g=b=>w.skipNull&&h(l[b])||w.skipEmptyString&&l[b]==="",y=d(w),E={};for(const b of Object.keys(l))g(b)||(E[b]=l[b]);const u=Object.keys(E);return w.sort!==!1&&u.sort(w.sort),u.map(b=>{const H=l[b];return H===void 0?"":H===null?I(b,w):Array.isArray(H)?H.length===0&&w.arrayFormat==="bracket-separator"?I(b,w)+"[]":H.reduce(y(b),[]).join("&"):I(b,w)+"="+I(H,w)}).filter(b=>b.length>0).join("&")},o.parseUrl=(l,w)=>{w=Object.assign({decode:!0},w);const[g,y]=n(l,"#");return Object.assign({url:g.split("?")[0]||"",query:V(z(l),w)},w&&w.parseFragmentIdentifier&&y?{fragmentIdentifier:R(y,w)}:{})},o.stringifyUrl=(l,w)=>{w=Object.assign({encode:!0,strict:!0,[p]:!0},w);const g=A(l.url).split("?")[0]||"",y=o.extract(l.url),E=o.parse(y,{sort:!1}),u=Object.assign(E,l.query);let b=o.stringify(u,w);b&&(b=`?${b}`);let H=j(l.url);return l.fragmentIdentifier&&(H=`#${w[p]?I(l.fragmentIdentifier,w):l.fragmentIdentifier}`),`${g}${b}${H}`},o.pick=(l,w,g)=>{g=Object.assign({parseFragmentIdentifier:!0,[p]:!1},g);const{url:y,query:E,fragmentIdentifier:u}=o.parseUrl(l,g);return o.stringifyUrl({url:y,query:a(E,w),fragmentIdentifier:u},g)},o.exclude=(l,w,g)=>{const y=Array.isArray(w)?E=>!w.includes(E):(E,u)=>!w(E,u);return o.pick(l,y,g)}}(Vo)),Vo}var rs=R_();function of(o,t){return o.includes(":")?[o]:t.chains||[]}const af="base10",St="base16",ia="base64pad",Ia="utf8",cf=0,Yr=1,T_=0,Qh=1,na=12,Oa=32;function x_(){const o=Yl.generateKeyPair();return{privateKey:Qt(o.secretKey,St),publicKey:Qt(o.publicKey,St)}}function sa(){const o=Jl.randomBytes(Oa);return Qt(o,St)}function $_(o,t){const i=Yl.sharedKey(ir(o,St),ir(t,St)),n=new Fw.HKDF(va.SHA256,i).expand(Oa);return Qt(n,St)}function U_(o){const t=va.hash(ir(o,St));return Qt(t,St)}function yi(o){const t=va.hash(ir(o,Ia));return Qt(t,St)}function D_(o){return ir(`${o}`,af)}function Xi(o){return Number(Qt(o,af))}function j_(o){const t=D_(typeof o.type<"u"?o.type:cf);if(Xi(t)===Yr&&typeof o.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const i=typeof o.senderPublicKey<"u"?ir(o.senderPublicKey,St):void 0,n=typeof o.iv<"u"?ir(o.iv,St):Jl.randomBytes(na),a=new Gl.ChaCha20Poly1305(ir(o.symKey,St)).seal(n,ir(o.message,Ia));return q_({type:t,sealed:a,iv:n,senderPublicKey:i})}function L_(o){const t=new Gl.ChaCha20Poly1305(ir(o.symKey,St)),{sealed:i,iv:n}=is(o.encoded),a=t.open(n,i);if(a===null)throw new Error("Failed to decrypt");return Qt(a,Ia)}function q_(o){if(Xi(o.type)===Yr){if(typeof o.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Qt(Ah([o.type,o.senderPublicKey,o.iv,o.sealed]),ia)}return Qt(Ah([o.type,o.iv,o.sealed]),ia)}function is(o){const t=ir(o,ia),i=t.slice(T_,Qh),n=Qh;if(Xi(i)===Yr){const d=n+Oa,v=d+na,S=t.slice(n,d),I=t.slice(d,v),R=t.slice(v);return{type:i,sealed:R,iv:I,senderPublicKey:S}}const a=n+na,h=t.slice(n,a),p=t.slice(a);return{type:i,sealed:p,iv:h}}function M_(o,t){const i=is(o);return uf({type:Xi(i.type),senderPublicKey:typeof i.senderPublicKey<"u"?Qt(i.senderPublicKey,St):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function uf(o){const t=(o==null?void 0:o.type)||cf;if(t===Yr){if(typeof(o==null?void 0:o.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(o==null?void 0:o.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:o==null?void 0:o.senderPublicKey,receiverPublicKey:o==null?void 0:o.receiverPublicKey}}function Jh(o){return o.type===Yr&&typeof o.senderPublicKey=="string"&&typeof o.receiverPublicKey=="string"}var F_=Object.defineProperty,Yh=Object.getOwnPropertySymbols,z_=Object.prototype.hasOwnProperty,k_=Object.prototype.propertyIsEnumerable,Zh=(o,t,i)=>t in o?F_(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,Xh=(o,t)=>{for(var i in t||(t={}))z_.call(t,i)&&Zh(o,i,t[i]);if(Yh)for(var i of Yh(t))k_.call(t,i)&&Zh(o,i,t[i]);return o};const H_="ReactNative",xr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},V_="js";function Pa(){return typeof Gr<"u"&&typeof Gr.versions<"u"&&typeof Gr.versions.node<"u"}function hf(){return!ts.getDocument()&&!!ts.getNavigator()&&navigator.product===H_}function Na(){return!Pa()&&!!ts.getNavigator()}function Aa(){return hf()?xr.reactNative:Pa()?xr.node:Na()?xr.browser:xr.unknown}function B_(o,t){let i=rs.parse(o);return i=Xh(Xh({},i),t),o=rs.stringify(i),o}function K_(){return C_.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function W_(){if(Aa()===xr.reactNative&&typeof hr<"u"&&typeof(hr==null?void 0:hr.Platform)<"u"){const{OS:i,Version:n}=hr.Platform;return[i,n].join("-")}const o=E_();if(o===null)return"unknown";const t=o.os?o.os.replace(" ","").toLowerCase():"unknown";return o.type==="browser"?[t,o.name,o.version].join("-"):[t,o.version].join("-")}function G_(){var o;const t=Aa();return t===xr.browser?[t,((o=ts.getLocation())==null?void 0:o.host)||"unknown"].join(":"):t}function Q_(o,t,i){const n=W_(),a=G_();return[[o,t].join("-"),[V_,i].join("-"),n,a].join("/")}function J_({protocol:o,version:t,relayUrl:i,sdkVersion:n,auth:a,projectId:h,useOnCloseEvent:p}){const d=i.split("?"),v=Q_(o,t,n),S={auth:a,ua:v,projectId:h,useOnCloseEvent:p},I=B_(d[1]||"",S);return d[0]+"?"+I}function Wr(o,t){return o.filter(i=>t.includes(i)).length===o.length}function lf(o){return Object.fromEntries(o.entries())}function ff(o){return new Map(Object.entries(o))}function gi(o=ee.FIVE_MINUTES,t){const i=ee.toMiliseconds(o||ee.FIVE_MINUTES);let n,a,h;return{resolve:p=>{h&&n&&(clearTimeout(h),n(p))},reject:p=>{h&&a&&(clearTimeout(h),a(p))},done:()=>new Promise((p,d)=>{h=setTimeout(()=>{d(new Error(t))},i),n=p,a=d})}}function ns(o,t,i){return new Promise(async(n,a)=>{const h=setTimeout(()=>a(new Error(i)),t);try{const p=await o;n(p)}catch(p){a(p)}clearTimeout(h)})}function df(o,t){if(typeof t=="string"&&t.startsWith(`${o}:`))return t;if(o.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(o.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${o}`)}function Y_(o){return df("topic",o)}function Z_(o){return df("id",o)}function pf(o){const[t,i]=o.split(":"),n={id:void 0,topic:void 0};if(t==="topic"&&typeof i=="string")n.topic=i;else if(t==="id"&&Number.isInteger(Number(i)))n.id=Number(i);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${i}`);return n}function rr(o,t){return ee.fromMiliseconds(Date.now()+ee.toMiliseconds(o))}function Tr(o){return Date.now()>=ee.toMiliseconds(o)}function st(o,t){return`${o}${t?`:${t}`:""}`}async function X_({id:o,topic:t,wcDeepLink:i}){try{if(!i)return;const n=typeof i=="string"?JSON.parse(i):i;let a=n==null?void 0:n.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const h=`${a}/wc?requestId=${o}&sessionTopic=${t}`,p=Aa();p===xr.browser?h.startsWith("https://")?window.open(h,"_blank","noreferrer noopener"):window.open(h,"_self","noreferrer noopener"):p===xr.reactNative&&typeof(hr==null?void 0:hr.Linking)<"u"&&await globalThis.Linking.openURL(h)}catch(n){console.error(n)}}const e1="irn";function oa(o){return(o==null?void 0:o.relay)||{protocol:e1}}function Zn(o){const t=Iw[o];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${o}`);return t}var t1=Object.defineProperty,el=Object.getOwnPropertySymbols,r1=Object.prototype.hasOwnProperty,i1=Object.prototype.propertyIsEnumerable,tl=(o,t,i)=>t in o?t1(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,n1=(o,t)=>{for(var i in t||(t={}))r1.call(t,i)&&tl(o,i,t[i]);if(el)for(var i of el(t))i1.call(t,i)&&tl(o,i,t[i]);return o};function s1(o,t="-"){const i={},n="relay"+t;return Object.keys(o).forEach(a=>{if(a.startsWith(n)){const h=a.replace(n,""),p=o[a];i[h]=p}}),i}function o1(o){const t=o.indexOf(":"),i=o.indexOf("?")!==-1?o.indexOf("?"):void 0,n=o.substring(0,t),a=o.substring(t+1,i).split("@"),h=typeof i<"u"?o.substring(i):"",p=rs.parse(h);return{protocol:n,topic:a1(a[0]),version:parseInt(a[1],10),symKey:p.symKey,relay:s1(p)}}function a1(o){return o.startsWith("//")?o.substring(2):o}function c1(o,t="-"){const i="relay",n={};return Object.keys(o).forEach(a=>{const h=i+t+a;o[a]&&(n[h]=o[a])}),n}function u1(o){return`${o.protocol}:${o.topic}@${o.version}?`+rs.stringify(n1({symKey:o.symKey},c1(o.relay)))}function mi(o){const t=[];return o.forEach(i=>{const[n,a]=i.split(":");t.push(`${n}:${a}`)}),t}function h1(o){const t=[];return Object.values(o).forEach(i=>{t.push(...mi(i.accounts))}),t}function l1(o,t){const i=[];return Object.values(o).forEach(n=>{mi(n.accounts).includes(t)&&i.push(...n.methods)}),i}function f1(o,t){const i=[];return Object.values(o).forEach(n=>{mi(n.accounts).includes(t)&&i.push(...n.events)}),i}function d1(o,t){const i=Xn(o,t);if(i)throw new Error(i.message);const n={};for(const[a,h]of Object.entries(o))n[a]={methods:h.methods,events:h.events,chains:h.accounts.map(p=>`${p.split(":")[0]}:${p.split(":")[1]}`)};return n}const p1={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},g1={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function G(o,t){const{message:i,code:n}=g1[o];return{message:t?`${i} ${t}`:i,code:n}}function ft(o,t){const{message:i,code:n}=p1[o];return{message:t?`${i} ${t}`:i,code:n}}function en(o,t){return!!Array.isArray(o)}function Qi(o){return Object.getPrototypeOf(o)===Object.prototype&&Object.keys(o).length}function Et(o){return typeof o>"u"}function dt(o,t){return t&&Et(o)?!0:typeof o=="string"&&!!o.trim().length}function Ca(o,t){return t&&Et(o)?!0:typeof o=="number"&&!isNaN(o)}function y1(o,t){const{requiredNamespaces:i}=t,n=Object.keys(o.namespaces),a=Object.keys(i);let h=!0;return Wr(a,n)?(n.forEach(p=>{const{accounts:d,methods:v,events:S}=o.namespaces[p],I=mi(d),R=i[p];(!Wr(of(p,R),I)||!Wr(R.methods,v)||!Wr(R.events,S))&&(h=!1)}),h):!1}function ss(o){return dt(o,!1)&&o.includes(":")?o.split(":").length===2:!1}function m1(o){if(dt(o,!1)&&o.includes(":")){const t=o.split(":");if(t.length===3){const i=t[0]+":"+t[1];return!!t[2]&&ss(i)}}return!1}function v1(o){if(dt(o,!1))try{return typeof new URL(o)<"u"}catch{return!1}return!1}function w1(o){var t;return(t=o==null?void 0:o.proposer)==null?void 0:t.publicKey}function _1(o){return o==null?void 0:o.topic}function b1(o,t){let i=null;return dt(o==null?void 0:o.publicKey,!1)||(i=G("MISSING_OR_INVALID",`${t} controller public key should be a string`)),i}function rl(o){let t=!0;return en(o)?o.length&&(t=o.every(i=>dt(i,!1))):t=!1,t}function E1(o,t,i){let n=null;return en(t)&&t.length?t.forEach(a=>{n||ss(a)||(n=ft("UNSUPPORTED_CHAINS",`${i}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):ss(o)||(n=ft("UNSUPPORTED_CHAINS",`${i}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function S1(o,t,i){let n=null;return Object.entries(o).forEach(([a,h])=>{if(n)return;const p=E1(a,of(a,h),`${t} ${i}`);p&&(n=p)}),n}function I1(o,t){let i=null;return en(o)?o.forEach(n=>{i||m1(n)||(i=ft("UNSUPPORTED_ACCOUNTS",`${t}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):i=ft("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),i}function O1(o,t){let i=null;return Object.values(o).forEach(n=>{if(i)return;const a=I1(n==null?void 0:n.accounts,`${t} namespace`);a&&(i=a)}),i}function P1(o,t){let i=null;return rl(o==null?void 0:o.methods)?rl(o==null?void 0:o.events)||(i=ft("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):i=ft("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),i}function gf(o,t){let i=null;return Object.values(o).forEach(n=>{if(i)return;const a=P1(n,`${t}, namespace`);a&&(i=a)}),i}function N1(o,t,i){let n=null;if(o&&Qi(o)){const a=gf(o,t);a&&(n=a);const h=S1(o,t,i);h&&(n=h)}else n=G("MISSING_OR_INVALID",`${t}, ${i} should be an object with data`);return n}function Xn(o,t){let i=null;if(o&&Qi(o)){const n=gf(o,t);n&&(i=n);const a=O1(o,t);a&&(i=a)}else i=G("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return i}function yf(o){return dt(o.protocol,!0)}function A1(o,t){let i=!1;return o?o&&en(o)&&o.length&&o.forEach(n=>{i=yf(n)}):i=!0,i}function C1(o){return typeof o=="number"}function Ct(o){return typeof o<"u"&&typeof o!==null}function R1(o){return!(!o||typeof o!="object"||!o.code||!Ca(o.code,!1)||!o.message||!dt(o.message,!1))}function T1(o){return!(Et(o)||!dt(o.method,!1))}function x1(o){return!(Et(o)||Et(o.result)&&Et(o.error)||!Ca(o.id,!1)||!dt(o.jsonrpc,!1))}function $1(o){return!(Et(o)||!dt(o.name,!1))}function il(o,t){return!(!ss(t)||!h1(o).includes(t))}function U1(o,t,i){return dt(i,!1)?l1(o,t).includes(i):!1}function D1(o,t,i){return dt(i,!1)?f1(o,t).includes(i):!1}function nl(o,t,i){let n=null;const a=j1(o),h=L1(t),p=Object.keys(a),d=Object.keys(h),v=sl(Object.keys(o)),S=sl(Object.keys(t)),I=v.filter(R=>!S.includes(R));return I.length&&(n=G("NON_CONFORMING_NAMESPACES",`${i} namespaces keys don't satisfy requiredNamespaces.
      Required: ${I.toString()}
      Received: ${Object.keys(t).toString()}`)),Wr(p,d)||(n=G("NON_CONFORMING_NAMESPACES",`${i} namespaces chains don't satisfy required namespaces.
      Required: ${p.toString()}
      Approved: ${d.toString()}`)),Object.keys(t).forEach(R=>{if(!R.includes(":")||n)return;const x=mi(t[R].accounts);x.includes(R)||(n=G("NON_CONFORMING_NAMESPACES",`${i} namespaces accounts don't satisfy namespace accounts for ${R}
        Required: ${R}
        Approved: ${x.toString()}`))}),p.forEach(R=>{n||(Wr(a[R].methods,h[R].methods)?Wr(a[R].events,h[R].events)||(n=G("NON_CONFORMING_NAMESPACES",`${i} namespaces events don't satisfy namespace events for ${R}`)):n=G("NON_CONFORMING_NAMESPACES",`${i} namespaces methods don't satisfy namespace methods for ${R}`))}),n}function j1(o){const t={};return Object.keys(o).forEach(i=>{var n;i.includes(":")?t[i]=o[i]:(n=o[i].chains)==null||n.forEach(a=>{t[a]={methods:o[i].methods,events:o[i].events}})}),t}function sl(o){return[...new Set(o.map(t=>t.includes(":")?t.split(":")[0]:t))]}function L1(o){const t={};return Object.keys(o).forEach(i=>{if(i.includes(":"))t[i]=o[i];else{const n=mi(o[i].accounts);n==null||n.forEach(a=>{t[a]={accounts:o[i].accounts.filter(h=>h.includes(`${a}:`)),methods:o[i].methods,events:o[i].events}})}}),t}function q1(o,t){return Ca(o,!1)&&o<=t.max&&o>=t.min}let M1=class extends Bl{constructor(t){super(t),this.events=new nr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async request(t,i){return this.requestStrict(Ji(t.method,t.params||[],t.id||cs().toString()),i)}async requestStrict(t,i){return new Promise(async(n,a)=>{if(!this.connection.connected)try{await this.open()}catch(h){a(h)}this.events.on(`${t.id}`,h=>{tr(h)?a(h.error):n(h.result)});try{await this.connection.send(t,i)}catch(h){a(h)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Yi(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const F1=()=>typeof WebSocket<"u"?WebSocket:typeof hr<"u"&&typeof globalThis.WebSocket<"u"?globalThis.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),z1=()=>typeof WebSocket<"u"||typeof hr<"u"&&typeof globalThis.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",ol=o=>o.split("?")[0],al=10,k1=F1();class H1{constructor(t){if(this.url=t,this.events=new nr.EventEmitter,this.registering=!1,!hh(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,i)=>{if(typeof this.socket>"u"){i(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t,i){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Kl(t))}catch(n){this.onError(t.id,n)}}register(t=this.url){if(!hh(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((n,a)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),a(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((i,n)=>{const a=Ow.isReactNative()?void 0:{rejectUnauthorized:!Pw(t)},h=new k1(t,[],a);z1()?h.onerror=p=>{const d=p;n(this.emitError(d.error))}:h.on("error",p=>{n(this.emitError(p))}),h.onopen=()=>{this.onOpen(h),i(h)}})}onOpen(t){t.onmessage=i=>this.onPayload(i),t.onclose=i=>this.onClose(i),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const i=typeof t.data=="string"?Wl(t.data):t.data;this.events.emit("payload",i)}onError(t,i){const n=this.parseError(i),a=n.message||n.toString(),h=da(t,a);this.events.emit("payload",h)}parseError(t,i=this.url){return Nw(t,ol(i),"WS")}resetMaxListeners(){this.events.getMaxListeners()>al&&this.events.setMaxListeners(al)}emitError(t){const i=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${ol(this.url)}`));return this.events.emit("register_error",i),i}}var V1={};function B1(o,t){if(o.length>=255)throw new TypeError("Alphabet too long");for(var i=new Uint8Array(256),n=0;n<i.length;n++)i[n]=255;for(var a=0;a<o.length;a++){var h=o.charAt(a),p=h.charCodeAt(0);if(i[p]!==255)throw new TypeError(h+" is ambiguous");i[p]=a}var d=o.length,v=o.charAt(0),S=Math.log(d)/Math.log(256),I=Math.log(256)/Math.log(d);function R(j){if(j instanceof Uint8Array||(ArrayBuffer.isView(j)?j=new Uint8Array(j.buffer,j.byteOffset,j.byteLength):Array.isArray(j)&&(j=Uint8Array.from(j))),!(j instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(j.length===0)return"";for(var z=0,F=0,V=0,l=j.length;V!==l&&j[V]===0;)V++,z++;for(var w=(l-V)*I+1>>>0,g=new Uint8Array(w);V!==l;){for(var y=j[V],E=0,u=w-1;(y!==0||E<F)&&u!==-1;u--,E++)y+=256*g[u]>>>0,g[u]=y%d>>>0,y=y/d>>>0;if(y!==0)throw new Error("Non-zero carry");F=E,V++}for(var b=w-F;b!==w&&g[b]===0;)b++;for(var H=v.repeat(z);b<w;++b)H+=o.charAt(g[b]);return H}function x(j){if(typeof j!="string")throw new TypeError("Expected String");if(j.length===0)return new Uint8Array;var z=0;if(j[z]!==" "){for(var F=0,V=0;j[z]===v;)F++,z++;for(var l=(j.length-z)*S+1>>>0,w=new Uint8Array(l);j[z];){var g=i[j.charCodeAt(z)];if(g===255)return;for(var y=0,E=l-1;(g!==0||y<V)&&E!==-1;E--,y++)g+=d*w[E]>>>0,w[E]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");V=y,z++}if(j[z]!==" "){for(var u=l-V;u!==l&&w[u]===0;)u++;for(var b=new Uint8Array(F+(l-u)),H=F;u!==l;)b[H++]=w[u++];return b}}}function A(j){var z=x(j);if(z)return z;throw new Error(`Non-${t} character`)}return{encode:R,decodeUnsafe:x,decode:A}}var K1=B1,W1=K1;const mf=o=>{if(o instanceof Uint8Array&&o.constructor.name==="Uint8Array")return o;if(o instanceof ArrayBuffer)return new Uint8Array(o);if(ArrayBuffer.isView(o))return new Uint8Array(o.buffer,o.byteOffset,o.byteLength);throw new Error("Unknown type, must be binary type")},G1=o=>new TextEncoder().encode(o),Q1=o=>new TextDecoder().decode(o);class J1{constructor(t,i,n){this.name=t,this.prefix=i,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Y1{constructor(t,i,n){if(this.name=t,this.prefix=i,i.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=i.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return vf(this,t)}}class Z1{constructor(t){this.decoders=t}or(t){return vf(this,t)}decode(t){const i=t[0],n=this.decoders[i];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const vf=(o,t)=>new Z1({...o.decoders||{[o.prefix]:o},...t.decoders||{[t.prefix]:t}});class X1{constructor(t,i,n,a){this.name=t,this.prefix=i,this.baseEncode=n,this.baseDecode=a,this.encoder=new J1(t,i,n),this.decoder=new Y1(t,i,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const fs=({name:o,prefix:t,encode:i,decode:n})=>new X1(o,t,i,n),tn=({prefix:o,name:t,alphabet:i})=>{const{encode:n,decode:a}=W1(i,t);return fs({prefix:o,name:t,encode:n,decode:h=>mf(a(h))})},eb=(o,t,i,n)=>{const a={};for(let I=0;I<t.length;++I)a[t[I]]=I;let h=o.length;for(;o[h-1]==="=";)--h;const p=new Uint8Array(h*i/8|0);let d=0,v=0,S=0;for(let I=0;I<h;++I){const R=a[o[I]];if(R===void 0)throw new SyntaxError(`Non-${n} character`);v=v<<i|R,d+=i,d>=8&&(d-=8,p[S++]=255&v>>d)}if(d>=i||255&v<<8-d)throw new SyntaxError("Unexpected end of data");return p},tb=(o,t,i)=>{const n=t[t.length-1]==="=",a=(1<<i)-1;let h="",p=0,d=0;for(let v=0;v<o.length;++v)for(d=d<<8|o[v],p+=8;p>i;)p-=i,h+=t[a&d>>p];if(p&&(h+=t[a&d<<i-p]),n)for(;h.length*i&7;)h+="=";return h},yt=({name:o,prefix:t,bitsPerChar:i,alphabet:n})=>fs({prefix:t,name:o,encode(a){return tb(a,n,i)},decode(a){return eb(a,n,i,o)}}),rb=fs({prefix:"\0",name:"identity",encode:o=>Q1(o),decode:o=>G1(o)});var ib=Object.freeze({__proto__:null,identity:rb});const nb=yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var sb=Object.freeze({__proto__:null,base2:nb});const ob=yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ab=Object.freeze({__proto__:null,base8:ob});const cb=tn({prefix:"9",name:"base10",alphabet:"0123456789"});var ub=Object.freeze({__proto__:null,base10:cb});const hb=yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),lb=yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var fb=Object.freeze({__proto__:null,base16:hb,base16upper:lb});const db=yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),pb=yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),gb=yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),yb=yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),mb=yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),vb=yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),wb=yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),_b=yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),bb=yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Eb=Object.freeze({__proto__:null,base32:db,base32upper:pb,base32pad:gb,base32padupper:yb,base32hex:mb,base32hexupper:vb,base32hexpad:wb,base32hexpadupper:_b,base32z:bb});const Sb=tn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ib=tn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Ob=Object.freeze({__proto__:null,base36:Sb,base36upper:Ib});const Pb=tn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Nb=tn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ab=Object.freeze({__proto__:null,base58btc:Pb,base58flickr:Nb});const Cb=yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Rb=yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Tb=yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),xb=yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $b=Object.freeze({__proto__:null,base64:Cb,base64pad:Rb,base64url:Tb,base64urlpad:xb});const wf=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Ub=wf.reduce((o,t,i)=>(o[i]=t,o),[]),Db=wf.reduce((o,t,i)=>(o[t.codePointAt(0)]=i,o),[]);function jb(o){return o.reduce((t,i)=>(t+=Ub[i],t),"")}function Lb(o){const t=[];for(const i of o){const n=Db[i.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${i}`);t.push(n)}return new Uint8Array(t)}const qb=fs({prefix:"🚀",name:"base256emoji",encode:jb,decode:Lb});var Mb=Object.freeze({__proto__:null,base256emoji:qb}),Fb=_f,cl=128,zb=-128,kb=Math.pow(2,31);function _f(o,t,i){t=t||[],i=i||0;for(var n=i;o>=kb;)t[i++]=o&255|cl,o/=128;for(;o&zb;)t[i++]=o&255|cl,o>>>=7;return t[i]=o|0,_f.bytes=i-n+1,t}var Hb=aa,Vb=128,ul=127;function aa(o,n){var i=0,n=n||0,a=0,h=n,p,d=o.length;do{if(h>=d)throw aa.bytes=0,new RangeError("Could not decode varint");p=o[h++],i+=a<28?(p&ul)<<a:(p&ul)*Math.pow(2,a),a+=7}while(p>=Vb);return aa.bytes=h-n,i}var Bb=Math.pow(2,7),Kb=Math.pow(2,14),Wb=Math.pow(2,21),Gb=Math.pow(2,28),Qb=Math.pow(2,35),Jb=Math.pow(2,42),Yb=Math.pow(2,49),Zb=Math.pow(2,56),Xb=Math.pow(2,63),eE=function(o){return o<Bb?1:o<Kb?2:o<Wb?3:o<Gb?4:o<Qb?5:o<Jb?6:o<Yb?7:o<Zb?8:o<Xb?9:10},tE={encode:Fb,decode:Hb,encodingLength:eE},bf=tE;const hl=(o,t,i=0)=>(bf.encode(o,t,i),t),ll=o=>bf.encodingLength(o),ca=(o,t)=>{const i=t.byteLength,n=ll(o),a=n+ll(i),h=new Uint8Array(a+i);return hl(o,h,0),hl(i,h,n),h.set(t,a),new rE(o,i,t,h)};class rE{constructor(t,i,n,a){this.code=t,this.size=i,this.digest=n,this.bytes=a}}const Ef=({name:o,code:t,encode:i})=>new iE(o,t,i);class iE{constructor(t,i,n){this.name=t,this.code=i,this.encode=n}digest(t){if(t instanceof Uint8Array){const i=this.encode(t);return i instanceof Uint8Array?ca(this.code,i):i.then(n=>ca(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Sf=o=>async t=>new Uint8Array(await crypto.subtle.digest(o,t)),nE=Ef({name:"sha2-256",code:18,encode:Sf("SHA-256")}),sE=Ef({name:"sha2-512",code:19,encode:Sf("SHA-512")});var oE=Object.freeze({__proto__:null,sha256:nE,sha512:sE});const If=0,aE="identity",Of=mf,cE=o=>ca(If,Of(o)),uE={code:If,name:aE,encode:Of,digest:cE};var hE=Object.freeze({__proto__:null,identity:uE});new TextEncoder,new TextDecoder;const fl={...ib,...sb,...ab,...ub,...fb,...Eb,...Ob,...Ab,...$b,...Mb};({...oE,...hE});function Pf(o){return globalThis.Buffer!=null?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):o}function lE(o=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Pf(globalThis.Buffer.allocUnsafe(o)):new Uint8Array(o)}function Nf(o,t,i,n){return{name:o,prefix:t,encoder:{name:o,prefix:t,encode:i},decoder:{decode:n}}}const dl=Nf("utf8","u",o=>"u"+new TextDecoder("utf8").decode(o),o=>new TextEncoder().encode(o.substring(1))),Bo=Nf("ascii","a",o=>{let t="a";for(let i=0;i<o.length;i++)t+=String.fromCharCode(o[i]);return t},o=>{o=o.substring(1);const t=lE(o.length);for(let i=0;i<o.length;i++)t[i]=o.charCodeAt(i);return t}),fE={utf8:dl,"utf-8":dl,hex:fl.base16,latin1:Bo,ascii:Bo,binary:Bo,...fl};function dE(o,t="utf8"){const i=fE[t];if(!i)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Pf(globalThis.Buffer.from(o,"utf-8")):i.decoder.decode(`${i.prefix}${o}`)}const Af="wc",pE=2,Cf="core",$r=`${Af}@2:${Cf}:`,gE={logger:"error"},yE={database:":memory:"},mE="crypto",pl="client_ed25519_seed",vE=ee.ONE_DAY,wE="keychain",_E="0.3",bE="messages",EE="0.3",SE=ee.SIX_HOURS,IE="publisher",Rf="irn",OE="error",Tf="wss://relay.walletconnect.com",gl="wss://relay.walletconnect.org",PE="relayer",We={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},NE="_subscription",zi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},AE=ee.ONE_SECOND/2,CE="2.9.1",RE=1e4,TE="0.3",xE="WALLETCONNECT_CLIENT_ID",ur={created:"subscription_created",deleted:"subscription_deleted",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},$E="subscription",UE="0.3",DE=ee.FIVE_SECONDS*1e3,jE="pairing",LE="0.3",ki={wc_pairingDelete:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:0},res:{ttl:ee.ONE_DAY,prompt:!1,tag:0}}},cr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},qE="history",ME="0.3",FE="expirer",Gt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},zE="0.3",Ko="verify-api",yl="https://verify.walletconnect.com";class kE{constructor(t,i){this.core=t,this.logger=i,this.keychain=new Map,this.name=wE,this.version=_E,this.initialized=!1,this.storagePrefix=$r,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,a)=>{this.isInitialized(),this.keychain.set(n,a),await this.persist()},this.get=n=>{this.isInitialized();const a=this.keychain.get(n);if(typeof a>"u"){const{message:h}=G("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(h)}return a},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=jt(i,this.name)}get context(){return Lt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,lf(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?ff(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class HE{constructor(t,i,n){this.core=t,this.logger=i,this.name=mE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),h=lh(a);return Cw(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=x_();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const h=await this.getClientSeed(),p=lh(h),d=sa();return await Rw(d,a,vE,p)},this.generateSharedKey=(a,h,p)=>{this.isInitialized();const d=this.getPrivateKey(a),v=$_(d,h);return this.setSymKey(v,p)},this.setSymKey=async(a,h)=>{this.isInitialized();const p=h||U_(a);return await this.keychain.set(p,a),p},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,h,p)=>{this.isInitialized();const d=uf(p),v=Kl(h);if(Jh(d)){const x=d.senderPublicKey,A=d.receiverPublicKey;a=await this.generateSharedKey(x,A)}const S=this.getSymKey(a),{type:I,senderPublicKey:R}=d;return j_({type:I,symKey:S,message:v,senderPublicKey:R})},this.decode=async(a,h,p)=>{this.isInitialized();const d=M_(h,p);if(Jh(d)){const v=d.receiverPublicKey,S=d.senderPublicKey;a=await this.generateSharedKey(v,S)}try{const v=this.getSymKey(a),S=L_({symKey:v,encoded:h});return Wl(S)}catch(v){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(v)}},this.getPayloadType=a=>{const h=is(a);return Xi(h.type)},this.getPayloadSenderPublicKey=a=>{const h=is(a);return h.senderPublicKey?Qt(h.senderPublicKey,St):void 0},this.core=t,this.logger=jt(i,this.name),this.keychain=n||new kE(this.core,this.logger)}get context(){return Lt(this.logger)}async setPrivateKey(t,i){return await this.keychain.set(t,i),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(pl)}catch{t=sa(),await this.keychain.set(pl,t)}return dE(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class VE extends s_{constructor(t,i){super(t,i),this.logger=t,this.core=i,this.messages=new Map,this.name=bE,this.version=EE,this.initialized=!1,this.storagePrefix=$r,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,a)=>{this.isInitialized();const h=yi(a);let p=this.messages.get(n);return typeof p>"u"&&(p={}),typeof p[h]<"u"||(p[h]=a,this.messages.set(n,p),await this.persist()),h},this.get=n=>{this.isInitialized();let a=this.messages.get(n);return typeof a>"u"&&(a={}),a},this.has=(n,a)=>{this.isInitialized();const h=this.get(n),p=yi(a);return typeof h[p]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=jt(t,this.name),this.core=i}get context(){return Lt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,lf(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?ff(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class BE extends o_{constructor(t,i){super(t,i),this.relayer=t,this.logger=i,this.events=new nr.EventEmitter,this.name=IE,this.queue=new Map,this.publishTimeout=ee.toMiliseconds(ee.TEN_SECONDS),this.queueTimeout=ee.toMiliseconds(ee.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,a,h)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:h}});try{const p=(h==null?void 0:h.ttl)||SE,d=oa(h),v=(h==null?void 0:h.prompt)||!1,S=(h==null?void 0:h.tag)||0,I=(h==null?void 0:h.id)||cs().toString(),R={topic:n,message:a,opts:{ttl:p,relay:d,prompt:v,tag:S,id:I}},x=setTimeout(()=>this.queue.set(I,R),this.queueTimeout);try{await await ns(this.rpcPublish(n,a,p,d,v,S,I),this.publishTimeout),clearTimeout(x),this.relayer.events.emit(We.publish,R)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:h}})}catch(p){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(p),p}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.relayer=t,this.logger=jt(i,this.name),this.registerEventListeners()}get context(){return Lt(this.logger)}rpcPublish(t,i,n,a,h,p,d){var v,S,I,R;const x={method:Zn(a.protocol).publish,params:{topic:t,message:i,ttl:n,prompt:h,tag:p},id:d};return Et((v=x.params)==null?void 0:v.prompt)&&((S=x.params)==null||delete S.prompt),Et((I=x.params)==null?void 0:I.tag)&&((R=x.params)==null||delete R.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:x}),this.relayer.request(x)}onPublish(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:i,message:n,opts:a}=t;await this.publish(i,n,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Zi.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(We.connection_stalled);return}this.checkQueue()}),this.relayer.on(We.message_ack,t=>{this.onPublish(t.id.toString())})}}class KE{constructor(){this.map=new Map,this.set=(t,i)=>{const n=this.get(t);this.exists(t,i)||this.map.set(t,[...n,i])},this.get=t=>this.map.get(t)||[],this.exists=(t,i)=>this.get(t).includes(i),this.delete=(t,i)=>{if(typeof i>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,i))return;const a=n.filter(h=>h!==i);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var WE=Object.defineProperty,GE=Object.defineProperties,QE=Object.getOwnPropertyDescriptors,ml=Object.getOwnPropertySymbols,JE=Object.prototype.hasOwnProperty,YE=Object.prototype.propertyIsEnumerable,vl=(o,t,i)=>t in o?WE(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,Hi=(o,t)=>{for(var i in t||(t={}))JE.call(t,i)&&vl(o,i,t[i]);if(ml)for(var i of ml(t))YE.call(t,i)&&vl(o,i,t[i]);return o},Wo=(o,t)=>GE(o,QE(t));class ZE extends u_{constructor(t,i){super(t,i),this.relayer=t,this.logger=i,this.subscriptions=new Map,this.topicMap=new KE,this.events=new nr.EventEmitter,this.name=$E,this.version=UE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=$r,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}});try{const h=oa(a),p={topic:n,relay:h};this.pending.set(n,p);const d=await this.rpcSubscribe(n,h);return this.onSubscribe(d,p),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}}),d}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(n,a.id,a):await this.unsubscribeByTopic(n,a)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((a,h)=>{const p=new ee.Watch;p.start(this.pendingSubscriptionWatchLabel);const d=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(d),p.stop(this.pendingSubscriptionWatchLabel),a(!0)),p.elapsed(this.pendingSubscriptionWatchLabel)>=DE&&(clearInterval(d),p.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=jt(i,this.name),this.clientId=""}get context(){return Lt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,i){let n=!1;try{n=this.getSubscription(t).topic===i}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,i){const n=this.topicMap.get(t);await Promise.all(n.map(async a=>await this.unsubscribeById(t,a,i)))}async unsubscribeById(t,i,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:i,opts:n}});try{const a=oa(n);await this.rpcUnsubscribe(t,i,a);const h=ft("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,i,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:i,opts:n}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,i){const n={method:Zn(i.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await ns(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(We.connection_stalled)}return yi(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const i=t[0].relay,n={method:Zn(i.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await ns(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(We.connection_stalled)}}rpcUnsubscribe(t,i,n){const a={method:Zn(n.protocol).unsubscribe,params:{topic:t,id:i}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,i){this.setSubscription(t,Wo(Hi({},i),{id:t})),this.pending.delete(i.topic)}onBatchSubscribe(t){t.length&&t.forEach(i=>{this.setSubscription(i.id,Hi({},i)),this.pending.delete(i.topic)})}async onUnsubscribe(t,i,n){this.events.removeAllListeners(i),this.hasSubscription(i,t)&&this.deleteSubscription(i,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,i){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:i}),this.addSubscription(t,i))}addSubscription(t,i){this.subscriptions.set(t,Hi({},i)),this.topicMap.set(i.topic,t),this.events.emit(ur.created,i)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const i=this.subscriptions.get(t);if(!i){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return i}deleteSubscription(t,i){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:i});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(ur.deleted,Wo(Hi({},n),{reason:i}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ur.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<t;i++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(ur.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:i}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const i=await this.rpcBatchSubscribe(t);en(i)&&this.onBatchSubscribe(i.map((n,a)=>Wo(Hi({},t[a]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(i=>{t.push(i)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Zi.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(We.connect,async()=>{await this.onConnect()}),this.relayer.on(We.disconnect,()=>{this.onDisconnect()}),this.events.on(ur.created,async t=>{const i=ur.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),await this.persist()}),this.events.on(ur.deleted,async t=>{const i=ur.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const i=setInterval(()=>{this.restartInProgress||(clearInterval(i),t())},this.pollingInterval)})}}var XE=Object.defineProperty,wl=Object.getOwnPropertySymbols,eS=Object.prototype.hasOwnProperty,tS=Object.prototype.propertyIsEnumerable,_l=(o,t,i)=>t in o?XE(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,rS=(o,t)=>{for(var i in t||(t={}))eS.call(t,i)&&_l(o,i,t[i]);if(wl)for(var i of wl(t))tS.call(t,i)&&_l(o,i,t[i]);return o};class iS extends a_{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new nr.EventEmitter,this.name=PE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async i=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(i)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?jt(t.logger,this.name):us(hs({level:t.logger||OE})),this.messages=new VE(this.logger,t.core),this.subscriber=new ZE(this,this.logger),this.publisher=new BE(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Tf,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${gl}...`),await this.restartTransport(gl)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},RE)}get context(){return Lt(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,i,n){this.isInitialized(),await this.publisher.publish(t,i,n),await this.recordMessageEvent({topic:t,message:i,publishedAt:Date.now()})}async subscribe(t,i){var n;this.isInitialized();let a=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"";return a||(await Promise.all([new Promise(h=>{this.subscriber.once(ur.created,p=>{p.topic===t&&h()})}),new Promise(async h=>{a=await this.subscriber.subscribe(t,i),h()})]),a)}async unsubscribe(t,i){this.isInitialized(),await this.subscriber.unsubscribe(t,i)}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(We.transport_closed))}async transportOpen(t){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=t||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(i=>{this.initialized||i(),this.subscriber.once(ur.resubscribed,()=>{i()})}),await Promise.race([new Promise(async(i,n)=>{await ns(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>n(a)).then(()=>i()).finally(()=>this.removeListener(We.transport_closed,this.rejectTransportOpen))}),new Promise(i=>this.once(We.transport_closed,this.rejectTransportOpen))])])}catch(i){this.logger.error(i);const n=i;if(!this.isConnectionStalled(n.message))throw i;this.events.emit(We.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=t||this.relayUrl,this.connected&&await Promise.all([new Promise(i=>{this.provider.once(zi.disconnect,()=>{i()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(t){return this.staleConnectionErrors.some(i=>t.includes(i))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new M1(new H1(J_({sdkVersion:CE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:i,message:n}=t;await this.messages.set(i,n)}async shouldIgnoreMessageEvent(t){const{topic:i,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(i))return this.logger.debug(`Ignoring message for non-subscribed topic ${i}`),!0;const a=this.messages.has(i,n);return a&&this.logger.debug(`Ignoring duplicate message: ${n}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),pa(t)){if(!t.method.endsWith(NE))return;const i=t.params,{topic:n,message:a,publishedAt:h}=i.data,p={topic:n,message:a,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(rS({type:"event",event:i.id},p)),this.events.emit(i.id,p),await this.acknowledgePayload(t),await this.onMessageEvent(p)}else Yi(t)&&this.events.emit(We.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(We.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const i=ga(t.id,!0);await this.provider.connection.send(i)}registerProviderListeners(){this.provider.on(zi.payload,t=>this.onProviderPayload(t)),this.provider.on(zi.connect,()=>{this.events.emit(We.connect)}),this.provider.on(zi.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(zi.error,t=>{this.logger.error(t),this.events.emit(We.error,t)})}registerEventListeners(){this.events.on(We.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(We.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ee.toMiliseconds(AE))}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(t=>{const i=setInterval(()=>{this.connected&&(clearInterval(i),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var nS=Object.defineProperty,bl=Object.getOwnPropertySymbols,sS=Object.prototype.hasOwnProperty,oS=Object.prototype.propertyIsEnumerable,El=(o,t,i)=>t in o?nS(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,Sl=(o,t)=>{for(var i in t||(t={}))sS.call(t,i)&&El(o,i,t[i]);if(bl)for(var i of bl(t))oS.call(t,i)&&El(o,i,t[i]);return o};class ds extends c_{constructor(t,i,n,a=$r,h=void 0){super(t,i,n,a),this.core=t,this.logger=i,this.name=n,this.map=new Map,this.version=TE,this.cached=[],this.initialized=!1,this.storagePrefix=$r,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(p=>{this.getKey&&p!==null&&!Et(p)?this.map.set(this.getKey(p),p):w1(p)?this.map.set(p.id,p):_1(p)&&this.map.set(p.topic,p)}),this.cached=[],this.initialized=!0)},this.set=async(p,d)=>{this.isInitialized(),this.map.has(p)?await this.update(p,d):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:p,value:d}),this.map.set(p,d),await this.persist())},this.get=p=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:p}),this.getData(p)),this.getAll=p=>(this.isInitialized(),p?this.values.filter(d=>Object.keys(p).every(v=>Tw(d[v],p[v]))):this.values),this.update=async(p,d)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:p,update:d});const v=Sl(Sl({},this.getData(p)),d);this.map.set(p,v),await this.persist()},this.delete=async(p,d)=>{this.isInitialized(),this.map.has(p)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:p,reason:d}),this.map.delete(p),await this.persist())},this.logger=jt(i,this.name),this.storagePrefix=a,this.getKey=h}get context(){return Lt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const i=this.map.get(t);if(!i){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return i}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:i}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class aS{constructor(t,i){this.core=t,this.logger=i,this.name=jE,this.version=LE,this.events=new ya,this.initialized=!1,this.storagePrefix=$r,this.ignoredPayloadTypes=[Yr],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=sa(),a=await this.core.crypto.setSymKey(n),h=rr(ee.FIVE_MINUTES),p={protocol:Rf},d={topic:a,expiry:h,relay:p,active:!1},v=u1({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:n,relay:p});return await this.pairings.set(a,d),await this.core.relayer.subscribe(a),this.core.expirer.set(a,h),{topic:a,uri:v}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:a,symKey:h,relay:p}=o1(n.uri);if(this.pairings.keys.includes(a))throw new Error(`Pairing already exists: ${a}`);if(this.core.crypto.hasKeys(a))throw new Error(`Keychain already exists: ${a}`);const d=rr(ee.FIVE_MINUTES),v={topic:a,relay:p,expiry:d,active:!1};return await this.pairings.set(a,v),await this.core.crypto.setSymKey(h,a),await this.core.relayer.subscribe(a,{relay:p}),this.core.expirer.set(a,d),n.activatePairing&&await this.activate({topic:a}),v},this.activate=async({topic:n})=>{this.isInitialized();const a=rr(ee.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:a}),this.core.expirer.set(n,a)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:a}=n;if(this.pairings.keys.includes(a)){const h=await this.sendRequest(a,"wc_pairingPing",{}),{done:p,resolve:d,reject:v}=gi();this.events.once(st("pairing_ping",h),({error:S})=>{S?v(S):d()}),await p()}},this.updateExpiry=async({topic:n,expiry:a})=>{this.isInitialized(),await this.pairings.update(n,{expiry:a})},this.updateMetadata=async({topic:n,metadata:a})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:a}=n;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",ft("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(n,a,h)=>{const p=Ji(a,h),d=await this.core.crypto.encode(n,p),v=ki[a].req;return this.core.history.set(n,p),this.core.relayer.publish(n,d,v),p.id},this.sendResult=async(n,a,h)=>{const p=ga(n,h),d=await this.core.crypto.encode(a,p),v=await this.core.history.get(a,n),S=ki[v.request.method].res;await this.core.relayer.publish(a,d,S),await this.core.history.resolve(p)},this.sendError=async(n,a,h)=>{const p=da(n,h),d=await this.core.crypto.encode(a,p),v=await this.core.history.get(a,n),S=ki[v.request.method]?ki[v.request.method].res:ki.unregistered_method.res;await this.core.relayer.publish(a,d,S),await this.core.history.resolve(p)},this.deletePairing=async(n,a)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,ft("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),a?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(a=>Tr(a.expiry));await Promise.all(n.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=n=>{const{topic:a,payload:h}=n;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(a,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,h);default:return this.onUnknownRpcMethodRequest(a,h)}},this.onRelayEventResponse=async n=>{const{topic:a,payload:h}=n,p=(await this.core.history.get(a,h.id)).request.method;switch(p){case"wc_pairingPing":return this.onPairingPingResponse(a,h);default:return this.onUnknownRpcMethodResponse(p)}},this.onPairingPingRequest=async(n,a)=>{const{id:h}=a;try{this.isValidPing({topic:n}),await this.sendResult(h,n,!0),this.events.emit("pairing_ping",{id:h,topic:n})}catch(p){await this.sendError(h,n,p),this.logger.error(p)}},this.onPairingPingResponse=(n,a)=>{const{id:h}=a;setTimeout(()=>{Rr(a)?this.events.emit(st("pairing_ping",h),{}):tr(a)&&this.events.emit(st("pairing_ping",h),{error:a.error})},500)},this.onPairingDeleteRequest=async(n,a)=>{const{id:h}=a;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:h,topic:n})}catch(p){await this.sendError(h,n,p),this.logger.error(p)}},this.onUnknownRpcMethodRequest=async(n,a)=>{const{id:h,method:p}=a;try{if(this.registeredMethods.includes(p))return;const d=ft("WC_METHOD_UNSUPPORTED",p);await this.sendError(h,n,d),this.logger.error(d)}catch(d){await this.sendError(h,n,d),this.logger.error(d)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(ft("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!Ct(n)){const{message:a}=G("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(a)}if(!v1(n.uri)){const{message:a}=G("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(a)}},this.isValidPing=async n=>{if(!Ct(n)){const{message:h}=G("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(h)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidDisconnect=async n=>{if(!Ct(n)){const{message:h}=G("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(h)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async n=>{if(!dt(n,!1)){const{message:a}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(a)}if(!this.pairings.keys.includes(n)){const{message:a}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(a)}if(Tr(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:a}=G("EXPIRED",`pairing topic: ${n}`);throw new Error(a)}},this.core=t,this.logger=jt(i,this.name),this.pairings=new ds(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Lt(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(We.message,async t=>{const{topic:i,message:n}=t;if(!this.pairings.keys.includes(i)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const a=await this.core.crypto.decode(i,n);pa(a)?(this.core.history.set(i,a),this.onRelayEventRequest({topic:i,payload:a})):Yi(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:i,payload:a}),this.core.history.delete(i,a.id))})}registerExpirerEvents(){this.core.expirer.on(Gt.expired,async t=>{const{topic:i}=pf(t.target);i&&this.pairings.keys.includes(i)&&(await this.deletePairing(i,!0),this.events.emit("pairing_expire",{topic:i}))})}}class cS extends n_{constructor(t,i){super(t,i),this.core=t,this.logger=i,this.records=new Map,this.events=new nr.EventEmitter,this.name=qE,this.version=ME,this.cached=[],this.initialized=!1,this.storagePrefix=$r,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,a,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:a,chainId:h}),this.records.has(a.id))return;const p={id:a.id,topic:n,request:{method:a.method,params:a.params||null},chainId:h,expiry:rr(ee.THIRTY_DAYS)};this.records.set(p.id,p),this.events.emit(cr.created,p)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const a=await this.getRecord(n.id);typeof a.response>"u"&&(a.response=tr(n)?{error:n.error}:{result:n.result},this.records.set(a.id,a),this.events.emit(cr.updated,a))},this.get=async(n,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:a}),await this.getRecord(a)),this.delete=(n,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(h=>{if(h.topic===n){if(typeof a<"u"&&h.id!==a)return;this.records.delete(h.id),this.events.emit(cr.deleted,h)}})},this.exists=async(n,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===n:!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=jt(i,this.name)}get context(){return Lt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(i=>{if(typeof i.response<"u")return;const n={topic:i.topic,request:Ji(i.request.method,i.request.params,i.id),chainId:i.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const i=this.records.get(t);if(!i){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return i}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(cr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:i}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(cr.created,t=>{const i=cr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.events.on(cr.updated,t=>{const i=cr.updated;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.events.on(cr.deleted,t=>{const i=cr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:t}),this.persist()}),this.core.heartbeat.on(Zi.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{ee.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class uS extends h_{constructor(t,i){super(t,i),this.core=t,this.logger=i,this.expirations=new Map,this.events=new nr.EventEmitter,this.name=FE,this.version=zE,this.cached=[],this.initialized=!1,this.storagePrefix=$r,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const a=this.formatTarget(n);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(n,a)=>{this.isInitialized();const h=this.formatTarget(n),p={target:h,expiry:a};this.expirations.set(h,p),this.checkExpiry(h,p),this.events.emit(Gt.created,{target:h,expiration:p})},this.get=n=>{this.isInitialized();const a=this.formatTarget(n);return this.getExpiration(a)},this.del=n=>{if(this.isInitialized(),this.has(n)){const a=this.formatTarget(n),h=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Gt.deleted,{target:a,expiration:h})}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=jt(i,this.name)}get context(){return Lt(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Y_(t);if(typeof t=="number")return Z_(t);const{message:i}=G("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(i)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Gt.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:i}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const i=this.expirations.get(t);if(!i){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return i}checkExpiry(t,i){const{expiry:n}=i;ee.toMiliseconds(n)-Date.now()<=0&&this.expire(t,i)}expire(t,i){this.expirations.delete(t),this.events.emit(Gt.expired,{target:t,expiration:i})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,i)=>this.checkExpiry(i,t))}registerEventListeners(){this.core.heartbeat.on(Zi.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Gt.created,t=>{const i=Gt.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()}),this.events.on(Gt.expired,t=>{const i=Gt.expired;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()}),this.events.on(Gt.deleted,t=>{const i=Gt.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class hS extends l_{constructor(t,i){super(t,i),this.projectId=t,this.logger=i,this.name=Ko,this.initialized=!1,this.init=async n=>{hf()||!Na()||(this.verifyUrl=(n==null?void 0:n.verifyUrl)||yl,await this.createIframe())},this.register=async n=>{var a;if(this.initialized||await this.init(),!!this.iframe)try{(a=this.iframe.contentWindow)==null||a.postMessage(n.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${n.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async n=>{var a;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${n.attestationId}`);const h=this.startAbortTimer(ee.FIVE_SECONDS),p=await fetch(`${this.verifyUrl}/attestation/${n.attestationId}`,{signal:this.abortController.signal});return clearTimeout(h),p.status===200?(a=await p.json())==null?void 0:a.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((n,a)=>{if(document.getElementById(Ko))return n();const h=document.createElement("iframe");h.setAttribute("id",Ko),h.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),h.style.display="none",h.addEventListener("load",()=>{this.initialized=!0,n()}),h.addEventListener("error",p=>{a(p)}),document.body.append(h),this.iframe=h}),new Promise(n=>{setTimeout(()=>n("iframe load timeout"),ee.toMiliseconds(ee.ONE_SECOND/2))})])}catch(n){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(n)}},this.logger=jt(i,this.name),this.verifyUrl=yl,this.abortController=new AbortController,this.isDevEnv=Pa()&&V1.IS_VITEST}get context(){return Lt(this.logger)}startAbortTimer(t){return setTimeout(()=>this.abortController.abort(),ee.toMiliseconds(t))}}var lS=Object.defineProperty,Il=Object.getOwnPropertySymbols,fS=Object.prototype.hasOwnProperty,dS=Object.prototype.propertyIsEnumerable,Ol=(o,t,i)=>t in o?lS(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,Pl=(o,t)=>{for(var i in t||(t={}))fS.call(t,i)&&Ol(o,i,t[i]);if(Il)for(var i of Il(t))dS.call(t,i)&&Ol(o,i,t[i]);return o};class Ra extends i_{constructor(t){super(t),this.protocol=Af,this.version=pE,this.name=Cf,this.events=new nr.EventEmitter,this.initialized=!1,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Tf;const i=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:us(hs({level:(t==null?void 0:t.logger)||gE.logger}));this.logger=jt(i,this.name),this.heartbeat=new Zi.HeartBeat,this.crypto=new HE(this,this.logger,t==null?void 0:t.keychain),this.history=new cS(this,this.logger),this.expirer=new uS(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Aw(Pl(Pl({},yE),t==null?void 0:t.storageOptions)),this.relayer=new iS({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new aS(this,this.logger),this.verify=new hS(this.projectId||"",this.logger)}static async init(t){const i=new Ra(t);await i.initialize();const n=await i.crypto.getClientId();return await i.storage.setItem(xE,n),i}get context(){return Lt(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const pS=Ra,xf="wc",$f=2,Uf="client",Ta=`${xf}@${$f}:${Uf}:`,Go={name:Uf,logger:"error"},gS="WALLETCONNECT_DEEPLINK_CHOICE",yS="proposal",Df="Proposal expired",mS="session",Qn=ee.SEVEN_DAYS,vS="engine",Vi={wc_sessionPropose:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1115}}},Qo={min:ee.FIVE_MINUTES,max:ee.SEVEN_DAYS},Bi={idle:"idle",active:"active"},wS="request",_S=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var bS=Object.defineProperty,ES=Object.defineProperties,SS=Object.getOwnPropertyDescriptors,Nl=Object.getOwnPropertySymbols,IS=Object.prototype.hasOwnProperty,OS=Object.prototype.propertyIsEnumerable,Al=(o,t,i)=>t in o?bS(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,Wt=(o,t)=>{for(var i in t||(t={}))IS.call(t,i)&&Al(o,i,t[i]);if(Nl)for(var i of Nl(t))OS.call(t,i)&&Al(o,i,t[i]);return o},Jo=(o,t)=>ES(o,SS(t));class PS extends d_{constructor(t){super(t),this.name=vS,this.events=new ya,this.initialized=!1,this.ignoredPayloadTypes=[Yr],this.requestQueue={state:Bi.idle,requests:[]},this.requestQueueDelay=ee.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Vi)}),this.initialized=!0,setTimeout(()=>{this.requestQueue.requests=this.getPendingSessionRequests(),this.processRequestQueue()},ee.toMiliseconds(this.requestQueueDelay)))},this.connect=async i=>{this.isInitialized();const n=Jo(Wt({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:a,requiredNamespaces:h,optionalNamespaces:p,sessionProperties:d,relays:v}=n;let S=a,I,R=!1;if(S&&(R=this.client.core.pairing.pairings.get(S).active),!S||!R){const{topic:w,uri:g}=await this.client.core.pairing.create();S=w,I=g}const x=await this.client.core.crypto.generateKeyPair(),A=Wt({requiredNamespaces:h,optionalNamespaces:p,relays:v??[{protocol:Rf}],proposer:{publicKey:x,metadata:this.client.metadata}},d&&{sessionProperties:d}),{reject:j,resolve:z,done:F}=gi(ee.FIVE_MINUTES,Df);if(this.events.once(st("session_connect"),async({error:w,session:g})=>{if(w)j(w);else if(g){g.self.publicKey=x;const y=Jo(Wt({},g),{requiredNamespaces:g.requiredNamespaces,optionalNamespaces:g.optionalNamespaces});await this.client.session.set(g.topic,y),await this.setExpiry(g.topic,g.expiry),S&&await this.client.core.pairing.updateMetadata({topic:S,metadata:g.peer.metadata}),z(y)}}),!S){const{message:w}=G("NO_MATCHING_KEY",`connect() pairing topic: ${S}`);throw new Error(w)}const V=await this.sendRequest(S,"wc_sessionPropose",A),l=rr(ee.FIVE_MINUTES);return await this.setProposal(V,Wt({id:V,expiry:l},A)),{uri:I,approval:F}},this.pair=async i=>(this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{this.isInitialized(),await this.isValidApprove(i);const{id:n,relayProtocol:a,namespaces:h,sessionProperties:p}=i,d=this.client.proposal.get(n);let{pairingTopic:v,proposer:S,requiredNamespaces:I,optionalNamespaces:R}=d;v=v||"",Qi(I)||(I=d1(h,"approve()"));const x=await this.client.core.crypto.generateKeyPair(),A=S.publicKey,j=await this.client.core.crypto.generateSharedKey(x,A);v&&n&&(await this.client.core.pairing.updateMetadata({topic:v,metadata:S.metadata}),await this.sendResult(n,v,{relay:{protocol:a??"irn"},responderPublicKey:x}),await this.client.proposal.delete(n,ft("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:v}));const z=Wt({relay:{protocol:a??"irn"},namespaces:h,requiredNamespaces:I,optionalNamespaces:R,pairingTopic:v,controller:{publicKey:x,metadata:this.client.metadata},expiry:rr(Qn)},p&&{sessionProperties:p});await this.client.core.relayer.subscribe(j),await this.sendRequest(j,"wc_sessionSettle",z);const F=Jo(Wt({},z),{topic:j,pairingTopic:v,acknowledged:!1,self:z.controller,peer:{publicKey:S.publicKey,metadata:S.metadata},controller:x});return await this.client.session.set(j,F),await this.setExpiry(j,rr(Qn)),{topic:j,acknowledged:()=>new Promise(V=>setTimeout(()=>V(this.client.session.get(j)),500))}},this.reject=async i=>{this.isInitialized(),await this.isValidReject(i);const{id:n,reason:a}=i,{pairingTopic:h}=this.client.proposal.get(n);h&&(await this.sendError(n,h,a),await this.client.proposal.delete(n,ft("USER_DISCONNECTED")))},this.update=async i=>{this.isInitialized(),await this.isValidUpdate(i);const{topic:n,namespaces:a}=i,h=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:a}),{done:p,resolve:d,reject:v}=gi();return this.events.once(st("session_update",h),({error:S})=>{S?v(S):d()}),await this.client.session.update(n,{namespaces:a}),{acknowledged:p}},this.extend=async i=>{this.isInitialized(),await this.isValidExtend(i);const{topic:n}=i,a=await this.sendRequest(n,"wc_sessionExtend",{}),{done:h,resolve:p,reject:d}=gi();return this.events.once(st("session_extend",a),({error:v})=>{v?d(v):p()}),await this.setExpiry(n,rr(Qn)),{acknowledged:h}},this.request=async i=>{this.isInitialized(),await this.isValidRequest(i);const{chainId:n,request:a,topic:h,expiry:p}=i,d=await this.sendRequest(h,"wc_sessionRequest",{request:a,chainId:n},p),{done:v,resolve:S,reject:I}=gi(p);this.events.once(st("session_request",d),({error:x,result:A})=>{x?I(x):S(A)}),this.client.events.emit("session_request_sent",{topic:h,request:a,chainId:n,id:d});const R=await this.client.core.storage.getItem(gS);return X_({id:d,topic:h,wcDeepLink:R}),await v()},this.respond=async i=>{this.isInitialized(),await this.isValidRespond(i);const{topic:n,response:a}=i,{id:h}=a;Rr(a)?await this.sendResult(h,n,a.result):tr(a)&&await this.sendError(h,n,a.error),this.cleanupAfterResponse(i)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.client.session.keys.includes(n)){const a=await this.sendRequest(n,"wc_sessionPing",{}),{done:h,resolve:p,reject:d}=gi();this.events.once(st("session_ping",a),({error:v})=>{v?d(v):p()}),await h()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async i=>{this.isInitialized(),await this.isValidEmit(i);const{topic:n,event:a,chainId:h}=i;await this.sendRequest(n,"wc_sessionEvent",{event:a,chainId:h})},this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;if(this.client.session.keys.includes(n)){const a=cs().toString();let h;const p=d=>{(d==null?void 0:d.id.toString())===a&&(this.client.core.relayer.events.removeListener(We.message_ack,p),h())};await Promise.all([new Promise(d=>{h=d,this.client.core.relayer.on(We.message_ack,p)}),this.sendRequest(n,"wc_sessionDelete",ft("USER_DISCONNECTED"),void 0,a)]),await this.deleteSession(n)}else await this.client.core.pairing.disconnect({topic:n})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(n=>y1(n,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const n=this.client.core.pairing.pairings.get(i.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(h=>{var p,d;return((p=h.peerMetadata)==null?void 0:p.url)&&((d=h.peerMetadata)==null?void 0:d.url)===i.peer.metadata.url&&h.topic&&h.topic!==n.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(i,n)=>{const{self:a}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,ft("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),n||this.client.core.expirer.del(i)},this.deleteProposal=async(i,n)=>{await Promise.all([this.client.proposal.delete(i,ft("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,n,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,n),a?Promise.resolve():this.client.core.expirer.del(i)]),this.requestQueue.requests=this.requestQueue.requests.filter(h=>h.id!==i),a&&(this.requestQueue.state=Bi.idle)},this.setExpiry=async(i,n)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:n}),this.client.core.expirer.set(i,n)},this.setProposal=async(i,n)=>{await this.client.proposal.set(i,n),this.client.core.expirer.set(i,n.expiry)},this.setPendingSessionRequest=async i=>{const n=Vi.wc_sessionRequest.req.ttl,{id:a,topic:h,params:p}=i;await this.client.pendingRequest.set(a,{id:a,topic:h,params:p}),n&&this.client.core.expirer.set(a,rr(n))},this.sendRequest=async(i,n,a,h,p)=>{const d=Ji(n,a);if(Na()&&_S.includes(n)){const I=yi(JSON.stringify(d));await this.client.core.verify.register({attestationId:I})}const v=await this.client.core.crypto.encode(i,d),S=Vi[n].req;return h&&(S.ttl=h),p&&(S.id=p),this.client.core.history.set(i,d),this.client.core.relayer.publish(i,v,S),d.id},this.sendResult=async(i,n,a)=>{const h=ga(i,a),p=await this.client.core.crypto.encode(n,h),d=await this.client.core.history.get(n,i),v=Vi[d.request.method].res;this.client.core.relayer.publish(n,p,v),await this.client.core.history.resolve(h)},this.sendError=async(i,n,a)=>{const h=da(i,a),p=await this.client.core.crypto.encode(n,h),d=await this.client.core.history.get(n,i),v=Vi[d.request.method].res;this.client.core.relayer.publish(n,p,v),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const i=[],n=[];this.client.session.getAll().forEach(a=>{Tr(a.expiry)&&i.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Tr(a.expiry)&&n.push(a.id)}),await Promise.all([...i.map(a=>this.deleteSession(a)),...n.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=i=>{const{topic:n,payload:a}=i,h=a.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(n,a);case"wc_sessionSettle":return this.onSessionSettleRequest(n,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,a);case"wc_sessionExtend":return this.onSessionExtendRequest(n,a);case"wc_sessionPing":return this.onSessionPingRequest(n,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,a);case"wc_sessionRequest":return this.onSessionRequest(n,a);case"wc_sessionEvent":return this.onSessionEventRequest(n,a);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:a}=i,h=(await this.client.core.history.get(n,a.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(n,a);case"wc_sessionSettle":return this.onSessionSettleResponse(n,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,a);case"wc_sessionExtend":return this.onSessionExtendResponse(n,a);case"wc_sessionPing":return this.onSessionPingResponse(n,a);case"wc_sessionRequest":return this.onSessionRequestResponse(n,a);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:n}=i,{message:a}=G("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(i,n)=>{const{params:a,id:h}=n;try{this.isValidConnect(Wt({},n.params));const p=rr(ee.FIVE_MINUTES),d=Wt({id:h,pairingTopic:i,expiry:p},a);await this.setProposal(h,d);const v=yi(JSON.stringify(n)),S=await this.getVerifyContext(v,d.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:d,verifyContext:S})}catch(p){await this.sendError(h,i,p),this.client.logger.error(p)}},this.onSessionProposeResponse=async(i,n)=>{const{id:a}=n;if(Rr(n)){const{result:h}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const p=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const d=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const v=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:v});const S=await this.client.core.crypto.generateSharedKey(d,v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:S});const I=await this.client.core.relayer.subscribe(S);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:I}),await this.client.core.pairing.activate({topic:i})}else tr(n)&&(await this.client.proposal.delete(a,ft("USER_DISCONNECTED")),this.events.emit(st("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(i,n)=>{const{id:a,params:h}=n;try{this.isValidSessionSettleRequest(h);const{relay:p,controller:d,expiry:v,namespaces:S,requiredNamespaces:I,optionalNamespaces:R,sessionProperties:x,pairingTopic:A}=n.params,j=Wt({topic:i,relay:p,expiry:v,namespaces:S,acknowledged:!0,pairingTopic:A,requiredNamespaces:I,optionalNamespaces:R,controller:d.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:d.publicKey,metadata:d.metadata}},x&&{sessionProperties:x});await this.sendResult(n.id,i,!0),this.events.emit(st("session_connect"),{session:j}),this.cleanupDuplicatePairings(j)}catch(p){await this.sendError(a,i,p),this.client.logger.error(p)}},this.onSessionSettleResponse=async(i,n)=>{const{id:a}=n;Rr(n)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(st("session_approve",a),{})):tr(n)&&(await this.client.session.delete(i,ft("USER_DISCONNECTED")),this.events.emit(st("session_approve",a),{error:n.error}))},this.onSessionUpdateRequest=async(i,n)=>{const{params:a,id:h}=n;try{this.isValidUpdate(Wt({topic:i},a)),await this.client.session.update(i,{namespaces:a.namespaces}),await this.sendResult(h,i,!0),this.client.events.emit("session_update",{id:h,topic:i,params:a})}catch(p){await this.sendError(h,i,p),this.client.logger.error(p)}},this.onSessionUpdateResponse=(i,n)=>{const{id:a}=n;Rr(n)?this.events.emit(st("session_update",a),{}):tr(n)&&this.events.emit(st("session_update",a),{error:n.error})},this.onSessionExtendRequest=async(i,n)=>{const{id:a}=n;try{this.isValidExtend({topic:i}),await this.setExpiry(i,rr(Qn)),await this.sendResult(a,i,!0),this.client.events.emit("session_extend",{id:a,topic:i})}catch(h){await this.sendError(a,i,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(i,n)=>{const{id:a}=n;Rr(n)?this.events.emit(st("session_extend",a),{}):tr(n)&&this.events.emit(st("session_extend",a),{error:n.error})},this.onSessionPingRequest=async(i,n)=>{const{id:a}=n;try{this.isValidPing({topic:i}),await this.sendResult(a,i,!0),this.client.events.emit("session_ping",{id:a,topic:i})}catch(h){await this.sendError(a,i,h),this.client.logger.error(h)}},this.onSessionPingResponse=(i,n)=>{const{id:a}=n;setTimeout(()=>{Rr(n)?this.events.emit(st("session_ping",a),{}):tr(n)&&this.events.emit(st("session_ping",a),{error:n.error})},500)},this.onSessionDeleteRequest=async(i,n)=>{const{id:a}=n;try{this.isValidDisconnect({topic:i,reason:n.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(We.publish,async()=>{h(await this.deleteSession(i))})}),this.sendResult(a,i,!0)]),this.client.events.emit("session_delete",{id:a,topic:i})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(i,n)=>{const{id:a,params:h}=n;try{this.isValidRequest(Wt({topic:i},h)),await this.setPendingSessionRequest({id:a,topic:i,params:h}),this.addRequestToQueue({id:a,topic:i,params:h}),await this.processRequestQueue()}catch(p){await this.sendError(a,i,p),this.client.logger.error(p)}},this.onSessionRequestResponse=(i,n)=>{const{id:a}=n;Rr(n)?this.events.emit(st("session_request",a),{result:n.result}):tr(n)&&this.events.emit(st("session_request",a),{error:n.error})},this.onSessionEventRequest=async(i,n)=>{const{id:a,params:h}=n;try{this.isValidEmit(Wt({topic:i},h)),this.client.events.emit("session_event",{id:a,topic:i,params:h})}catch(p){await this.sendError(a,i,p),this.client.logger.error(p)}},this.addRequestToQueue=i=>{this.requestQueue.requests.push(i)},this.cleanupAfterResponse=i=>{this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.requestQueue.state=Bi.idle,this.processRequestQueue()},ee.toMiliseconds(this.requestQueueDelay))},this.processRequestQueue=async()=>{if(this.requestQueue.state===Bi.active){this.client.logger.info("session request queue is already active.");return}const i=this.requestQueue.requests[0];if(!i){this.client.logger.info("session request queue is empty.");return}try{const{id:n,topic:a,params:h}=i,p=yi(JSON.stringify({id:n,params:h})),d=this.client.session.get(a),v=await this.getVerifyContext(p,d.peer.metadata);this.requestQueue.state=Bi.active,this.client.events.emit("session_request",{id:n,topic:a,params:h,verifyContext:v})}catch(n){this.client.logger.error(n)}},this.isValidConnect=async i=>{if(!Ct(i)){const{message:v}=G("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(v)}const{pairingTopic:n,requiredNamespaces:a,optionalNamespaces:h,sessionProperties:p,relays:d}=i;if(Et(n)||await this.isValidPairingTopic(n),!A1(d)){const{message:v}=G("MISSING_OR_INVALID",`connect() relays: ${d}`);throw new Error(v)}!Et(a)&&Qi(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!Et(h)&&Qi(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),Et(p)||this.validateSessionProps(p,"sessionProperties")},this.validateNamespaces=(i,n)=>{const a=N1(i,"connect()",n);if(a)throw new Error(a.message)},this.isValidApprove=async i=>{if(!Ct(i))throw new Error(G("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:n,namespaces:a,relayProtocol:h,sessionProperties:p}=i;await this.isValidProposalId(n);const d=this.client.proposal.get(n),v=Xn(a,"approve()");if(v)throw new Error(v.message);const S=nl(d.requiredNamespaces,a,"approve()");if(S)throw new Error(S.message);if(!dt(h,!0)){const{message:I}=G("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(I)}Et(p)||this.validateSessionProps(p,"sessionProperties")},this.isValidReject=async i=>{if(!Ct(i)){const{message:h}=G("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(h)}const{id:n,reason:a}=i;if(await this.isValidProposalId(n),!R1(a)){const{message:h}=G("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidSessionSettleRequest=i=>{if(!Ct(i)){const{message:S}=G("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(S)}const{relay:n,controller:a,namespaces:h,expiry:p}=i;if(!yf(n)){const{message:S}=G("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(S)}const d=b1(a,"onSessionSettleRequest()");if(d)throw new Error(d.message);const v=Xn(h,"onSessionSettleRequest()");if(v)throw new Error(v.message);if(Tr(p)){const{message:S}=G("EXPIRED","onSessionSettleRequest()");throw new Error(S)}},this.isValidUpdate=async i=>{if(!Ct(i)){const{message:v}=G("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(v)}const{topic:n,namespaces:a}=i;await this.isValidSessionTopic(n);const h=this.client.session.get(n),p=Xn(a,"update()");if(p)throw new Error(p.message);const d=nl(h.requiredNamespaces,a,"update()");if(d)throw new Error(d.message)},this.isValidExtend=async i=>{if(!Ct(i)){const{message:a}=G("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(a)}const{topic:n}=i;await this.isValidSessionTopic(n)},this.isValidRequest=async i=>{if(!Ct(i)){const{message:v}=G("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(v)}const{topic:n,request:a,chainId:h,expiry:p}=i;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!il(d,h)){const{message:v}=G("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(v)}if(!T1(a)){const{message:v}=G("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(v)}if(!U1(d,h,a.method)){const{message:v}=G("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(v)}if(p&&!q1(p,Qo)){const{message:v}=G("MISSING_OR_INVALID",`request() expiry: ${p}. Expiry must be a number (in seconds) between ${Qo.min} and ${Qo.max}`);throw new Error(v)}},this.isValidRespond=async i=>{if(!Ct(i)){const{message:h}=G("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(h)}const{topic:n,response:a}=i;if(await this.isValidSessionTopic(n),!x1(a)){const{message:h}=G("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidPing=async i=>{if(!Ct(i)){const{message:a}=G("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(a)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async i=>{if(!Ct(i)){const{message:d}=G("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(d)}const{topic:n,event:a,chainId:h}=i;await this.isValidSessionTopic(n);const{namespaces:p}=this.client.session.get(n);if(!il(p,h)){const{message:d}=G("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(d)}if(!$1(a)){const{message:d}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(d)}if(!D1(p,h,a.name)){const{message:d}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(d)}},this.isValidDisconnect=async i=>{if(!Ct(i)){const{message:a}=G("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(a)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(i,n)=>{const a={verified:{verifyUrl:n.verifyUrl||"",validation:"UNKNOWN",origin:n.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:i,verifyUrl:n.verifyUrl});h&&(a.verified.origin=h,a.verified.validation=h===n.url?"VALID":"INVALID")}catch(h){this.client.logger.error(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(i,n)=>{Object.values(i).forEach(a=>{if(!dt(a,!1)){const{message:h}=G("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(h)}})}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(We.message,async t=>{const{topic:i,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const a=await this.client.core.crypto.decode(i,n);pa(a)?(this.client.core.history.set(i,a),this.onRelayEventRequest({topic:i,payload:a})):Yi(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:i,payload:a}),this.client.core.history.delete(i,a.id)):this.onRelayEventUnknownPayload({topic:i,payload:a})})}registerExpirerEvents(){this.client.core.expirer.on(Gt.expired,async t=>{const{topic:i,id:n}=pf(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,G("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession(i,!0),this.client.events.emit("session_expire",{topic:i})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(t){if(!dt(t,!1)){const{message:i}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:i}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(i)}if(Tr(this.client.core.pairing.pairings.get(t).expiry)){const{message:i}=G("EXPIRED",`pairing topic: ${t}`);throw new Error(i)}}async isValidSessionTopic(t){if(!dt(t,!1)){const{message:i}=G("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(i)}if(!this.client.session.keys.includes(t)){const{message:i}=G("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(i)}if(Tr(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:i}=G("EXPIRED",`session topic: ${t}`);throw new Error(i)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(dt(t,!1)){const{message:i}=G("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(i)}else{const{message:i}=G("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(i)}}async isValidProposalId(t){if(!C1(t)){const{message:i}=G("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(i)}if(!this.client.proposal.keys.includes(t)){const{message:i}=G("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(i)}if(Tr(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:i}=G("EXPIRED",`proposal id: ${t}`);throw new Error(i)}}}class NS extends ds{constructor(t,i){super(t,i,yS,Ta),this.core=t,this.logger=i}}class AS extends ds{constructor(t,i){super(t,i,mS,Ta),this.core=t,this.logger=i}}class CS extends ds{constructor(t,i){super(t,i,wS,Ta,n=>n.id),this.core=t,this.logger=i}}let RS=class jf extends f_{constructor(t){super(t),this.protocol=xf,this.version=$f,this.name=Go.name,this.events=new nr.EventEmitter,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(a){throw this.logger.error(a.message),a}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(a){throw this.logger.error(a.message),a}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(a){throw this.logger.error(a.message),a}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(a){throw this.logger.error(a.message),a}},this.update=async n=>{try{return await this.engine.update(n)}catch(a){throw this.logger.error(a.message),a}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(a){throw this.logger.error(a.message),a}},this.request=async n=>{try{return await this.engine.request(n)}catch(a){throw this.logger.error(a.message),a}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(a){throw this.logger.error(a.message),a}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(a){throw this.logger.error(a.message),a}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(a){throw this.logger.error(a.message),a}},this.find=n=>{try{return this.engine.find(n)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(t==null?void 0:t.name)||Go.name,this.metadata=(t==null?void 0:t.metadata)||K_();const i=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:us(hs({level:(t==null?void 0:t.logger)||Go.logger}));this.core=(t==null?void 0:t.core)||new pS(t),this.logger=jt(i,this.name),this.session=new AS(this.core,this.logger),this.proposal=new NS(this.core,this.logger),this.pendingRequest=new CS(this.core,this.logger),this.engine=new PS(this)}static async init(t){const i=new jf(t);return await i.initialize(),i}get context(){return Lt(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var je={},Cl;function Lf(){if(Cl)return je;Cl=1,Object.defineProperty(je,"__esModule",{value:!0}),je.getLocalStorage=je.getLocalStorageOrThrow=je.getCrypto=je.getCryptoOrThrow=je.getLocation=je.getLocationOrThrow=je.getNavigator=je.getNavigatorOrThrow=je.getDocument=je.getDocumentOrThrow=je.getFromWindowOrThrow=je.getFromWindow=void 0;function o(x){let A;return typeof window<"u"&&typeof window[x]<"u"&&(A=window[x]),A}je.getFromWindow=o;function t(x){const A=o(x);if(!A)throw new Error(`${x} is not defined in Window`);return A}je.getFromWindowOrThrow=t;function i(){return t("document")}je.getDocumentOrThrow=i;function n(){return o("document")}je.getDocument=n;function a(){return t("navigator")}je.getNavigatorOrThrow=a;function h(){return o("navigator")}je.getNavigator=h;function p(){return t("location")}je.getLocationOrThrow=p;function d(){return o("location")}je.getLocation=d;function v(){return t("crypto")}je.getCryptoOrThrow=v;function S(){return o("crypto")}je.getCrypto=S;function I(){return t("localStorage")}je.getLocalStorageOrThrow=I;function R(){return o("localStorage")}return je.getLocalStorage=R,je}Lf();var Ki={},Rl;function TS(){if(Rl)return Ki;Rl=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.getWindowMetadata=void 0;const o=Lf();function t(){let i,n;try{i=o.getDocumentOrThrow(),n=o.getLocationOrThrow()}catch{return null}function a(){const A=i.getElementsByTagName("link"),j=[];for(let z=0;z<A.length;z++){const F=A[z],V=F.getAttribute("rel");if(V&&V.toLowerCase().indexOf("icon")>-1){const l=F.getAttribute("href");if(l)if(l.toLowerCase().indexOf("https:")===-1&&l.toLowerCase().indexOf("http:")===-1&&l.indexOf("//")!==0){let w=n.protocol+"//"+n.host;if(l.indexOf("/")===0)w+=l;else{const g=n.pathname.split("/");g.pop();const y=g.join("/");w+=y+"/"+l}j.push(w)}else if(l.indexOf("//")===0){const w=n.protocol+l;j.push(w)}else j.push(l)}}return j}function h(...A){const j=i.getElementsByTagName("meta");for(let z=0;z<j.length;z++){const F=j[z],V=["itemprop","property","name"].map(l=>F.getAttribute(l)).filter(l=>l?A.includes(l):!1);if(V.length&&V){const l=F.getAttribute("content");if(l)return l}}return""}function p(){let A=h("name","og:site_name","og:title","twitter:title");return A||(A=i.title),A}function d(){return h("description","og:description","twitter:description","keywords")}const v=p(),S=d(),I=n.origin,R=a();return{description:S,url:I,icons:R,name:v}}return Ki.getWindowMetadata=t,Ki}TS();var Yo={},Tl;function xS(){return Tl||(Tl=1,function(o){const t=_a(),i=ba(),n=Ea(),a=Sa(),h=l=>l==null,p=Symbol("encodeFragmentIdentifier");function d(l){switch(l.arrayFormat){case"index":return w=>(g,y)=>{const E=g.length;return y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?g:y===null?[...g,[I(w,l),"[",E,"]"].join("")]:[...g,[I(w,l),"[",I(E,l),"]=",I(y,l)].join("")]};case"bracket":return w=>(g,y)=>y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?g:y===null?[...g,[I(w,l),"[]"].join("")]:[...g,[I(w,l),"[]=",I(y,l)].join("")];case"colon-list-separator":return w=>(g,y)=>y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?g:y===null?[...g,[I(w,l),":list="].join("")]:[...g,[I(w,l),":list=",I(y,l)].join("")];case"comma":case"separator":case"bracket-separator":{const w=l.arrayFormat==="bracket-separator"?"[]=":"=";return g=>(y,E)=>E===void 0||l.skipNull&&E===null||l.skipEmptyString&&E===""?y:(E=E===null?"":E,y.length===0?[[I(g,l),w,I(E,l)].join("")]:[[y,I(E,l)].join(l.arrayFormatSeparator)])}default:return w=>(g,y)=>y===void 0||l.skipNull&&y===null||l.skipEmptyString&&y===""?g:y===null?[...g,I(w,l)]:[...g,[I(w,l),"=",I(y,l)].join("")]}}function v(l){let w;switch(l.arrayFormat){case"index":return(g,y,E)=>{if(w=/\[(\d*)\]$/.exec(g),g=g.replace(/\[\d*\]$/,""),!w){E[g]=y;return}E[g]===void 0&&(E[g]={}),E[g][w[1]]=y};case"bracket":return(g,y,E)=>{if(w=/(\[\])$/.exec(g),g=g.replace(/\[\]$/,""),!w){E[g]=y;return}if(E[g]===void 0){E[g]=[y];return}E[g]=[].concat(E[g],y)};case"colon-list-separator":return(g,y,E)=>{if(w=/(:list)$/.exec(g),g=g.replace(/:list$/,""),!w){E[g]=y;return}if(E[g]===void 0){E[g]=[y];return}E[g]=[].concat(E[g],y)};case"comma":case"separator":return(g,y,E)=>{const u=typeof y=="string"&&y.includes(l.arrayFormatSeparator),b=typeof y=="string"&&!u&&R(y,l).includes(l.arrayFormatSeparator);y=b?R(y,l):y;const H=u||b?y.split(l.arrayFormatSeparator).map(J=>R(J,l)):y===null?y:R(y,l);E[g]=H};case"bracket-separator":return(g,y,E)=>{const u=/(\[\])$/.test(g);if(g=g.replace(/\[\]$/,""),!u){E[g]=y&&R(y,l);return}const b=y===null?[]:y.split(l.arrayFormatSeparator).map(H=>R(H,l));if(E[g]===void 0){E[g]=b;return}E[g]=[].concat(E[g],b)};default:return(g,y,E)=>{if(E[g]===void 0){E[g]=y;return}E[g]=[].concat(E[g],y)}}}function S(l){if(typeof l!="string"||l.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function I(l,w){return w.encode?w.strict?t(l):encodeURIComponent(l):l}function R(l,w){return w.decode?i(l):l}function x(l){return Array.isArray(l)?l.sort():typeof l=="object"?x(Object.keys(l)).sort((w,g)=>Number(w)-Number(g)).map(w=>l[w]):l}function A(l){const w=l.indexOf("#");return w!==-1&&(l=l.slice(0,w)),l}function j(l){let w="";const g=l.indexOf("#");return g!==-1&&(w=l.slice(g)),w}function z(l){l=A(l);const w=l.indexOf("?");return w===-1?"":l.slice(w+1)}function F(l,w){return w.parseNumbers&&!Number.isNaN(Number(l))&&typeof l=="string"&&l.trim()!==""?l=Number(l):w.parseBooleans&&l!==null&&(l.toLowerCase()==="true"||l.toLowerCase()==="false")&&(l=l.toLowerCase()==="true"),l}function V(l,w){w=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},w),S(w.arrayFormatSeparator);const g=v(w),y=Object.create(null);if(typeof l!="string"||(l=l.trim().replace(/^[?#&]/,""),!l))return y;for(const E of l.split("&")){if(E==="")continue;let[u,b]=n(w.decode?E.replace(/\+/g," "):E,"=");b=b===void 0?null:["comma","separator","bracket-separator"].includes(w.arrayFormat)?b:R(b,w),g(R(u,w),b,y)}for(const E of Object.keys(y)){const u=y[E];if(typeof u=="object"&&u!==null)for(const b of Object.keys(u))u[b]=F(u[b],w);else y[E]=F(u,w)}return w.sort===!1?y:(w.sort===!0?Object.keys(y).sort():Object.keys(y).sort(w.sort)).reduce((E,u)=>{const b=y[u];return b&&typeof b=="object"&&!Array.isArray(b)?E[u]=x(b):E[u]=b,E},Object.create(null))}o.extract=z,o.parse=V,o.stringify=(l,w)=>{if(!l)return"";w=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},w),S(w.arrayFormatSeparator);const g=b=>w.skipNull&&h(l[b])||w.skipEmptyString&&l[b]==="",y=d(w),E={};for(const b of Object.keys(l))g(b)||(E[b]=l[b]);const u=Object.keys(E);return w.sort!==!1&&u.sort(w.sort),u.map(b=>{const H=l[b];return H===void 0?"":H===null?I(b,w):Array.isArray(H)?H.length===0&&w.arrayFormat==="bracket-separator"?I(b,w)+"[]":H.reduce(y(b),[]).join("&"):I(b,w)+"="+I(H,w)}).filter(b=>b.length>0).join("&")},o.parseUrl=(l,w)=>{w=Object.assign({decode:!0},w);const[g,y]=n(l,"#");return Object.assign({url:g.split("?")[0]||"",query:V(z(l),w)},w&&w.parseFragmentIdentifier&&y?{fragmentIdentifier:R(y,w)}:{})},o.stringifyUrl=(l,w)=>{w=Object.assign({encode:!0,strict:!0,[p]:!0},w);const g=A(l.url).split("?")[0]||"",y=o.extract(l.url),E=o.parse(y,{sort:!1}),u=Object.assign(E,l.query);let b=o.stringify(u,w);b&&(b=`?${b}`);let H=j(l.url);return l.fragmentIdentifier&&(H=`#${w[p]?I(l.fragmentIdentifier,w):l.fragmentIdentifier}`),`${g}${b}${H}`},o.pick=(l,w,g)=>{g=Object.assign({parseFragmentIdentifier:!0,[p]:!1},g);const{url:y,query:E,fragmentIdentifier:u}=o.parseUrl(l,g);return o.stringifyUrl({url:y,query:a(E,w),fragmentIdentifier:u},g)},o.exclude=(l,w,g)=>{const y=Array.isArray(w)?E=>!w.includes(E):(E,u)=>!w(E,u);return o.pick(l,y,g)}}(Yo)),Yo}xS();function Zo(o=[],t=[]){return[...new Set([...o,...t])]}function xa(o){return o.includes(":")}function es(o){return xa(o)?o.split(":")[0]:o}const $S={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function xl(o,t){const{message:i,code:n}=$S[o];return{message:t?`${i} ${t}`:i,code:n}}function $l(o,t){return!!Array.isArray(o)}function US(o){return Object.getPrototypeOf(o)===Object.prototype&&Object.keys(o).length}class Zr extends Bl{constructor(t){super(t),this.events=new nr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}off(t,i){this.events.off(t,i)}removeListener(t,i){this.events.removeListener(t,i)}async request(t,i){return this.requestStrict(Ji(t.method,t.params||[],t.id||cs().toString()),i)}async requestStrict(t,i){return new Promise(async(n,a)=>{if(!this.connection.connected)try{await this.open()}catch(h){a(h)}this.events.on(`${t.id}`,h=>{tr(h)?a(h.error):n(h.result)});try{await this.connection.send(t,i)}catch(h){a(h)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Yi(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Ul="error",DS="wss://relay.walletconnect.com",jS="wc",LS="universal_provider",Dl=`${jS}@2:${LS}:`,qS="https://rpc.walletconnect.com/v1",Ur={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Wi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof hr<"u"?hr:typeof self<"u"?self:{},ua={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(o,t){(function(){var i,n="4.17.21",a=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",d="Invalid `variable` option passed into `_.template`",v="__lodash_hash_undefined__",S=500,I="__lodash_placeholder__",R=1,x=2,A=4,j=1,z=2,F=1,V=2,l=4,w=8,g=16,y=32,E=64,u=128,b=256,H=512,J=30,ne="...",he=800,le=16,re=1,U=2,P=3,$=1/0,K=9007199254740991,ae=17976931348623157e292,te=NaN,ce=4294967295,ue=ce-1,B=ce>>>1,Y=[["ary",u],["bind",F],["bindKey",V],["curry",w],["curryRight",g],["flip",H],["partial",y],["partialRight",E],["rearg",b]],Z="[object Arguments]",ye="[object Array]",Ie="[object AsyncFunction]",be="[object Boolean]",Se="[object Date]",Ce="[object DOMException]",Oe="[object Error]",Ne="[object Function]",xe="[object GeneratorFunction]",ot="[object Map]",qt="[object Number]",Dr="[object Null]",It="[object Object]",Xr="[object Promise]",rn="[object Proxy]",ke="[object RegExp]",Te="[object Set]",He="[object String]",Ge="[object Symbol]",ut="[object Undefined]",Ve="[object WeakMap]",ht="[object WeakSet]",Be="[object ArrayBuffer]",Fe="[object DataView]",Ze="[object Float32Array]",Xe="[object Float64Array]",et="[object Int8Array]",tt="[object Int16Array]",rt="[object Int32Array]",it="[object Uint8Array]",nt="[object Uint8ClampedArray]",ps="[object Uint16Array]",gs="[object Uint32Array]",zf=/\b__p \+= '';/g,kf=/\b(__p \+=) '' \+/g,Hf=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ua=/&(?:amp|lt|gt|quot|#39);/g,Da=/[&<>"']/g,Vf=RegExp(Ua.source),Bf=RegExp(Da.source),Kf=/<%-([\s\S]+?)%>/g,Wf=/<%([\s\S]+?)%>/g,ja=/<%=([\s\S]+?)%>/g,Gf=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Qf=/^\w*$/,Jf=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ys=/[\\^$.*+?()[\]{}|]/g,Yf=RegExp(ys.source),ms=/^\s+/,Zf=/\s/,Xf=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ed=/\{\n\/\* \[wrapped with (.+)\] \*/,td=/,? & /,rd=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,id=/[()=,{}\[\]\/\s]/,nd=/\\(\\)?/g,sd=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,La=/\w*$/,od=/^[-+]0x[0-9a-f]+$/i,ad=/^0b[01]+$/i,cd=/^\[object .+?Constructor\]$/,ud=/^0o[0-7]+$/i,hd=/^(?:0|[1-9]\d*)$/,ld=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,nn=/($^)/,fd=/['\n\r\u2028\u2029\\]/g,sn="\\ud800-\\udfff",dd="\\u0300-\\u036f",pd="\\ufe20-\\ufe2f",gd="\\u20d0-\\u20ff",qa=dd+pd+gd,Ma="\\u2700-\\u27bf",Fa="a-z\\xdf-\\xf6\\xf8-\\xff",yd="\\xac\\xb1\\xd7\\xf7",md="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",vd="\\u2000-\\u206f",wd=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",za="A-Z\\xc0-\\xd6\\xd8-\\xde",ka="\\ufe0e\\ufe0f",Ha=yd+md+vd+wd,vs="['’]",_d="["+sn+"]",Va="["+Ha+"]",on="["+qa+"]",Ba="\\d+",bd="["+Ma+"]",Ka="["+Fa+"]",Wa="[^"+sn+Ha+Ba+Ma+Fa+za+"]",ws="\\ud83c[\\udffb-\\udfff]",Ed="(?:"+on+"|"+ws+")",Ga="[^"+sn+"]",_s="(?:\\ud83c[\\udde6-\\uddff]){2}",bs="[\\ud800-\\udbff][\\udc00-\\udfff]",ei="["+za+"]",Qa="\\u200d",Ja="(?:"+Ka+"|"+Wa+")",Sd="(?:"+ei+"|"+Wa+")",Ya="(?:"+vs+"(?:d|ll|m|re|s|t|ve))?",Za="(?:"+vs+"(?:D|LL|M|RE|S|T|VE))?",Xa=Ed+"?",ec="["+ka+"]?",Id="(?:"+Qa+"(?:"+[Ga,_s,bs].join("|")+")"+ec+Xa+")*",Od="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Pd="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",tc=ec+Xa+Id,Nd="(?:"+[bd,_s,bs].join("|")+")"+tc,Ad="(?:"+[Ga+on+"?",on,_s,bs,_d].join("|")+")",Cd=RegExp(vs,"g"),Rd=RegExp(on,"g"),Es=RegExp(ws+"(?="+ws+")|"+Ad+tc,"g"),Td=RegExp([ei+"?"+Ka+"+"+Ya+"(?="+[Va,ei,"$"].join("|")+")",Sd+"+"+Za+"(?="+[Va,ei+Ja,"$"].join("|")+")",ei+"?"+Ja+"+"+Ya,ei+"+"+Za,Pd,Od,Ba,Nd].join("|"),"g"),xd=RegExp("["+Qa+sn+qa+ka+"]"),$d=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ud=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Dd=-1,qe={};qe[Ze]=qe[Xe]=qe[et]=qe[tt]=qe[rt]=qe[it]=qe[nt]=qe[ps]=qe[gs]=!0,qe[Z]=qe[ye]=qe[Be]=qe[be]=qe[Fe]=qe[Se]=qe[Oe]=qe[Ne]=qe[ot]=qe[qt]=qe[It]=qe[ke]=qe[Te]=qe[He]=qe[Ve]=!1;var Le={};Le[Z]=Le[ye]=Le[Be]=Le[Fe]=Le[be]=Le[Se]=Le[Ze]=Le[Xe]=Le[et]=Le[tt]=Le[rt]=Le[ot]=Le[qt]=Le[It]=Le[ke]=Le[Te]=Le[He]=Le[Ge]=Le[it]=Le[nt]=Le[ps]=Le[gs]=!0,Le[Oe]=Le[Ne]=Le[Ve]=!1;var jd={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Ld={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},qd={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Md={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Fd=parseFloat,zd=parseInt,rc=typeof Wi=="object"&&Wi&&Wi.Object===Object&&Wi,kd=typeof self=="object"&&self&&self.Object===Object&&self,pt=rc||kd||Function("return this")(),Ss=t&&!t.nodeType&&t,jr=Ss&&!0&&o&&!o.nodeType&&o,ic=jr&&jr.exports===Ss,Is=ic&&rc.process,Mt=function(){try{var C=jr&&jr.require&&jr.require("util").types;return C||Is&&Is.binding&&Is.binding("util")}catch{}}(),nc=Mt&&Mt.isArrayBuffer,sc=Mt&&Mt.isDate,oc=Mt&&Mt.isMap,ac=Mt&&Mt.isRegExp,cc=Mt&&Mt.isSet,uc=Mt&&Mt.isTypedArray;function Rt(C,L,D){switch(D.length){case 0:return C.call(L);case 1:return C.call(L,D[0]);case 2:return C.call(L,D[0],D[1]);case 3:return C.call(L,D[0],D[1],D[2])}return C.apply(L,D)}function Hd(C,L,D,Q){for(var fe=-1,Pe=C==null?0:C.length;++fe<Pe;){var at=C[fe];L(Q,at,D(at),C)}return Q}function Ft(C,L){for(var D=-1,Q=C==null?0:C.length;++D<Q&&L(C[D],D,C)!==!1;);return C}function Vd(C,L){for(var D=C==null?0:C.length;D--&&L(C[D],D,C)!==!1;);return C}function hc(C,L){for(var D=-1,Q=C==null?0:C.length;++D<Q;)if(!L(C[D],D,C))return!1;return!0}function br(C,L){for(var D=-1,Q=C==null?0:C.length,fe=0,Pe=[];++D<Q;){var at=C[D];L(at,D,C)&&(Pe[fe++]=at)}return Pe}function an(C,L){var D=C==null?0:C.length;return!!D&&ti(C,L,0)>-1}function Os(C,L,D){for(var Q=-1,fe=C==null?0:C.length;++Q<fe;)if(D(L,C[Q]))return!0;return!1}function Me(C,L){for(var D=-1,Q=C==null?0:C.length,fe=Array(Q);++D<Q;)fe[D]=L(C[D],D,C);return fe}function Er(C,L){for(var D=-1,Q=L.length,fe=C.length;++D<Q;)C[fe+D]=L[D];return C}function Ps(C,L,D,Q){var fe=-1,Pe=C==null?0:C.length;for(Q&&Pe&&(D=C[++fe]);++fe<Pe;)D=L(D,C[fe],fe,C);return D}function Bd(C,L,D,Q){var fe=C==null?0:C.length;for(Q&&fe&&(D=C[--fe]);fe--;)D=L(D,C[fe],fe,C);return D}function Ns(C,L){for(var D=-1,Q=C==null?0:C.length;++D<Q;)if(L(C[D],D,C))return!0;return!1}var Kd=As("length");function Wd(C){return C.split("")}function Gd(C){return C.match(rd)||[]}function lc(C,L,D){var Q;return D(C,function(fe,Pe,at){if(L(fe,Pe,at))return Q=Pe,!1}),Q}function cn(C,L,D,Q){for(var fe=C.length,Pe=D+(Q?1:-1);Q?Pe--:++Pe<fe;)if(L(C[Pe],Pe,C))return Pe;return-1}function ti(C,L,D){return L===L?op(C,L,D):cn(C,fc,D)}function Qd(C,L,D,Q){for(var fe=D-1,Pe=C.length;++fe<Pe;)if(Q(C[fe],L))return fe;return-1}function fc(C){return C!==C}function dc(C,L){var D=C==null?0:C.length;return D?Rs(C,L)/D:te}function As(C){return function(L){return L==null?i:L[C]}}function Cs(C){return function(L){return C==null?i:C[L]}}function pc(C,L,D,Q,fe){return fe(C,function(Pe,at,$e){D=Q?(Q=!1,Pe):L(D,Pe,at,$e)}),D}function Jd(C,L){var D=C.length;for(C.sort(L);D--;)C[D]=C[D].value;return C}function Rs(C,L){for(var D,Q=-1,fe=C.length;++Q<fe;){var Pe=L(C[Q]);Pe!==i&&(D=D===i?Pe:D+Pe)}return D}function Ts(C,L){for(var D=-1,Q=Array(C);++D<C;)Q[D]=L(D);return Q}function Yd(C,L){return Me(L,function(D){return[D,C[D]]})}function gc(C){return C&&C.slice(0,wc(C)+1).replace(ms,"")}function Tt(C){return function(L){return C(L)}}function xs(C,L){return Me(L,function(D){return C[D]})}function vi(C,L){return C.has(L)}function yc(C,L){for(var D=-1,Q=C.length;++D<Q&&ti(L,C[D],0)>-1;);return D}function mc(C,L){for(var D=C.length;D--&&ti(L,C[D],0)>-1;);return D}function Zd(C,L){for(var D=C.length,Q=0;D--;)C[D]===L&&++Q;return Q}var Xd=Cs(jd),ep=Cs(Ld);function tp(C){return"\\"+Md[C]}function rp(C,L){return C==null?i:C[L]}function ri(C){return xd.test(C)}function ip(C){return $d.test(C)}function np(C){for(var L,D=[];!(L=C.next()).done;)D.push(L.value);return D}function $s(C){var L=-1,D=Array(C.size);return C.forEach(function(Q,fe){D[++L]=[fe,Q]}),D}function vc(C,L){return function(D){return C(L(D))}}function Sr(C,L){for(var D=-1,Q=C.length,fe=0,Pe=[];++D<Q;){var at=C[D];(at===L||at===I)&&(C[D]=I,Pe[fe++]=D)}return Pe}function un(C){var L=-1,D=Array(C.size);return C.forEach(function(Q){D[++L]=Q}),D}function sp(C){var L=-1,D=Array(C.size);return C.forEach(function(Q){D[++L]=[Q,Q]}),D}function op(C,L,D){for(var Q=D-1,fe=C.length;++Q<fe;)if(C[Q]===L)return Q;return-1}function ap(C,L,D){for(var Q=D+1;Q--;)if(C[Q]===L)return Q;return Q}function ii(C){return ri(C)?up(C):Kd(C)}function Yt(C){return ri(C)?hp(C):Wd(C)}function wc(C){for(var L=C.length;L--&&Zf.test(C.charAt(L)););return L}var cp=Cs(qd);function up(C){for(var L=Es.lastIndex=0;Es.test(C);)++L;return L}function hp(C){return C.match(Es)||[]}function lp(C){return C.match(Td)||[]}var fp=function C(L){L=L==null?pt:ni.defaults(pt.Object(),L,ni.pick(pt,Ud));var D=L.Array,Q=L.Date,fe=L.Error,Pe=L.Function,at=L.Math,$e=L.Object,Us=L.RegExp,dp=L.String,zt=L.TypeError,hn=D.prototype,pp=Pe.prototype,si=$e.prototype,ln=L["__core-js_shared__"],fn=pp.toString,Re=si.hasOwnProperty,gp=0,_c=function(){var e=/[^.]+$/.exec(ln&&ln.keys&&ln.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),dn=si.toString,yp=fn.call($e),mp=pt._,vp=Us("^"+fn.call(Re).replace(ys,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pn=ic?L.Buffer:i,Ir=L.Symbol,gn=L.Uint8Array,bc=pn?pn.allocUnsafe:i,yn=vc($e.getPrototypeOf,$e),Ec=$e.create,Sc=si.propertyIsEnumerable,mn=hn.splice,Ic=Ir?Ir.isConcatSpreadable:i,wi=Ir?Ir.iterator:i,Lr=Ir?Ir.toStringTag:i,vn=function(){try{var e=kr($e,"defineProperty");return e({},"",{}),e}catch{}}(),wp=L.clearTimeout!==pt.clearTimeout&&L.clearTimeout,_p=Q&&Q.now!==pt.Date.now&&Q.now,bp=L.setTimeout!==pt.setTimeout&&L.setTimeout,wn=at.ceil,_n=at.floor,Ds=$e.getOwnPropertySymbols,Ep=pn?pn.isBuffer:i,Oc=L.isFinite,Sp=hn.join,Ip=vc($e.keys,$e),ct=at.max,mt=at.min,Op=Q.now,Pp=L.parseInt,Pc=at.random,Np=hn.reverse,js=kr(L,"DataView"),_i=kr(L,"Map"),Ls=kr(L,"Promise"),oi=kr(L,"Set"),bi=kr(L,"WeakMap"),Ei=kr($e,"create"),bn=bi&&new bi,ai={},Ap=Hr(js),Cp=Hr(_i),Rp=Hr(Ls),Tp=Hr(oi),xp=Hr(bi),En=Ir?Ir.prototype:i,Si=En?En.valueOf:i,Nc=En?En.toString:i;function m(e){if(Ke(e)&&!de(e)&&!(e instanceof _e)){if(e instanceof kt)return e;if(Re.call(e,"__wrapped__"))return Au(e)}return new kt(e)}var ci=function(){function e(){}return function(r){if(!ze(r))return{};if(Ec)return Ec(r);e.prototype=r;var s=new e;return e.prototype=i,s}}();function Sn(){}function kt(e,r){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=i}m.templateSettings={escape:Kf,evaluate:Wf,interpolate:ja,variable:"",imports:{_:m}},m.prototype=Sn.prototype,m.prototype.constructor=m,kt.prototype=ci(Sn.prototype),kt.prototype.constructor=kt;function _e(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ce,this.__views__=[]}function $p(){var e=new _e(this.__wrapped__);return e.__actions__=Ot(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ot(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ot(this.__views__),e}function Up(){if(this.__filtered__){var e=new _e(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Dp(){var e=this.__wrapped__.value(),r=this.__dir__,s=de(e),c=r<0,f=s?e.length:0,_=Wg(0,f,this.__views__),O=_.start,N=_.end,T=N-O,q=c?N:O-1,M=this.__iteratees__,k=M.length,W=0,X=mt(T,this.__takeCount__);if(!s||!c&&f==T&&X==T)return Yc(e,this.__actions__);var se=[];e:for(;T--&&W<X;){q+=r;for(var ge=-1,oe=e[q];++ge<k;){var we=M[ge],Ee=we.iteratee,Ut=we.type,bt=Ee(oe);if(Ut==U)oe=bt;else if(!bt){if(Ut==re)continue e;break e}}se[W++]=oe}return se}_e.prototype=ci(Sn.prototype),_e.prototype.constructor=_e;function qr(e){var r=-1,s=e==null?0:e.length;for(this.clear();++r<s;){var c=e[r];this.set(c[0],c[1])}}function jp(){this.__data__=Ei?Ei(null):{},this.size=0}function Lp(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}function qp(e){var r=this.__data__;if(Ei){var s=r[e];return s===v?i:s}return Re.call(r,e)?r[e]:i}function Mp(e){var r=this.__data__;return Ei?r[e]!==i:Re.call(r,e)}function Fp(e,r){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Ei&&r===i?v:r,this}qr.prototype.clear=jp,qr.prototype.delete=Lp,qr.prototype.get=qp,qr.prototype.has=Mp,qr.prototype.set=Fp;function lr(e){var r=-1,s=e==null?0:e.length;for(this.clear();++r<s;){var c=e[r];this.set(c[0],c[1])}}function zp(){this.__data__=[],this.size=0}function kp(e){var r=this.__data__,s=In(r,e);if(s<0)return!1;var c=r.length-1;return s==c?r.pop():mn.call(r,s,1),--this.size,!0}function Hp(e){var r=this.__data__,s=In(r,e);return s<0?i:r[s][1]}function Vp(e){return In(this.__data__,e)>-1}function Bp(e,r){var s=this.__data__,c=In(s,e);return c<0?(++this.size,s.push([e,r])):s[c][1]=r,this}lr.prototype.clear=zp,lr.prototype.delete=kp,lr.prototype.get=Hp,lr.prototype.has=Vp,lr.prototype.set=Bp;function fr(e){var r=-1,s=e==null?0:e.length;for(this.clear();++r<s;){var c=e[r];this.set(c[0],c[1])}}function Kp(){this.size=0,this.__data__={hash:new qr,map:new(_i||lr),string:new qr}}function Wp(e){var r=jn(this,e).delete(e);return this.size-=r?1:0,r}function Gp(e){return jn(this,e).get(e)}function Qp(e){return jn(this,e).has(e)}function Jp(e,r){var s=jn(this,e),c=s.size;return s.set(e,r),this.size+=s.size==c?0:1,this}fr.prototype.clear=Kp,fr.prototype.delete=Wp,fr.prototype.get=Gp,fr.prototype.has=Qp,fr.prototype.set=Jp;function Mr(e){var r=-1,s=e==null?0:e.length;for(this.__data__=new fr;++r<s;)this.add(e[r])}function Yp(e){return this.__data__.set(e,v),this}function Zp(e){return this.__data__.has(e)}Mr.prototype.add=Mr.prototype.push=Yp,Mr.prototype.has=Zp;function Zt(e){var r=this.__data__=new lr(e);this.size=r.size}function Xp(){this.__data__=new lr,this.size=0}function eg(e){var r=this.__data__,s=r.delete(e);return this.size=r.size,s}function tg(e){return this.__data__.get(e)}function rg(e){return this.__data__.has(e)}function ig(e,r){var s=this.__data__;if(s instanceof lr){var c=s.__data__;if(!_i||c.length<a-1)return c.push([e,r]),this.size=++s.size,this;s=this.__data__=new fr(c)}return s.set(e,r),this.size=s.size,this}Zt.prototype.clear=Xp,Zt.prototype.delete=eg,Zt.prototype.get=tg,Zt.prototype.has=rg,Zt.prototype.set=ig;function Ac(e,r){var s=de(e),c=!s&&Vr(e),f=!s&&!c&&Cr(e),_=!s&&!c&&!f&&fi(e),O=s||c||f||_,N=O?Ts(e.length,dp):[],T=N.length;for(var q in e)(r||Re.call(e,q))&&!(O&&(q=="length"||f&&(q=="offset"||q=="parent")||_&&(q=="buffer"||q=="byteLength"||q=="byteOffset")||yr(q,T)))&&N.push(q);return N}function Cc(e){var r=e.length;return r?e[Gs(0,r-1)]:i}function ng(e,r){return Ln(Ot(e),Fr(r,0,e.length))}function sg(e){return Ln(Ot(e))}function qs(e,r,s){(s!==i&&!Xt(e[r],s)||s===i&&!(r in e))&&dr(e,r,s)}function Ii(e,r,s){var c=e[r];(!(Re.call(e,r)&&Xt(c,s))||s===i&&!(r in e))&&dr(e,r,s)}function In(e,r){for(var s=e.length;s--;)if(Xt(e[s][0],r))return s;return-1}function og(e,r,s,c){return Or(e,function(f,_,O){r(c,f,s(f),O)}),c}function Rc(e,r){return e&&or(r,lt(r),e)}function ag(e,r){return e&&or(r,Nt(r),e)}function dr(e,r,s){r=="__proto__"&&vn?vn(e,r,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[r]=s}function Ms(e,r){for(var s=-1,c=r.length,f=D(c),_=e==null;++s<c;)f[s]=_?i:_o(e,r[s]);return f}function Fr(e,r,s){return e===e&&(s!==i&&(e=e<=s?e:s),r!==i&&(e=e>=r?e:r)),e}function Ht(e,r,s,c,f,_){var O,N=r&R,T=r&x,q=r&A;if(s&&(O=f?s(e,c,f,_):s(e)),O!==i)return O;if(!ze(e))return e;var M=de(e);if(M){if(O=Qg(e),!N)return Ot(e,O)}else{var k=vt(e),W=k==Ne||k==xe;if(Cr(e))return eu(e,N);if(k==It||k==Z||W&&!f){if(O=T||W?{}:wu(e),!N)return T?qg(e,ag(O,e)):Lg(e,Rc(O,e))}else{if(!Le[k])return f?e:{};O=Jg(e,k,N)}}_||(_=new Zt);var X=_.get(e);if(X)return X;_.set(e,O),Gu(e)?e.forEach(function(oe){O.add(Ht(oe,r,s,oe,e,_))}):Ku(e)&&e.forEach(function(oe,we){O.set(we,Ht(oe,r,s,we,e,_))});var se=q?T?so:no:T?Nt:lt,ge=M?i:se(e);return Ft(ge||e,function(oe,we){ge&&(we=oe,oe=e[we]),Ii(O,we,Ht(oe,r,s,we,e,_))}),O}function cg(e){var r=lt(e);return function(s){return Tc(s,e,r)}}function Tc(e,r,s){var c=s.length;if(e==null)return!c;for(e=$e(e);c--;){var f=s[c],_=r[f],O=e[f];if(O===i&&!(f in e)||!_(O))return!1}return!0}function xc(e,r,s){if(typeof e!="function")throw new zt(p);return Ti(function(){e.apply(i,s)},r)}function Oi(e,r,s,c){var f=-1,_=an,O=!0,N=e.length,T=[],q=r.length;if(!N)return T;s&&(r=Me(r,Tt(s))),c?(_=Os,O=!1):r.length>=a&&(_=vi,O=!1,r=new Mr(r));e:for(;++f<N;){var M=e[f],k=s==null?M:s(M);if(M=c||M!==0?M:0,O&&k===k){for(var W=q;W--;)if(r[W]===k)continue e;T.push(M)}else _(r,k,c)||T.push(M)}return T}var Or=su(sr),$c=su(zs,!0);function ug(e,r){var s=!0;return Or(e,function(c,f,_){return s=!!r(c,f,_),s}),s}function On(e,r,s){for(var c=-1,f=e.length;++c<f;){var _=e[c],O=r(_);if(O!=null&&(N===i?O===O&&!$t(O):s(O,N)))var N=O,T=_}return T}function hg(e,r,s,c){var f=e.length;for(s=pe(s),s<0&&(s=-s>f?0:f+s),c=c===i||c>f?f:pe(c),c<0&&(c+=f),c=s>c?0:Ju(c);s<c;)e[s++]=r;return e}function Uc(e,r){var s=[];return Or(e,function(c,f,_){r(c,f,_)&&s.push(c)}),s}function gt(e,r,s,c,f){var _=-1,O=e.length;for(s||(s=Zg),f||(f=[]);++_<O;){var N=e[_];r>0&&s(N)?r>1?gt(N,r-1,s,c,f):Er(f,N):c||(f[f.length]=N)}return f}var Fs=ou(),Dc=ou(!0);function sr(e,r){return e&&Fs(e,r,lt)}function zs(e,r){return e&&Dc(e,r,lt)}function Pn(e,r){return br(r,function(s){return mr(e[s])})}function zr(e,r){r=Nr(r,e);for(var s=0,c=r.length;e!=null&&s<c;)e=e[ar(r[s++])];return s&&s==c?e:i}function jc(e,r,s){var c=r(e);return de(e)?c:Er(c,s(e))}function wt(e){return e==null?e===i?ut:Dr:Lr&&Lr in $e(e)?Kg(e):sy(e)}function ks(e,r){return e>r}function lg(e,r){return e!=null&&Re.call(e,r)}function fg(e,r){return e!=null&&r in $e(e)}function dg(e,r,s){return e>=mt(r,s)&&e<ct(r,s)}function Hs(e,r,s){for(var c=s?Os:an,f=e[0].length,_=e.length,O=_,N=D(_),T=1/0,q=[];O--;){var M=e[O];O&&r&&(M=Me(M,Tt(r))),T=mt(M.length,T),N[O]=!s&&(r||f>=120&&M.length>=120)?new Mr(O&&M):i}M=e[0];var k=-1,W=N[0];e:for(;++k<f&&q.length<T;){var X=M[k],se=r?r(X):X;if(X=s||X!==0?X:0,!(W?vi(W,se):c(q,se,s))){for(O=_;--O;){var ge=N[O];if(!(ge?vi(ge,se):c(e[O],se,s)))continue e}W&&W.push(se),q.push(X)}}return q}function pg(e,r,s,c){return sr(e,function(f,_,O){r(c,s(f),_,O)}),c}function Pi(e,r,s){r=Nr(r,e),e=Su(e,r);var c=e==null?e:e[ar(Bt(r))];return c==null?i:Rt(c,e,s)}function Lc(e){return Ke(e)&&wt(e)==Z}function gg(e){return Ke(e)&&wt(e)==Be}function yg(e){return Ke(e)&&wt(e)==Se}function Ni(e,r,s,c,f){return e===r?!0:e==null||r==null||!Ke(e)&&!Ke(r)?e!==e&&r!==r:mg(e,r,s,c,Ni,f)}function mg(e,r,s,c,f,_){var O=de(e),N=de(r),T=O?ye:vt(e),q=N?ye:vt(r);T=T==Z?It:T,q=q==Z?It:q;var M=T==It,k=q==It,W=T==q;if(W&&Cr(e)){if(!Cr(r))return!1;O=!0,M=!1}if(W&&!M)return _||(_=new Zt),O||fi(e)?yu(e,r,s,c,f,_):Vg(e,r,T,s,c,f,_);if(!(s&j)){var X=M&&Re.call(e,"__wrapped__"),se=k&&Re.call(r,"__wrapped__");if(X||se){var ge=X?e.value():e,oe=se?r.value():r;return _||(_=new Zt),f(ge,oe,s,c,_)}}return W?(_||(_=new Zt),Bg(e,r,s,c,f,_)):!1}function vg(e){return Ke(e)&&vt(e)==ot}function Vs(e,r,s,c){var f=s.length,_=f,O=!c;if(e==null)return!_;for(e=$e(e);f--;){var N=s[f];if(O&&N[2]?N[1]!==e[N[0]]:!(N[0]in e))return!1}for(;++f<_;){N=s[f];var T=N[0],q=e[T],M=N[1];if(O&&N[2]){if(q===i&&!(T in e))return!1}else{var k=new Zt;if(c)var W=c(q,M,T,e,r,k);if(!(W===i?Ni(M,q,j|z,c,k):W))return!1}}return!0}function qc(e){if(!ze(e)||ey(e))return!1;var r=mr(e)?vp:cd;return r.test(Hr(e))}function wg(e){return Ke(e)&&wt(e)==ke}function _g(e){return Ke(e)&&vt(e)==Te}function bg(e){return Ke(e)&&Hn(e.length)&&!!qe[wt(e)]}function Mc(e){return typeof e=="function"?e:e==null?At:typeof e=="object"?de(e)?kc(e[0],e[1]):zc(e):ah(e)}function Bs(e){if(!Ri(e))return Ip(e);var r=[];for(var s in $e(e))Re.call(e,s)&&s!="constructor"&&r.push(s);return r}function Eg(e){if(!ze(e))return ny(e);var r=Ri(e),s=[];for(var c in e)c=="constructor"&&(r||!Re.call(e,c))||s.push(c);return s}function Ks(e,r){return e<r}function Fc(e,r){var s=-1,c=Pt(e)?D(e.length):[];return Or(e,function(f,_,O){c[++s]=r(f,_,O)}),c}function zc(e){var r=ao(e);return r.length==1&&r[0][2]?bu(r[0][0],r[0][1]):function(s){return s===e||Vs(s,e,r)}}function kc(e,r){return uo(e)&&_u(r)?bu(ar(e),r):function(s){var c=_o(s,e);return c===i&&c===r?bo(s,e):Ni(r,c,j|z)}}function Nn(e,r,s,c,f){e!==r&&Fs(r,function(_,O){if(f||(f=new Zt),ze(_))Sg(e,r,O,s,Nn,c,f);else{var N=c?c(lo(e,O),_,O+"",e,r,f):i;N===i&&(N=_),qs(e,O,N)}},Nt)}function Sg(e,r,s,c,f,_,O){var N=lo(e,s),T=lo(r,s),q=O.get(T);if(q){qs(e,s,q);return}var M=_?_(N,T,s+"",e,r,O):i,k=M===i;if(k){var W=de(T),X=!W&&Cr(T),se=!W&&!X&&fi(T);M=T,W||X||se?de(N)?M=N:Qe(N)?M=Ot(N):X?(k=!1,M=eu(T,!0)):se?(k=!1,M=tu(T,!0)):M=[]:xi(T)||Vr(T)?(M=N,Vr(N)?M=Yu(N):(!ze(N)||mr(N))&&(M=wu(T))):k=!1}k&&(O.set(T,M),f(M,T,c,_,O),O.delete(T)),qs(e,s,M)}function Hc(e,r){var s=e.length;if(s)return r+=r<0?s:0,yr(r,s)?e[r]:i}function Vc(e,r,s){r.length?r=Me(r,function(_){return de(_)?function(O){return zr(O,_.length===1?_[0]:_)}:_}):r=[At];var c=-1;r=Me(r,Tt(ie()));var f=Fc(e,function(_,O,N){var T=Me(r,function(q){return q(_)});return{criteria:T,index:++c,value:_}});return Jd(f,function(_,O){return jg(_,O,s)})}function Ig(e,r){return Bc(e,r,function(s,c){return bo(e,c)})}function Bc(e,r,s){for(var c=-1,f=r.length,_={};++c<f;){var O=r[c],N=zr(e,O);s(N,O)&&Ai(_,Nr(O,e),N)}return _}function Og(e){return function(r){return zr(r,e)}}function Ws(e,r,s,c){var f=c?Qd:ti,_=-1,O=r.length,N=e;for(e===r&&(r=Ot(r)),s&&(N=Me(e,Tt(s)));++_<O;)for(var T=0,q=r[_],M=s?s(q):q;(T=f(N,M,T,c))>-1;)N!==e&&mn.call(N,T,1),mn.call(e,T,1);return e}function Kc(e,r){for(var s=e?r.length:0,c=s-1;s--;){var f=r[s];if(s==c||f!==_){var _=f;yr(f)?mn.call(e,f,1):Ys(e,f)}}return e}function Gs(e,r){return e+_n(Pc()*(r-e+1))}function Pg(e,r,s,c){for(var f=-1,_=ct(wn((r-e)/(s||1)),0),O=D(_);_--;)O[c?_:++f]=e,e+=s;return O}function Qs(e,r){var s="";if(!e||r<1||r>K)return s;do r%2&&(s+=e),r=_n(r/2),r&&(e+=e);while(r);return s}function me(e,r){return fo(Eu(e,r,At),e+"")}function Ng(e){return Cc(di(e))}function Ag(e,r){var s=di(e);return Ln(s,Fr(r,0,s.length))}function Ai(e,r,s,c){if(!ze(e))return e;r=Nr(r,e);for(var f=-1,_=r.length,O=_-1,N=e;N!=null&&++f<_;){var T=ar(r[f]),q=s;if(T==="__proto__"||T==="constructor"||T==="prototype")return e;if(f!=O){var M=N[T];q=c?c(M,T,N):i,q===i&&(q=ze(M)?M:yr(r[f+1])?[]:{})}Ii(N,T,q),N=N[T]}return e}var Wc=bn?function(e,r){return bn.set(e,r),e}:At,Cg=vn?function(e,r){return vn(e,"toString",{configurable:!0,enumerable:!1,value:So(r),writable:!0})}:At;function Rg(e){return Ln(di(e))}function Vt(e,r,s){var c=-1,f=e.length;r<0&&(r=-r>f?0:f+r),s=s>f?f:s,s<0&&(s+=f),f=r>s?0:s-r>>>0,r>>>=0;for(var _=D(f);++c<f;)_[c]=e[c+r];return _}function Tg(e,r){var s;return Or(e,function(c,f,_){return s=r(c,f,_),!s}),!!s}function An(e,r,s){var c=0,f=e==null?c:e.length;if(typeof r=="number"&&r===r&&f<=B){for(;c<f;){var _=c+f>>>1,O=e[_];O!==null&&!$t(O)&&(s?O<=r:O<r)?c=_+1:f=_}return f}return Js(e,r,At,s)}function Js(e,r,s,c){var f=0,_=e==null?0:e.length;if(_===0)return 0;r=s(r);for(var O=r!==r,N=r===null,T=$t(r),q=r===i;f<_;){var M=_n((f+_)/2),k=s(e[M]),W=k!==i,X=k===null,se=k===k,ge=$t(k);if(O)var oe=c||se;else q?oe=se&&(c||W):N?oe=se&&W&&(c||!X):T?oe=se&&W&&!X&&(c||!ge):X||ge?oe=!1:oe=c?k<=r:k<r;oe?f=M+1:_=M}return mt(_,ue)}function Gc(e,r){for(var s=-1,c=e.length,f=0,_=[];++s<c;){var O=e[s],N=r?r(O):O;if(!s||!Xt(N,T)){var T=N;_[f++]=O===0?0:O}}return _}function Qc(e){return typeof e=="number"?e:$t(e)?te:+e}function xt(e){if(typeof e=="string")return e;if(de(e))return Me(e,xt)+"";if($t(e))return Nc?Nc.call(e):"";var r=e+"";return r=="0"&&1/e==-1/0?"-0":r}function Pr(e,r,s){var c=-1,f=an,_=e.length,O=!0,N=[],T=N;if(s)O=!1,f=Os;else if(_>=a){var q=r?null:kg(e);if(q)return un(q);O=!1,f=vi,T=new Mr}else T=r?[]:N;e:for(;++c<_;){var M=e[c],k=r?r(M):M;if(M=s||M!==0?M:0,O&&k===k){for(var W=T.length;W--;)if(T[W]===k)continue e;r&&T.push(k),N.push(M)}else f(T,k,s)||(T!==N&&T.push(k),N.push(M))}return N}function Ys(e,r){return r=Nr(r,e),e=Su(e,r),e==null||delete e[ar(Bt(r))]}function Jc(e,r,s,c){return Ai(e,r,s(zr(e,r)),c)}function Cn(e,r,s,c){for(var f=e.length,_=c?f:-1;(c?_--:++_<f)&&r(e[_],_,e););return s?Vt(e,c?0:_,c?_+1:f):Vt(e,c?_+1:0,c?f:_)}function Yc(e,r){var s=e;return s instanceof _e&&(s=s.value()),Ps(r,function(c,f){return f.func.apply(f.thisArg,Er([c],f.args))},s)}function Zs(e,r,s){var c=e.length;if(c<2)return c?Pr(e[0]):[];for(var f=-1,_=D(c);++f<c;)for(var O=e[f],N=-1;++N<c;)N!=f&&(_[f]=Oi(_[f]||O,e[N],r,s));return Pr(gt(_,1),r,s)}function Zc(e,r,s){for(var c=-1,f=e.length,_=r.length,O={};++c<f;){var N=c<_?r[c]:i;s(O,e[c],N)}return O}function Xs(e){return Qe(e)?e:[]}function eo(e){return typeof e=="function"?e:At}function Nr(e,r){return de(e)?e:uo(e,r)?[e]:Nu(Ae(e))}var xg=me;function Ar(e,r,s){var c=e.length;return s=s===i?c:s,!r&&s>=c?e:Vt(e,r,s)}var Xc=wp||function(e){return pt.clearTimeout(e)};function eu(e,r){if(r)return e.slice();var s=e.length,c=bc?bc(s):new e.constructor(s);return e.copy(c),c}function to(e){var r=new e.constructor(e.byteLength);return new gn(r).set(new gn(e)),r}function $g(e,r){var s=r?to(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function Ug(e){var r=new e.constructor(e.source,La.exec(e));return r.lastIndex=e.lastIndex,r}function Dg(e){return Si?$e(Si.call(e)):{}}function tu(e,r){var s=r?to(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function ru(e,r){if(e!==r){var s=e!==i,c=e===null,f=e===e,_=$t(e),O=r!==i,N=r===null,T=r===r,q=$t(r);if(!N&&!q&&!_&&e>r||_&&O&&T&&!N&&!q||c&&O&&T||!s&&T||!f)return 1;if(!c&&!_&&!q&&e<r||q&&s&&f&&!c&&!_||N&&s&&f||!O&&f||!T)return-1}return 0}function jg(e,r,s){for(var c=-1,f=e.criteria,_=r.criteria,O=f.length,N=s.length;++c<O;){var T=ru(f[c],_[c]);if(T){if(c>=N)return T;var q=s[c];return T*(q=="desc"?-1:1)}}return e.index-r.index}function iu(e,r,s,c){for(var f=-1,_=e.length,O=s.length,N=-1,T=r.length,q=ct(_-O,0),M=D(T+q),k=!c;++N<T;)M[N]=r[N];for(;++f<O;)(k||f<_)&&(M[s[f]]=e[f]);for(;q--;)M[N++]=e[f++];return M}function nu(e,r,s,c){for(var f=-1,_=e.length,O=-1,N=s.length,T=-1,q=r.length,M=ct(_-N,0),k=D(M+q),W=!c;++f<M;)k[f]=e[f];for(var X=f;++T<q;)k[X+T]=r[T];for(;++O<N;)(W||f<_)&&(k[X+s[O]]=e[f++]);return k}function Ot(e,r){var s=-1,c=e.length;for(r||(r=D(c));++s<c;)r[s]=e[s];return r}function or(e,r,s,c){var f=!s;s||(s={});for(var _=-1,O=r.length;++_<O;){var N=r[_],T=c?c(s[N],e[N],N,s,e):i;T===i&&(T=e[N]),f?dr(s,N,T):Ii(s,N,T)}return s}function Lg(e,r){return or(e,co(e),r)}function qg(e,r){return or(e,mu(e),r)}function Rn(e,r){return function(s,c){var f=de(s)?Hd:og,_=r?r():{};return f(s,e,ie(c,2),_)}}function ui(e){return me(function(r,s){var c=-1,f=s.length,_=f>1?s[f-1]:i,O=f>2?s[2]:i;for(_=e.length>3&&typeof _=="function"?(f--,_):i,O&&_t(s[0],s[1],O)&&(_=f<3?i:_,f=1),r=$e(r);++c<f;){var N=s[c];N&&e(r,N,c,_)}return r})}function su(e,r){return function(s,c){if(s==null)return s;if(!Pt(s))return e(s,c);for(var f=s.length,_=r?f:-1,O=$e(s);(r?_--:++_<f)&&c(O[_],_,O)!==!1;);return s}}function ou(e){return function(r,s,c){for(var f=-1,_=$e(r),O=c(r),N=O.length;N--;){var T=O[e?N:++f];if(s(_[T],T,_)===!1)break}return r}}function Mg(e,r,s){var c=r&F,f=Ci(e);function _(){var O=this&&this!==pt&&this instanceof _?f:e;return O.apply(c?s:this,arguments)}return _}function au(e){return function(r){r=Ae(r);var s=ri(r)?Yt(r):i,c=s?s[0]:r.charAt(0),f=s?Ar(s,1).join(""):r.slice(1);return c[e]()+f}}function hi(e){return function(r){return Ps(sh(nh(r).replace(Cd,"")),e,"")}}function Ci(e){return function(){var r=arguments;switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3]);case 5:return new e(r[0],r[1],r[2],r[3],r[4]);case 6:return new e(r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return new e(r[0],r[1],r[2],r[3],r[4],r[5],r[6])}var s=ci(e.prototype),c=e.apply(s,r);return ze(c)?c:s}}function Fg(e,r,s){var c=Ci(e);function f(){for(var _=arguments.length,O=D(_),N=_,T=li(f);N--;)O[N]=arguments[N];var q=_<3&&O[0]!==T&&O[_-1]!==T?[]:Sr(O,T);if(_-=q.length,_<s)return fu(e,r,Tn,f.placeholder,i,O,q,i,i,s-_);var M=this&&this!==pt&&this instanceof f?c:e;return Rt(M,this,O)}return f}function cu(e){return function(r,s,c){var f=$e(r);if(!Pt(r)){var _=ie(s,3);r=lt(r),s=function(N){return _(f[N],N,f)}}var O=e(r,s,c);return O>-1?f[_?r[O]:O]:i}}function uu(e){return gr(function(r){var s=r.length,c=s,f=kt.prototype.thru;for(e&&r.reverse();c--;){var _=r[c];if(typeof _!="function")throw new zt(p);if(f&&!O&&Dn(_)=="wrapper")var O=new kt([],!0)}for(c=O?c:s;++c<s;){_=r[c];var N=Dn(_),T=N=="wrapper"?oo(_):i;T&&ho(T[0])&&T[1]==(u|w|y|b)&&!T[4].length&&T[9]==1?O=O[Dn(T[0])].apply(O,T[3]):O=_.length==1&&ho(_)?O[N]():O.thru(_)}return function(){var q=arguments,M=q[0];if(O&&q.length==1&&de(M))return O.plant(M).value();for(var k=0,W=s?r[k].apply(this,q):M;++k<s;)W=r[k].call(this,W);return W}})}function Tn(e,r,s,c,f,_,O,N,T,q){var M=r&u,k=r&F,W=r&V,X=r&(w|g),se=r&H,ge=W?i:Ci(e);function oe(){for(var we=arguments.length,Ee=D(we),Ut=we;Ut--;)Ee[Ut]=arguments[Ut];if(X)var bt=li(oe),Dt=Zd(Ee,bt);if(c&&(Ee=iu(Ee,c,f,X)),_&&(Ee=nu(Ee,_,O,X)),we-=Dt,X&&we<q){var Je=Sr(Ee,bt);return fu(e,r,Tn,oe.placeholder,s,Ee,Je,N,T,q-we)}var er=k?s:this,wr=W?er[e]:e;return we=Ee.length,N?Ee=oy(Ee,N):se&&we>1&&Ee.reverse(),M&&T<we&&(Ee.length=T),this&&this!==pt&&this instanceof oe&&(wr=ge||Ci(wr)),wr.apply(er,Ee)}return oe}function hu(e,r){return function(s,c){return pg(s,e,r(c),{})}}function xn(e,r){return function(s,c){var f;if(s===i&&c===i)return r;if(s!==i&&(f=s),c!==i){if(f===i)return c;typeof s=="string"||typeof c=="string"?(s=xt(s),c=xt(c)):(s=Qc(s),c=Qc(c)),f=e(s,c)}return f}}function ro(e){return gr(function(r){return r=Me(r,Tt(ie())),me(function(s){var c=this;return e(r,function(f){return Rt(f,c,s)})})})}function $n(e,r){r=r===i?" ":xt(r);var s=r.length;if(s<2)return s?Qs(r,e):r;var c=Qs(r,wn(e/ii(r)));return ri(r)?Ar(Yt(c),0,e).join(""):c.slice(0,e)}function zg(e,r,s,c){var f=r&F,_=Ci(e);function O(){for(var N=-1,T=arguments.length,q=-1,M=c.length,k=D(M+T),W=this&&this!==pt&&this instanceof O?_:e;++q<M;)k[q]=c[q];for(;T--;)k[q++]=arguments[++N];return Rt(W,f?s:this,k)}return O}function lu(e){return function(r,s,c){return c&&typeof c!="number"&&_t(r,s,c)&&(s=c=i),r=vr(r),s===i?(s=r,r=0):s=vr(s),c=c===i?r<s?1:-1:vr(c),Pg(r,s,c,e)}}function Un(e){return function(r,s){return typeof r=="string"&&typeof s=="string"||(r=Kt(r),s=Kt(s)),e(r,s)}}function fu(e,r,s,c,f,_,O,N,T,q){var M=r&w,k=M?O:i,W=M?i:O,X=M?_:i,se=M?i:_;r|=M?y:E,r&=~(M?E:y),r&l||(r&=-4);var ge=[e,r,f,X,k,se,W,N,T,q],oe=s.apply(i,ge);return ho(e)&&Iu(oe,ge),oe.placeholder=c,Ou(oe,e,r)}function io(e){var r=at[e];return function(s,c){if(s=Kt(s),c=c==null?0:mt(pe(c),292),c&&Oc(s)){var f=(Ae(s)+"e").split("e"),_=r(f[0]+"e"+(+f[1]+c));return f=(Ae(_)+"e").split("e"),+(f[0]+"e"+(+f[1]-c))}return r(s)}}var kg=oi&&1/un(new oi([,-0]))[1]==$?function(e){return new oi(e)}:Po;function du(e){return function(r){var s=vt(r);return s==ot?$s(r):s==Te?sp(r):Yd(r,e(r))}}function pr(e,r,s,c,f,_,O,N){var T=r&V;if(!T&&typeof e!="function")throw new zt(p);var q=c?c.length:0;if(q||(r&=-97,c=f=i),O=O===i?O:ct(pe(O),0),N=N===i?N:pe(N),q-=f?f.length:0,r&E){var M=c,k=f;c=f=i}var W=T?i:oo(e),X=[e,r,s,c,f,M,k,_,O,N];if(W&&iy(X,W),e=X[0],r=X[1],s=X[2],c=X[3],f=X[4],N=X[9]=X[9]===i?T?0:e.length:ct(X[9]-q,0),!N&&r&(w|g)&&(r&=-25),!r||r==F)var se=Mg(e,r,s);else r==w||r==g?se=Fg(e,r,N):(r==y||r==(F|y))&&!f.length?se=zg(e,r,s,c):se=Tn.apply(i,X);var ge=W?Wc:Iu;return Ou(ge(se,X),e,r)}function pu(e,r,s,c){return e===i||Xt(e,si[s])&&!Re.call(c,s)?r:e}function gu(e,r,s,c,f,_){return ze(e)&&ze(r)&&(_.set(r,e),Nn(e,r,i,gu,_),_.delete(r)),e}function Hg(e){return xi(e)?i:e}function yu(e,r,s,c,f,_){var O=s&j,N=e.length,T=r.length;if(N!=T&&!(O&&T>N))return!1;var q=_.get(e),M=_.get(r);if(q&&M)return q==r&&M==e;var k=-1,W=!0,X=s&z?new Mr:i;for(_.set(e,r),_.set(r,e);++k<N;){var se=e[k],ge=r[k];if(c)var oe=O?c(ge,se,k,r,e,_):c(se,ge,k,e,r,_);if(oe!==i){if(oe)continue;W=!1;break}if(X){if(!Ns(r,function(we,Ee){if(!vi(X,Ee)&&(se===we||f(se,we,s,c,_)))return X.push(Ee)})){W=!1;break}}else if(!(se===ge||f(se,ge,s,c,_))){W=!1;break}}return _.delete(e),_.delete(r),W}function Vg(e,r,s,c,f,_,O){switch(s){case Fe:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case Be:return!(e.byteLength!=r.byteLength||!_(new gn(e),new gn(r)));case be:case Se:case qt:return Xt(+e,+r);case Oe:return e.name==r.name&&e.message==r.message;case ke:case He:return e==r+"";case ot:var N=$s;case Te:var T=c&j;if(N||(N=un),e.size!=r.size&&!T)return!1;var q=O.get(e);if(q)return q==r;c|=z,O.set(e,r);var M=yu(N(e),N(r),c,f,_,O);return O.delete(e),M;case Ge:if(Si)return Si.call(e)==Si.call(r)}return!1}function Bg(e,r,s,c,f,_){var O=s&j,N=no(e),T=N.length,q=no(r),M=q.length;if(T!=M&&!O)return!1;for(var k=T;k--;){var W=N[k];if(!(O?W in r:Re.call(r,W)))return!1}var X=_.get(e),se=_.get(r);if(X&&se)return X==r&&se==e;var ge=!0;_.set(e,r),_.set(r,e);for(var oe=O;++k<T;){W=N[k];var we=e[W],Ee=r[W];if(c)var Ut=O?c(Ee,we,W,r,e,_):c(we,Ee,W,e,r,_);if(!(Ut===i?we===Ee||f(we,Ee,s,c,_):Ut)){ge=!1;break}oe||(oe=W=="constructor")}if(ge&&!oe){var bt=e.constructor,Dt=r.constructor;bt!=Dt&&"constructor"in e&&"constructor"in r&&!(typeof bt=="function"&&bt instanceof bt&&typeof Dt=="function"&&Dt instanceof Dt)&&(ge=!1)}return _.delete(e),_.delete(r),ge}function gr(e){return fo(Eu(e,i,Tu),e+"")}function no(e){return jc(e,lt,co)}function so(e){return jc(e,Nt,mu)}var oo=bn?function(e){return bn.get(e)}:Po;function Dn(e){for(var r=e.name+"",s=ai[r],c=Re.call(ai,r)?s.length:0;c--;){var f=s[c],_=f.func;if(_==null||_==e)return f.name}return r}function li(e){var r=Re.call(m,"placeholder")?m:e;return r.placeholder}function ie(){var e=m.iteratee||Io;return e=e===Io?Mc:e,arguments.length?e(arguments[0],arguments[1]):e}function jn(e,r){var s=e.__data__;return Xg(r)?s[typeof r=="string"?"string":"hash"]:s.map}function ao(e){for(var r=lt(e),s=r.length;s--;){var c=r[s],f=e[c];r[s]=[c,f,_u(f)]}return r}function kr(e,r){var s=rp(e,r);return qc(s)?s:i}function Kg(e){var r=Re.call(e,Lr),s=e[Lr];try{e[Lr]=i;var c=!0}catch{}var f=dn.call(e);return c&&(r?e[Lr]=s:delete e[Lr]),f}var co=Ds?function(e){return e==null?[]:(e=$e(e),br(Ds(e),function(r){return Sc.call(e,r)}))}:No,mu=Ds?function(e){for(var r=[];e;)Er(r,co(e)),e=yn(e);return r}:No,vt=wt;(js&&vt(new js(new ArrayBuffer(1)))!=Fe||_i&&vt(new _i)!=ot||Ls&&vt(Ls.resolve())!=Xr||oi&&vt(new oi)!=Te||bi&&vt(new bi)!=Ve)&&(vt=function(e){var r=wt(e),s=r==It?e.constructor:i,c=s?Hr(s):"";if(c)switch(c){case Ap:return Fe;case Cp:return ot;case Rp:return Xr;case Tp:return Te;case xp:return Ve}return r});function Wg(e,r,s){for(var c=-1,f=s.length;++c<f;){var _=s[c],O=_.size;switch(_.type){case"drop":e+=O;break;case"dropRight":r-=O;break;case"take":r=mt(r,e+O);break;case"takeRight":e=ct(e,r-O);break}}return{start:e,end:r}}function Gg(e){var r=e.match(ed);return r?r[1].split(td):[]}function vu(e,r,s){r=Nr(r,e);for(var c=-1,f=r.length,_=!1;++c<f;){var O=ar(r[c]);if(!(_=e!=null&&s(e,O)))break;e=e[O]}return _||++c!=f?_:(f=e==null?0:e.length,!!f&&Hn(f)&&yr(O,f)&&(de(e)||Vr(e)))}function Qg(e){var r=e.length,s=new e.constructor(r);return r&&typeof e[0]=="string"&&Re.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function wu(e){return typeof e.constructor=="function"&&!Ri(e)?ci(yn(e)):{}}function Jg(e,r,s){var c=e.constructor;switch(r){case Be:return to(e);case be:case Se:return new c(+e);case Fe:return $g(e,s);case Ze:case Xe:case et:case tt:case rt:case it:case nt:case ps:case gs:return tu(e,s);case ot:return new c;case qt:case He:return new c(e);case ke:return Ug(e);case Te:return new c;case Ge:return Dg(e)}}function Yg(e,r){var s=r.length;if(!s)return e;var c=s-1;return r[c]=(s>1?"& ":"")+r[c],r=r.join(s>2?", ":" "),e.replace(Xf,`{
/* [wrapped with `+r+`] */
`)}function Zg(e){return de(e)||Vr(e)||!!(Ic&&e&&e[Ic])}function yr(e,r){var s=typeof e;return r=r??K,!!r&&(s=="number"||s!="symbol"&&hd.test(e))&&e>-1&&e%1==0&&e<r}function _t(e,r,s){if(!ze(s))return!1;var c=typeof r;return(c=="number"?Pt(s)&&yr(r,s.length):c=="string"&&r in s)?Xt(s[r],e):!1}function uo(e,r){if(de(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||$t(e)?!0:Qf.test(e)||!Gf.test(e)||r!=null&&e in $e(r)}function Xg(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function ho(e){var r=Dn(e),s=m[r];if(typeof s!="function"||!(r in _e.prototype))return!1;if(e===s)return!0;var c=oo(s);return!!c&&e===c[0]}function ey(e){return!!_c&&_c in e}var ty=ln?mr:Ao;function Ri(e){var r=e&&e.constructor,s=typeof r=="function"&&r.prototype||si;return e===s}function _u(e){return e===e&&!ze(e)}function bu(e,r){return function(s){return s==null?!1:s[e]===r&&(r!==i||e in $e(s))}}function ry(e){var r=zn(e,function(c){return s.size===S&&s.clear(),c}),s=r.cache;return r}function iy(e,r){var s=e[1],c=r[1],f=s|c,_=f<(F|V|u),O=c==u&&s==w||c==u&&s==b&&e[7].length<=r[8]||c==(u|b)&&r[7].length<=r[8]&&s==w;if(!(_||O))return e;c&F&&(e[2]=r[2],f|=s&F?0:l);var N=r[3];if(N){var T=e[3];e[3]=T?iu(T,N,r[4]):N,e[4]=T?Sr(e[3],I):r[4]}return N=r[5],N&&(T=e[5],e[5]=T?nu(T,N,r[6]):N,e[6]=T?Sr(e[5],I):r[6]),N=r[7],N&&(e[7]=N),c&u&&(e[8]=e[8]==null?r[8]:mt(e[8],r[8])),e[9]==null&&(e[9]=r[9]),e[0]=r[0],e[1]=f,e}function ny(e){var r=[];if(e!=null)for(var s in $e(e))r.push(s);return r}function sy(e){return dn.call(e)}function Eu(e,r,s){return r=ct(r===i?e.length-1:r,0),function(){for(var c=arguments,f=-1,_=ct(c.length-r,0),O=D(_);++f<_;)O[f]=c[r+f];f=-1;for(var N=D(r+1);++f<r;)N[f]=c[f];return N[r]=s(O),Rt(e,this,N)}}function Su(e,r){return r.length<2?e:zr(e,Vt(r,0,-1))}function oy(e,r){for(var s=e.length,c=mt(r.length,s),f=Ot(e);c--;){var _=r[c];e[c]=yr(_,s)?f[_]:i}return e}function lo(e,r){if(!(r==="constructor"&&typeof e[r]=="function")&&r!="__proto__")return e[r]}var Iu=Pu(Wc),Ti=bp||function(e,r){return pt.setTimeout(e,r)},fo=Pu(Cg);function Ou(e,r,s){var c=r+"";return fo(e,Yg(c,ay(Gg(c),s)))}function Pu(e){var r=0,s=0;return function(){var c=Op(),f=le-(c-s);if(s=c,f>0){if(++r>=he)return arguments[0]}else r=0;return e.apply(i,arguments)}}function Ln(e,r){var s=-1,c=e.length,f=c-1;for(r=r===i?c:r;++s<r;){var _=Gs(s,f),O=e[_];e[_]=e[s],e[s]=O}return e.length=r,e}var Nu=ry(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(Jf,function(s,c,f,_){r.push(f?_.replace(nd,"$1"):c||s)}),r});function ar(e){if(typeof e=="string"||$t(e))return e;var r=e+"";return r=="0"&&1/e==-1/0?"-0":r}function Hr(e){if(e!=null){try{return fn.call(e)}catch{}try{return e+""}catch{}}return""}function ay(e,r){return Ft(Y,function(s){var c="_."+s[0];r&s[1]&&!an(e,c)&&e.push(c)}),e.sort()}function Au(e){if(e instanceof _e)return e.clone();var r=new kt(e.__wrapped__,e.__chain__);return r.__actions__=Ot(e.__actions__),r.__index__=e.__index__,r.__values__=e.__values__,r}function cy(e,r,s){(s?_t(e,r,s):r===i)?r=1:r=ct(pe(r),0);var c=e==null?0:e.length;if(!c||r<1)return[];for(var f=0,_=0,O=D(wn(c/r));f<c;)O[_++]=Vt(e,f,f+=r);return O}function uy(e){for(var r=-1,s=e==null?0:e.length,c=0,f=[];++r<s;){var _=e[r];_&&(f[c++]=_)}return f}function hy(){var e=arguments.length;if(!e)return[];for(var r=D(e-1),s=arguments[0],c=e;c--;)r[c-1]=arguments[c];return Er(de(s)?Ot(s):[s],gt(r,1))}var ly=me(function(e,r){return Qe(e)?Oi(e,gt(r,1,Qe,!0)):[]}),fy=me(function(e,r){var s=Bt(r);return Qe(s)&&(s=i),Qe(e)?Oi(e,gt(r,1,Qe,!0),ie(s,2)):[]}),dy=me(function(e,r){var s=Bt(r);return Qe(s)&&(s=i),Qe(e)?Oi(e,gt(r,1,Qe,!0),i,s):[]});function py(e,r,s){var c=e==null?0:e.length;return c?(r=s||r===i?1:pe(r),Vt(e,r<0?0:r,c)):[]}function gy(e,r,s){var c=e==null?0:e.length;return c?(r=s||r===i?1:pe(r),r=c-r,Vt(e,0,r<0?0:r)):[]}function yy(e,r){return e&&e.length?Cn(e,ie(r,3),!0,!0):[]}function my(e,r){return e&&e.length?Cn(e,ie(r,3),!0):[]}function vy(e,r,s,c){var f=e==null?0:e.length;return f?(s&&typeof s!="number"&&_t(e,r,s)&&(s=0,c=f),hg(e,r,s,c)):[]}function Cu(e,r,s){var c=e==null?0:e.length;if(!c)return-1;var f=s==null?0:pe(s);return f<0&&(f=ct(c+f,0)),cn(e,ie(r,3),f)}function Ru(e,r,s){var c=e==null?0:e.length;if(!c)return-1;var f=c-1;return s!==i&&(f=pe(s),f=s<0?ct(c+f,0):mt(f,c-1)),cn(e,ie(r,3),f,!0)}function Tu(e){var r=e==null?0:e.length;return r?gt(e,1):[]}function wy(e){var r=e==null?0:e.length;return r?gt(e,$):[]}function _y(e,r){var s=e==null?0:e.length;return s?(r=r===i?1:pe(r),gt(e,r)):[]}function by(e){for(var r=-1,s=e==null?0:e.length,c={};++r<s;){var f=e[r];c[f[0]]=f[1]}return c}function xu(e){return e&&e.length?e[0]:i}function Ey(e,r,s){var c=e==null?0:e.length;if(!c)return-1;var f=s==null?0:pe(s);return f<0&&(f=ct(c+f,0)),ti(e,r,f)}function Sy(e){var r=e==null?0:e.length;return r?Vt(e,0,-1):[]}var Iy=me(function(e){var r=Me(e,Xs);return r.length&&r[0]===e[0]?Hs(r):[]}),Oy=me(function(e){var r=Bt(e),s=Me(e,Xs);return r===Bt(s)?r=i:s.pop(),s.length&&s[0]===e[0]?Hs(s,ie(r,2)):[]}),Py=me(function(e){var r=Bt(e),s=Me(e,Xs);return r=typeof r=="function"?r:i,r&&s.pop(),s.length&&s[0]===e[0]?Hs(s,i,r):[]});function Ny(e,r){return e==null?"":Sp.call(e,r)}function Bt(e){var r=e==null?0:e.length;return r?e[r-1]:i}function Ay(e,r,s){var c=e==null?0:e.length;if(!c)return-1;var f=c;return s!==i&&(f=pe(s),f=f<0?ct(c+f,0):mt(f,c-1)),r===r?ap(e,r,f):cn(e,fc,f,!0)}function Cy(e,r){return e&&e.length?Hc(e,pe(r)):i}var Ry=me($u);function $u(e,r){return e&&e.length&&r&&r.length?Ws(e,r):e}function Ty(e,r,s){return e&&e.length&&r&&r.length?Ws(e,r,ie(s,2)):e}function xy(e,r,s){return e&&e.length&&r&&r.length?Ws(e,r,i,s):e}var $y=gr(function(e,r){var s=e==null?0:e.length,c=Ms(e,r);return Kc(e,Me(r,function(f){return yr(f,s)?+f:f}).sort(ru)),c});function Uy(e,r){var s=[];if(!(e&&e.length))return s;var c=-1,f=[],_=e.length;for(r=ie(r,3);++c<_;){var O=e[c];r(O,c,e)&&(s.push(O),f.push(c))}return Kc(e,f),s}function po(e){return e==null?e:Np.call(e)}function Dy(e,r,s){var c=e==null?0:e.length;return c?(s&&typeof s!="number"&&_t(e,r,s)?(r=0,s=c):(r=r==null?0:pe(r),s=s===i?c:pe(s)),Vt(e,r,s)):[]}function jy(e,r){return An(e,r)}function Ly(e,r,s){return Js(e,r,ie(s,2))}function qy(e,r){var s=e==null?0:e.length;if(s){var c=An(e,r);if(c<s&&Xt(e[c],r))return c}return-1}function My(e,r){return An(e,r,!0)}function Fy(e,r,s){return Js(e,r,ie(s,2),!0)}function zy(e,r){var s=e==null?0:e.length;if(s){var c=An(e,r,!0)-1;if(Xt(e[c],r))return c}return-1}function ky(e){return e&&e.length?Gc(e):[]}function Hy(e,r){return e&&e.length?Gc(e,ie(r,2)):[]}function Vy(e){var r=e==null?0:e.length;return r?Vt(e,1,r):[]}function By(e,r,s){return e&&e.length?(r=s||r===i?1:pe(r),Vt(e,0,r<0?0:r)):[]}function Ky(e,r,s){var c=e==null?0:e.length;return c?(r=s||r===i?1:pe(r),r=c-r,Vt(e,r<0?0:r,c)):[]}function Wy(e,r){return e&&e.length?Cn(e,ie(r,3),!1,!0):[]}function Gy(e,r){return e&&e.length?Cn(e,ie(r,3)):[]}var Qy=me(function(e){return Pr(gt(e,1,Qe,!0))}),Jy=me(function(e){var r=Bt(e);return Qe(r)&&(r=i),Pr(gt(e,1,Qe,!0),ie(r,2))}),Yy=me(function(e){var r=Bt(e);return r=typeof r=="function"?r:i,Pr(gt(e,1,Qe,!0),i,r)});function Zy(e){return e&&e.length?Pr(e):[]}function Xy(e,r){return e&&e.length?Pr(e,ie(r,2)):[]}function em(e,r){return r=typeof r=="function"?r:i,e&&e.length?Pr(e,i,r):[]}function go(e){if(!(e&&e.length))return[];var r=0;return e=br(e,function(s){if(Qe(s))return r=ct(s.length,r),!0}),Ts(r,function(s){return Me(e,As(s))})}function Uu(e,r){if(!(e&&e.length))return[];var s=go(e);return r==null?s:Me(s,function(c){return Rt(r,i,c)})}var tm=me(function(e,r){return Qe(e)?Oi(e,r):[]}),rm=me(function(e){return Zs(br(e,Qe))}),im=me(function(e){var r=Bt(e);return Qe(r)&&(r=i),Zs(br(e,Qe),ie(r,2))}),nm=me(function(e){var r=Bt(e);return r=typeof r=="function"?r:i,Zs(br(e,Qe),i,r)}),sm=me(go);function om(e,r){return Zc(e||[],r||[],Ii)}function am(e,r){return Zc(e||[],r||[],Ai)}var cm=me(function(e){var r=e.length,s=r>1?e[r-1]:i;return s=typeof s=="function"?(e.pop(),s):i,Uu(e,s)});function Du(e){var r=m(e);return r.__chain__=!0,r}function um(e,r){return r(e),e}function qn(e,r){return r(e)}var hm=gr(function(e){var r=e.length,s=r?e[0]:0,c=this.__wrapped__,f=function(_){return Ms(_,e)};return r>1||this.__actions__.length||!(c instanceof _e)||!yr(s)?this.thru(f):(c=c.slice(s,+s+(r?1:0)),c.__actions__.push({func:qn,args:[f],thisArg:i}),new kt(c,this.__chain__).thru(function(_){return r&&!_.length&&_.push(i),_}))});function lm(){return Du(this)}function fm(){return new kt(this.value(),this.__chain__)}function dm(){this.__values__===i&&(this.__values__=Qu(this.value()));var e=this.__index__>=this.__values__.length,r=e?i:this.__values__[this.__index__++];return{done:e,value:r}}function pm(){return this}function gm(e){for(var r,s=this;s instanceof Sn;){var c=Au(s);c.__index__=0,c.__values__=i,r?f.__wrapped__=c:r=c;var f=c;s=s.__wrapped__}return f.__wrapped__=e,r}function ym(){var e=this.__wrapped__;if(e instanceof _e){var r=e;return this.__actions__.length&&(r=new _e(this)),r=r.reverse(),r.__actions__.push({func:qn,args:[po],thisArg:i}),new kt(r,this.__chain__)}return this.thru(po)}function mm(){return Yc(this.__wrapped__,this.__actions__)}var vm=Rn(function(e,r,s){Re.call(e,s)?++e[s]:dr(e,s,1)});function wm(e,r,s){var c=de(e)?hc:ug;return s&&_t(e,r,s)&&(r=i),c(e,ie(r,3))}function _m(e,r){var s=de(e)?br:Uc;return s(e,ie(r,3))}var bm=cu(Cu),Em=cu(Ru);function Sm(e,r){return gt(Mn(e,r),1)}function Im(e,r){return gt(Mn(e,r),$)}function Om(e,r,s){return s=s===i?1:pe(s),gt(Mn(e,r),s)}function ju(e,r){var s=de(e)?Ft:Or;return s(e,ie(r,3))}function Lu(e,r){var s=de(e)?Vd:$c;return s(e,ie(r,3))}var Pm=Rn(function(e,r,s){Re.call(e,s)?e[s].push(r):dr(e,s,[r])});function Nm(e,r,s,c){e=Pt(e)?e:di(e),s=s&&!c?pe(s):0;var f=e.length;return s<0&&(s=ct(f+s,0)),Vn(e)?s<=f&&e.indexOf(r,s)>-1:!!f&&ti(e,r,s)>-1}var Am=me(function(e,r,s){var c=-1,f=typeof r=="function",_=Pt(e)?D(e.length):[];return Or(e,function(O){_[++c]=f?Rt(r,O,s):Pi(O,r,s)}),_}),Cm=Rn(function(e,r,s){dr(e,s,r)});function Mn(e,r){var s=de(e)?Me:Fc;return s(e,ie(r,3))}function Rm(e,r,s,c){return e==null?[]:(de(r)||(r=r==null?[]:[r]),s=c?i:s,de(s)||(s=s==null?[]:[s]),Vc(e,r,s))}var Tm=Rn(function(e,r,s){e[s?0:1].push(r)},function(){return[[],[]]});function xm(e,r,s){var c=de(e)?Ps:pc,f=arguments.length<3;return c(e,ie(r,4),s,f,Or)}function $m(e,r,s){var c=de(e)?Bd:pc,f=arguments.length<3;return c(e,ie(r,4),s,f,$c)}function Um(e,r){var s=de(e)?br:Uc;return s(e,kn(ie(r,3)))}function Dm(e){var r=de(e)?Cc:Ng;return r(e)}function jm(e,r,s){(s?_t(e,r,s):r===i)?r=1:r=pe(r);var c=de(e)?ng:Ag;return c(e,r)}function Lm(e){var r=de(e)?sg:Rg;return r(e)}function qm(e){if(e==null)return 0;if(Pt(e))return Vn(e)?ii(e):e.length;var r=vt(e);return r==ot||r==Te?e.size:Bs(e).length}function Mm(e,r,s){var c=de(e)?Ns:Tg;return s&&_t(e,r,s)&&(r=i),c(e,ie(r,3))}var Fm=me(function(e,r){if(e==null)return[];var s=r.length;return s>1&&_t(e,r[0],r[1])?r=[]:s>2&&_t(r[0],r[1],r[2])&&(r=[r[0]]),Vc(e,gt(r,1),[])}),Fn=_p||function(){return pt.Date.now()};function zm(e,r){if(typeof r!="function")throw new zt(p);return e=pe(e),function(){if(--e<1)return r.apply(this,arguments)}}function qu(e,r,s){return r=s?i:r,r=e&&r==null?e.length:r,pr(e,u,i,i,i,i,r)}function Mu(e,r){var s;if(typeof r!="function")throw new zt(p);return e=pe(e),function(){return--e>0&&(s=r.apply(this,arguments)),e<=1&&(r=i),s}}var yo=me(function(e,r,s){var c=F;if(s.length){var f=Sr(s,li(yo));c|=y}return pr(e,c,r,s,f)}),Fu=me(function(e,r,s){var c=F|V;if(s.length){var f=Sr(s,li(Fu));c|=y}return pr(r,c,e,s,f)});function zu(e,r,s){r=s?i:r;var c=pr(e,w,i,i,i,i,i,r);return c.placeholder=zu.placeholder,c}function ku(e,r,s){r=s?i:r;var c=pr(e,g,i,i,i,i,i,r);return c.placeholder=ku.placeholder,c}function Hu(e,r,s){var c,f,_,O,N,T,q=0,M=!1,k=!1,W=!0;if(typeof e!="function")throw new zt(p);r=Kt(r)||0,ze(s)&&(M=!!s.leading,k="maxWait"in s,_=k?ct(Kt(s.maxWait)||0,r):_,W="trailing"in s?!!s.trailing:W);function X(Je){var er=c,wr=f;return c=f=i,q=Je,O=e.apply(wr,er),O}function se(Je){return q=Je,N=Ti(we,r),M?X(Je):O}function ge(Je){var er=Je-T,wr=Je-q,ch=r-er;return k?mt(ch,_-wr):ch}function oe(Je){var er=Je-T,wr=Je-q;return T===i||er>=r||er<0||k&&wr>=_}function we(){var Je=Fn();if(oe(Je))return Ee(Je);N=Ti(we,ge(Je))}function Ee(Je){return N=i,W&&c?X(Je):(c=f=i,O)}function Ut(){N!==i&&Xc(N),q=0,c=T=f=N=i}function bt(){return N===i?O:Ee(Fn())}function Dt(){var Je=Fn(),er=oe(Je);if(c=arguments,f=this,T=Je,er){if(N===i)return se(T);if(k)return Xc(N),N=Ti(we,r),X(T)}return N===i&&(N=Ti(we,r)),O}return Dt.cancel=Ut,Dt.flush=bt,Dt}var km=me(function(e,r){return xc(e,1,r)}),Hm=me(function(e,r,s){return xc(e,Kt(r)||0,s)});function Vm(e){return pr(e,H)}function zn(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new zt(p);var s=function(){var c=arguments,f=r?r.apply(this,c):c[0],_=s.cache;if(_.has(f))return _.get(f);var O=e.apply(this,c);return s.cache=_.set(f,O)||_,O};return s.cache=new(zn.Cache||fr),s}zn.Cache=fr;function kn(e){if(typeof e!="function")throw new zt(p);return function(){var r=arguments;switch(r.length){case 0:return!e.call(this);case 1:return!e.call(this,r[0]);case 2:return!e.call(this,r[0],r[1]);case 3:return!e.call(this,r[0],r[1],r[2])}return!e.apply(this,r)}}function Bm(e){return Mu(2,e)}var Km=xg(function(e,r){r=r.length==1&&de(r[0])?Me(r[0],Tt(ie())):Me(gt(r,1),Tt(ie()));var s=r.length;return me(function(c){for(var f=-1,_=mt(c.length,s);++f<_;)c[f]=r[f].call(this,c[f]);return Rt(e,this,c)})}),mo=me(function(e,r){var s=Sr(r,li(mo));return pr(e,y,i,r,s)}),Vu=me(function(e,r){var s=Sr(r,li(Vu));return pr(e,E,i,r,s)}),Wm=gr(function(e,r){return pr(e,b,i,i,i,r)});function Gm(e,r){if(typeof e!="function")throw new zt(p);return r=r===i?r:pe(r),me(e,r)}function Qm(e,r){if(typeof e!="function")throw new zt(p);return r=r==null?0:ct(pe(r),0),me(function(s){var c=s[r],f=Ar(s,0,r);return c&&Er(f,c),Rt(e,this,f)})}function Jm(e,r,s){var c=!0,f=!0;if(typeof e!="function")throw new zt(p);return ze(s)&&(c="leading"in s?!!s.leading:c,f="trailing"in s?!!s.trailing:f),Hu(e,r,{leading:c,maxWait:r,trailing:f})}function Ym(e){return qu(e,1)}function Zm(e,r){return mo(eo(r),e)}function Xm(){if(!arguments.length)return[];var e=arguments[0];return de(e)?e:[e]}function ev(e){return Ht(e,A)}function tv(e,r){return r=typeof r=="function"?r:i,Ht(e,A,r)}function rv(e){return Ht(e,R|A)}function iv(e,r){return r=typeof r=="function"?r:i,Ht(e,R|A,r)}function nv(e,r){return r==null||Tc(e,r,lt(r))}function Xt(e,r){return e===r||e!==e&&r!==r}var sv=Un(ks),ov=Un(function(e,r){return e>=r}),Vr=Lc(function(){return arguments}())?Lc:function(e){return Ke(e)&&Re.call(e,"callee")&&!Sc.call(e,"callee")},de=D.isArray,av=nc?Tt(nc):gg;function Pt(e){return e!=null&&Hn(e.length)&&!mr(e)}function Qe(e){return Ke(e)&&Pt(e)}function cv(e){return e===!0||e===!1||Ke(e)&&wt(e)==be}var Cr=Ep||Ao,uv=sc?Tt(sc):yg;function hv(e){return Ke(e)&&e.nodeType===1&&!xi(e)}function lv(e){if(e==null)return!0;if(Pt(e)&&(de(e)||typeof e=="string"||typeof e.splice=="function"||Cr(e)||fi(e)||Vr(e)))return!e.length;var r=vt(e);if(r==ot||r==Te)return!e.size;if(Ri(e))return!Bs(e).length;for(var s in e)if(Re.call(e,s))return!1;return!0}function fv(e,r){return Ni(e,r)}function dv(e,r,s){s=typeof s=="function"?s:i;var c=s?s(e,r):i;return c===i?Ni(e,r,i,s):!!c}function vo(e){if(!Ke(e))return!1;var r=wt(e);return r==Oe||r==Ce||typeof e.message=="string"&&typeof e.name=="string"&&!xi(e)}function pv(e){return typeof e=="number"&&Oc(e)}function mr(e){if(!ze(e))return!1;var r=wt(e);return r==Ne||r==xe||r==Ie||r==rn}function Bu(e){return typeof e=="number"&&e==pe(e)}function Hn(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=K}function ze(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}function Ke(e){return e!=null&&typeof e=="object"}var Ku=oc?Tt(oc):vg;function gv(e,r){return e===r||Vs(e,r,ao(r))}function yv(e,r,s){return s=typeof s=="function"?s:i,Vs(e,r,ao(r),s)}function mv(e){return Wu(e)&&e!=+e}function vv(e){if(ty(e))throw new fe(h);return qc(e)}function wv(e){return e===null}function _v(e){return e==null}function Wu(e){return typeof e=="number"||Ke(e)&&wt(e)==qt}function xi(e){if(!Ke(e)||wt(e)!=It)return!1;var r=yn(e);if(r===null)return!0;var s=Re.call(r,"constructor")&&r.constructor;return typeof s=="function"&&s instanceof s&&fn.call(s)==yp}var wo=ac?Tt(ac):wg;function bv(e){return Bu(e)&&e>=-9007199254740991&&e<=K}var Gu=cc?Tt(cc):_g;function Vn(e){return typeof e=="string"||!de(e)&&Ke(e)&&wt(e)==He}function $t(e){return typeof e=="symbol"||Ke(e)&&wt(e)==Ge}var fi=uc?Tt(uc):bg;function Ev(e){return e===i}function Sv(e){return Ke(e)&&vt(e)==Ve}function Iv(e){return Ke(e)&&wt(e)==ht}var Ov=Un(Ks),Pv=Un(function(e,r){return e<=r});function Qu(e){if(!e)return[];if(Pt(e))return Vn(e)?Yt(e):Ot(e);if(wi&&e[wi])return np(e[wi]());var r=vt(e),s=r==ot?$s:r==Te?un:di;return s(e)}function vr(e){if(!e)return e===0?e:0;if(e=Kt(e),e===$||e===-1/0){var r=e<0?-1:1;return r*ae}return e===e?e:0}function pe(e){var r=vr(e),s=r%1;return r===r?s?r-s:r:0}function Ju(e){return e?Fr(pe(e),0,ce):0}function Kt(e){if(typeof e=="number")return e;if($t(e))return te;if(ze(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=ze(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=gc(e);var s=ad.test(e);return s||ud.test(e)?zd(e.slice(2),s?2:8):od.test(e)?te:+e}function Yu(e){return or(e,Nt(e))}function Nv(e){return e?Fr(pe(e),-9007199254740991,K):e===0?e:0}function Ae(e){return e==null?"":xt(e)}var Av=ui(function(e,r){if(Ri(r)||Pt(r)){or(r,lt(r),e);return}for(var s in r)Re.call(r,s)&&Ii(e,s,r[s])}),Zu=ui(function(e,r){or(r,Nt(r),e)}),Bn=ui(function(e,r,s,c){or(r,Nt(r),e,c)}),Cv=ui(function(e,r,s,c){or(r,lt(r),e,c)}),Rv=gr(Ms);function Tv(e,r){var s=ci(e);return r==null?s:Rc(s,r)}var xv=me(function(e,r){e=$e(e);var s=-1,c=r.length,f=c>2?r[2]:i;for(f&&_t(r[0],r[1],f)&&(c=1);++s<c;)for(var _=r[s],O=Nt(_),N=-1,T=O.length;++N<T;){var q=O[N],M=e[q];(M===i||Xt(M,si[q])&&!Re.call(e,q))&&(e[q]=_[q])}return e}),$v=me(function(e){return e.push(i,gu),Rt(Xu,i,e)});function Uv(e,r){return lc(e,ie(r,3),sr)}function Dv(e,r){return lc(e,ie(r,3),zs)}function jv(e,r){return e==null?e:Fs(e,ie(r,3),Nt)}function Lv(e,r){return e==null?e:Dc(e,ie(r,3),Nt)}function qv(e,r){return e&&sr(e,ie(r,3))}function Mv(e,r){return e&&zs(e,ie(r,3))}function Fv(e){return e==null?[]:Pn(e,lt(e))}function zv(e){return e==null?[]:Pn(e,Nt(e))}function _o(e,r,s){var c=e==null?i:zr(e,r);return c===i?s:c}function kv(e,r){return e!=null&&vu(e,r,lg)}function bo(e,r){return e!=null&&vu(e,r,fg)}var Hv=hu(function(e,r,s){r!=null&&typeof r.toString!="function"&&(r=dn.call(r)),e[r]=s},So(At)),Vv=hu(function(e,r,s){r!=null&&typeof r.toString!="function"&&(r=dn.call(r)),Re.call(e,r)?e[r].push(s):e[r]=[s]},ie),Bv=me(Pi);function lt(e){return Pt(e)?Ac(e):Bs(e)}function Nt(e){return Pt(e)?Ac(e,!0):Eg(e)}function Kv(e,r){var s={};return r=ie(r,3),sr(e,function(c,f,_){dr(s,r(c,f,_),c)}),s}function Wv(e,r){var s={};return r=ie(r,3),sr(e,function(c,f,_){dr(s,f,r(c,f,_))}),s}var Gv=ui(function(e,r,s){Nn(e,r,s)}),Xu=ui(function(e,r,s,c){Nn(e,r,s,c)}),Qv=gr(function(e,r){var s={};if(e==null)return s;var c=!1;r=Me(r,function(_){return _=Nr(_,e),c||(c=_.length>1),_}),or(e,so(e),s),c&&(s=Ht(s,R|x|A,Hg));for(var f=r.length;f--;)Ys(s,r[f]);return s});function Jv(e,r){return eh(e,kn(ie(r)))}var Yv=gr(function(e,r){return e==null?{}:Ig(e,r)});function eh(e,r){if(e==null)return{};var s=Me(so(e),function(c){return[c]});return r=ie(r),Bc(e,s,function(c,f){return r(c,f[0])})}function Zv(e,r,s){r=Nr(r,e);var c=-1,f=r.length;for(f||(f=1,e=i);++c<f;){var _=e==null?i:e[ar(r[c])];_===i&&(c=f,_=s),e=mr(_)?_.call(e):_}return e}function Xv(e,r,s){return e==null?e:Ai(e,r,s)}function e0(e,r,s,c){return c=typeof c=="function"?c:i,e==null?e:Ai(e,r,s,c)}var th=du(lt),rh=du(Nt);function t0(e,r,s){var c=de(e),f=c||Cr(e)||fi(e);if(r=ie(r,4),s==null){var _=e&&e.constructor;f?s=c?new _:[]:ze(e)?s=mr(_)?ci(yn(e)):{}:s={}}return(f?Ft:sr)(e,function(O,N,T){return r(s,O,N,T)}),s}function r0(e,r){return e==null?!0:Ys(e,r)}function i0(e,r,s){return e==null?e:Jc(e,r,eo(s))}function n0(e,r,s,c){return c=typeof c=="function"?c:i,e==null?e:Jc(e,r,eo(s),c)}function di(e){return e==null?[]:xs(e,lt(e))}function s0(e){return e==null?[]:xs(e,Nt(e))}function o0(e,r,s){return s===i&&(s=r,r=i),s!==i&&(s=Kt(s),s=s===s?s:0),r!==i&&(r=Kt(r),r=r===r?r:0),Fr(Kt(e),r,s)}function a0(e,r,s){return r=vr(r),s===i?(s=r,r=0):s=vr(s),e=Kt(e),dg(e,r,s)}function c0(e,r,s){if(s&&typeof s!="boolean"&&_t(e,r,s)&&(r=s=i),s===i&&(typeof r=="boolean"?(s=r,r=i):typeof e=="boolean"&&(s=e,e=i)),e===i&&r===i?(e=0,r=1):(e=vr(e),r===i?(r=e,e=0):r=vr(r)),e>r){var c=e;e=r,r=c}if(s||e%1||r%1){var f=Pc();return mt(e+f*(r-e+Fd("1e-"+((f+"").length-1))),r)}return Gs(e,r)}var u0=hi(function(e,r,s){return r=r.toLowerCase(),e+(s?ih(r):r)});function ih(e){return Eo(Ae(e).toLowerCase())}function nh(e){return e=Ae(e),e&&e.replace(ld,Xd).replace(Rd,"")}function h0(e,r,s){e=Ae(e),r=xt(r);var c=e.length;s=s===i?c:Fr(pe(s),0,c);var f=s;return s-=r.length,s>=0&&e.slice(s,f)==r}function l0(e){return e=Ae(e),e&&Bf.test(e)?e.replace(Da,ep):e}function f0(e){return e=Ae(e),e&&Yf.test(e)?e.replace(ys,"\\$&"):e}var d0=hi(function(e,r,s){return e+(s?"-":"")+r.toLowerCase()}),p0=hi(function(e,r,s){return e+(s?" ":"")+r.toLowerCase()}),g0=au("toLowerCase");function y0(e,r,s){e=Ae(e),r=pe(r);var c=r?ii(e):0;if(!r||c>=r)return e;var f=(r-c)/2;return $n(_n(f),s)+e+$n(wn(f),s)}function m0(e,r,s){e=Ae(e),r=pe(r);var c=r?ii(e):0;return r&&c<r?e+$n(r-c,s):e}function v0(e,r,s){e=Ae(e),r=pe(r);var c=r?ii(e):0;return r&&c<r?$n(r-c,s)+e:e}function w0(e,r,s){return s||r==null?r=0:r&&(r=+r),Pp(Ae(e).replace(ms,""),r||0)}function _0(e,r,s){return(s?_t(e,r,s):r===i)?r=1:r=pe(r),Qs(Ae(e),r)}function b0(){var e=arguments,r=Ae(e[0]);return e.length<3?r:r.replace(e[1],e[2])}var E0=hi(function(e,r,s){return e+(s?"_":"")+r.toLowerCase()});function S0(e,r,s){return s&&typeof s!="number"&&_t(e,r,s)&&(r=s=i),s=s===i?ce:s>>>0,s?(e=Ae(e),e&&(typeof r=="string"||r!=null&&!wo(r))&&(r=xt(r),!r&&ri(e))?Ar(Yt(e),0,s):e.split(r,s)):[]}var I0=hi(function(e,r,s){return e+(s?" ":"")+Eo(r)});function O0(e,r,s){return e=Ae(e),s=s==null?0:Fr(pe(s),0,e.length),r=xt(r),e.slice(s,s+r.length)==r}function P0(e,r,s){var c=m.templateSettings;s&&_t(e,r,s)&&(r=i),e=Ae(e),r=Bn({},r,c,pu);var f=Bn({},r.imports,c.imports,pu),_=lt(f),O=xs(f,_),N,T,q=0,M=r.interpolate||nn,k="__p += '",W=Us((r.escape||nn).source+"|"+M.source+"|"+(M===ja?sd:nn).source+"|"+(r.evaluate||nn).source+"|$","g"),X="//# sourceURL="+(Re.call(r,"sourceURL")?(r.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Dd+"]")+`
`;e.replace(W,function(oe,we,Ee,Ut,bt,Dt){return Ee||(Ee=Ut),k+=e.slice(q,Dt).replace(fd,tp),we&&(N=!0,k+=`' +
__e(`+we+`) +
'`),bt&&(T=!0,k+=`';
`+bt+`;
__p += '`),Ee&&(k+=`' +
((__t = (`+Ee+`)) == null ? '' : __t) +
'`),q=Dt+oe.length,oe}),k+=`';
`;var se=Re.call(r,"variable")&&r.variable;if(!se)k=`with (obj) {
`+k+`
}
`;else if(id.test(se))throw new fe(d);k=(T?k.replace(zf,""):k).replace(kf,"$1").replace(Hf,"$1;"),k="function("+(se||"obj")+`) {
`+(se?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(N?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+k+`return __p
}`;var ge=oh(function(){return Pe(_,X+"return "+k).apply(i,O)});if(ge.source=k,vo(ge))throw ge;return ge}function N0(e){return Ae(e).toLowerCase()}function A0(e){return Ae(e).toUpperCase()}function C0(e,r,s){if(e=Ae(e),e&&(s||r===i))return gc(e);if(!e||!(r=xt(r)))return e;var c=Yt(e),f=Yt(r),_=yc(c,f),O=mc(c,f)+1;return Ar(c,_,O).join("")}function R0(e,r,s){if(e=Ae(e),e&&(s||r===i))return e.slice(0,wc(e)+1);if(!e||!(r=xt(r)))return e;var c=Yt(e),f=mc(c,Yt(r))+1;return Ar(c,0,f).join("")}function T0(e,r,s){if(e=Ae(e),e&&(s||r===i))return e.replace(ms,"");if(!e||!(r=xt(r)))return e;var c=Yt(e),f=yc(c,Yt(r));return Ar(c,f).join("")}function x0(e,r){var s=J,c=ne;if(ze(r)){var f="separator"in r?r.separator:f;s="length"in r?pe(r.length):s,c="omission"in r?xt(r.omission):c}e=Ae(e);var _=e.length;if(ri(e)){var O=Yt(e);_=O.length}if(s>=_)return e;var N=s-ii(c);if(N<1)return c;var T=O?Ar(O,0,N).join(""):e.slice(0,N);if(f===i)return T+c;if(O&&(N+=T.length-N),wo(f)){if(e.slice(N).search(f)){var q,M=T;for(f.global||(f=Us(f.source,Ae(La.exec(f))+"g")),f.lastIndex=0;q=f.exec(M);)var k=q.index;T=T.slice(0,k===i?N:k)}}else if(e.indexOf(xt(f),N)!=N){var W=T.lastIndexOf(f);W>-1&&(T=T.slice(0,W))}return T+c}function $0(e){return e=Ae(e),e&&Vf.test(e)?e.replace(Ua,cp):e}var U0=hi(function(e,r,s){return e+(s?" ":"")+r.toUpperCase()}),Eo=au("toUpperCase");function sh(e,r,s){return e=Ae(e),r=s?i:r,r===i?ip(e)?lp(e):Gd(e):e.match(r)||[]}var oh=me(function(e,r){try{return Rt(e,i,r)}catch(s){return vo(s)?s:new fe(s)}}),D0=gr(function(e,r){return Ft(r,function(s){s=ar(s),dr(e,s,yo(e[s],e))}),e});function j0(e){var r=e==null?0:e.length,s=ie();return e=r?Me(e,function(c){if(typeof c[1]!="function")throw new zt(p);return[s(c[0]),c[1]]}):[],me(function(c){for(var f=-1;++f<r;){var _=e[f];if(Rt(_[0],this,c))return Rt(_[1],this,c)}})}function L0(e){return cg(Ht(e,R))}function So(e){return function(){return e}}function q0(e,r){return e==null||e!==e?r:e}var M0=uu(),F0=uu(!0);function At(e){return e}function Io(e){return Mc(typeof e=="function"?e:Ht(e,R))}function z0(e){return zc(Ht(e,R))}function k0(e,r){return kc(e,Ht(r,R))}var H0=me(function(e,r){return function(s){return Pi(s,e,r)}}),V0=me(function(e,r){return function(s){return Pi(e,s,r)}});function Oo(e,r,s){var c=lt(r),f=Pn(r,c);s==null&&!(ze(r)&&(f.length||!c.length))&&(s=r,r=e,e=this,f=Pn(r,lt(r)));var _=!(ze(s)&&"chain"in s)||!!s.chain,O=mr(e);return Ft(f,function(N){var T=r[N];e[N]=T,O&&(e.prototype[N]=function(){var q=this.__chain__;if(_||q){var M=e(this.__wrapped__),k=M.__actions__=Ot(this.__actions__);return k.push({func:T,args:arguments,thisArg:e}),M.__chain__=q,M}return T.apply(e,Er([this.value()],arguments))})}),e}function B0(){return pt._===this&&(pt._=mp),this}function Po(){}function K0(e){return e=pe(e),me(function(r){return Hc(r,e)})}var W0=ro(Me),G0=ro(hc),Q0=ro(Ns);function ah(e){return uo(e)?As(ar(e)):Og(e)}function J0(e){return function(r){return e==null?i:zr(e,r)}}var Y0=lu(),Z0=lu(!0);function No(){return[]}function Ao(){return!1}function X0(){return{}}function ew(){return""}function tw(){return!0}function rw(e,r){if(e=pe(e),e<1||e>K)return[];var s=ce,c=mt(e,ce);r=ie(r),e-=ce;for(var f=Ts(c,r);++s<e;)r(s);return f}function iw(e){return de(e)?Me(e,ar):$t(e)?[e]:Ot(Nu(Ae(e)))}function nw(e){var r=++gp;return Ae(e)+r}var sw=xn(function(e,r){return e+r},0),ow=io("ceil"),aw=xn(function(e,r){return e/r},1),cw=io("floor");function uw(e){return e&&e.length?On(e,At,ks):i}function hw(e,r){return e&&e.length?On(e,ie(r,2),ks):i}function lw(e){return dc(e,At)}function fw(e,r){return dc(e,ie(r,2))}function dw(e){return e&&e.length?On(e,At,Ks):i}function pw(e,r){return e&&e.length?On(e,ie(r,2),Ks):i}var gw=xn(function(e,r){return e*r},1),yw=io("round"),mw=xn(function(e,r){return e-r},0);function vw(e){return e&&e.length?Rs(e,At):0}function ww(e,r){return e&&e.length?Rs(e,ie(r,2)):0}return m.after=zm,m.ary=qu,m.assign=Av,m.assignIn=Zu,m.assignInWith=Bn,m.assignWith=Cv,m.at=Rv,m.before=Mu,m.bind=yo,m.bindAll=D0,m.bindKey=Fu,m.castArray=Xm,m.chain=Du,m.chunk=cy,m.compact=uy,m.concat=hy,m.cond=j0,m.conforms=L0,m.constant=So,m.countBy=vm,m.create=Tv,m.curry=zu,m.curryRight=ku,m.debounce=Hu,m.defaults=xv,m.defaultsDeep=$v,m.defer=km,m.delay=Hm,m.difference=ly,m.differenceBy=fy,m.differenceWith=dy,m.drop=py,m.dropRight=gy,m.dropRightWhile=yy,m.dropWhile=my,m.fill=vy,m.filter=_m,m.flatMap=Sm,m.flatMapDeep=Im,m.flatMapDepth=Om,m.flatten=Tu,m.flattenDeep=wy,m.flattenDepth=_y,m.flip=Vm,m.flow=M0,m.flowRight=F0,m.fromPairs=by,m.functions=Fv,m.functionsIn=zv,m.groupBy=Pm,m.initial=Sy,m.intersection=Iy,m.intersectionBy=Oy,m.intersectionWith=Py,m.invert=Hv,m.invertBy=Vv,m.invokeMap=Am,m.iteratee=Io,m.keyBy=Cm,m.keys=lt,m.keysIn=Nt,m.map=Mn,m.mapKeys=Kv,m.mapValues=Wv,m.matches=z0,m.matchesProperty=k0,m.memoize=zn,m.merge=Gv,m.mergeWith=Xu,m.method=H0,m.methodOf=V0,m.mixin=Oo,m.negate=kn,m.nthArg=K0,m.omit=Qv,m.omitBy=Jv,m.once=Bm,m.orderBy=Rm,m.over=W0,m.overArgs=Km,m.overEvery=G0,m.overSome=Q0,m.partial=mo,m.partialRight=Vu,m.partition=Tm,m.pick=Yv,m.pickBy=eh,m.property=ah,m.propertyOf=J0,m.pull=Ry,m.pullAll=$u,m.pullAllBy=Ty,m.pullAllWith=xy,m.pullAt=$y,m.range=Y0,m.rangeRight=Z0,m.rearg=Wm,m.reject=Um,m.remove=Uy,m.rest=Gm,m.reverse=po,m.sampleSize=jm,m.set=Xv,m.setWith=e0,m.shuffle=Lm,m.slice=Dy,m.sortBy=Fm,m.sortedUniq=ky,m.sortedUniqBy=Hy,m.split=S0,m.spread=Qm,m.tail=Vy,m.take=By,m.takeRight=Ky,m.takeRightWhile=Wy,m.takeWhile=Gy,m.tap=um,m.throttle=Jm,m.thru=qn,m.toArray=Qu,m.toPairs=th,m.toPairsIn=rh,m.toPath=iw,m.toPlainObject=Yu,m.transform=t0,m.unary=Ym,m.union=Qy,m.unionBy=Jy,m.unionWith=Yy,m.uniq=Zy,m.uniqBy=Xy,m.uniqWith=em,m.unset=r0,m.unzip=go,m.unzipWith=Uu,m.update=i0,m.updateWith=n0,m.values=di,m.valuesIn=s0,m.without=tm,m.words=sh,m.wrap=Zm,m.xor=rm,m.xorBy=im,m.xorWith=nm,m.zip=sm,m.zipObject=om,m.zipObjectDeep=am,m.zipWith=cm,m.entries=th,m.entriesIn=rh,m.extend=Zu,m.extendWith=Bn,Oo(m,m),m.add=sw,m.attempt=oh,m.camelCase=u0,m.capitalize=ih,m.ceil=ow,m.clamp=o0,m.clone=ev,m.cloneDeep=rv,m.cloneDeepWith=iv,m.cloneWith=tv,m.conformsTo=nv,m.deburr=nh,m.defaultTo=q0,m.divide=aw,m.endsWith=h0,m.eq=Xt,m.escape=l0,m.escapeRegExp=f0,m.every=wm,m.find=bm,m.findIndex=Cu,m.findKey=Uv,m.findLast=Em,m.findLastIndex=Ru,m.findLastKey=Dv,m.floor=cw,m.forEach=ju,m.forEachRight=Lu,m.forIn=jv,m.forInRight=Lv,m.forOwn=qv,m.forOwnRight=Mv,m.get=_o,m.gt=sv,m.gte=ov,m.has=kv,m.hasIn=bo,m.head=xu,m.identity=At,m.includes=Nm,m.indexOf=Ey,m.inRange=a0,m.invoke=Bv,m.isArguments=Vr,m.isArray=de,m.isArrayBuffer=av,m.isArrayLike=Pt,m.isArrayLikeObject=Qe,m.isBoolean=cv,m.isBuffer=Cr,m.isDate=uv,m.isElement=hv,m.isEmpty=lv,m.isEqual=fv,m.isEqualWith=dv,m.isError=vo,m.isFinite=pv,m.isFunction=mr,m.isInteger=Bu,m.isLength=Hn,m.isMap=Ku,m.isMatch=gv,m.isMatchWith=yv,m.isNaN=mv,m.isNative=vv,m.isNil=_v,m.isNull=wv,m.isNumber=Wu,m.isObject=ze,m.isObjectLike=Ke,m.isPlainObject=xi,m.isRegExp=wo,m.isSafeInteger=bv,m.isSet=Gu,m.isString=Vn,m.isSymbol=$t,m.isTypedArray=fi,m.isUndefined=Ev,m.isWeakMap=Sv,m.isWeakSet=Iv,m.join=Ny,m.kebabCase=d0,m.last=Bt,m.lastIndexOf=Ay,m.lowerCase=p0,m.lowerFirst=g0,m.lt=Ov,m.lte=Pv,m.max=uw,m.maxBy=hw,m.mean=lw,m.meanBy=fw,m.min=dw,m.minBy=pw,m.stubArray=No,m.stubFalse=Ao,m.stubObject=X0,m.stubString=ew,m.stubTrue=tw,m.multiply=gw,m.nth=Cy,m.noConflict=B0,m.noop=Po,m.now=Fn,m.pad=y0,m.padEnd=m0,m.padStart=v0,m.parseInt=w0,m.random=c0,m.reduce=xm,m.reduceRight=$m,m.repeat=_0,m.replace=b0,m.result=Zv,m.round=yw,m.runInContext=C,m.sample=Dm,m.size=qm,m.snakeCase=E0,m.some=Mm,m.sortedIndex=jy,m.sortedIndexBy=Ly,m.sortedIndexOf=qy,m.sortedLastIndex=My,m.sortedLastIndexBy=Fy,m.sortedLastIndexOf=zy,m.startCase=I0,m.startsWith=O0,m.subtract=mw,m.sum=vw,m.sumBy=ww,m.template=P0,m.times=rw,m.toFinite=vr,m.toInteger=pe,m.toLength=Ju,m.toLower=N0,m.toNumber=Kt,m.toSafeInteger=Nv,m.toString=Ae,m.toUpper=A0,m.trim=C0,m.trimEnd=R0,m.trimStart=T0,m.truncate=x0,m.unescape=$0,m.uniqueId=nw,m.upperCase=U0,m.upperFirst=Eo,m.each=ju,m.eachRight=Lu,m.first=xu,Oo(m,function(){var e={};return sr(m,function(r,s){Re.call(m.prototype,s)||(e[s]=r)}),e}(),{chain:!1}),m.VERSION=n,Ft(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){m[e].placeholder=m}),Ft(["drop","take"],function(e,r){_e.prototype[e]=function(s){s=s===i?1:ct(pe(s),0);var c=this.__filtered__&&!r?new _e(this):this.clone();return c.__filtered__?c.__takeCount__=mt(s,c.__takeCount__):c.__views__.push({size:mt(s,ce),type:e+(c.__dir__<0?"Right":"")}),c},_e.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),Ft(["filter","map","takeWhile"],function(e,r){var s=r+1,c=s==re||s==P;_e.prototype[e]=function(f){var _=this.clone();return _.__iteratees__.push({iteratee:ie(f,3),type:s}),_.__filtered__=_.__filtered__||c,_}}),Ft(["head","last"],function(e,r){var s="take"+(r?"Right":"");_e.prototype[e]=function(){return this[s](1).value()[0]}}),Ft(["initial","tail"],function(e,r){var s="drop"+(r?"":"Right");_e.prototype[e]=function(){return this.__filtered__?new _e(this):this[s](1)}}),_e.prototype.compact=function(){return this.filter(At)},_e.prototype.find=function(e){return this.filter(e).head()},_e.prototype.findLast=function(e){return this.reverse().find(e)},_e.prototype.invokeMap=me(function(e,r){return typeof e=="function"?new _e(this):this.map(function(s){return Pi(s,e,r)})}),_e.prototype.reject=function(e){return this.filter(kn(ie(e)))},_e.prototype.slice=function(e,r){e=pe(e);var s=this;return s.__filtered__&&(e>0||r<0)?new _e(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),r!==i&&(r=pe(r),s=r<0?s.dropRight(-r):s.take(r-e)),s)},_e.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},_e.prototype.toArray=function(){return this.take(ce)},sr(_e.prototype,function(e,r){var s=/^(?:filter|find|map|reject)|While$/.test(r),c=/^(?:head|last)$/.test(r),f=m[c?"take"+(r=="last"?"Right":""):r],_=c||/^find/.test(r);f&&(m.prototype[r]=function(){var O=this.__wrapped__,N=c?[1]:arguments,T=O instanceof _e,q=N[0],M=T||de(O),k=function(we){var Ee=f.apply(m,Er([we],N));return c&&W?Ee[0]:Ee};M&&s&&typeof q=="function"&&q.length!=1&&(T=M=!1);var W=this.__chain__,X=!!this.__actions__.length,se=_&&!W,ge=T&&!X;if(!_&&M){O=ge?O:new _e(this);var oe=e.apply(O,N);return oe.__actions__.push({func:qn,args:[k],thisArg:i}),new kt(oe,W)}return se&&ge?e.apply(this,N):(oe=this.thru(k),se?c?oe.value()[0]:oe.value():oe)})}),Ft(["pop","push","shift","sort","splice","unshift"],function(e){var r=hn[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);m.prototype[e]=function(){var f=arguments;if(c&&!this.__chain__){var _=this.value();return r.apply(de(_)?_:[],f)}return this[s](function(O){return r.apply(de(O)?O:[],f)})}}),sr(_e.prototype,function(e,r){var s=m[r];if(s){var c=s.name+"";Re.call(ai,c)||(ai[c]=[]),ai[c].push({name:r,func:s})}}),ai[Tn(i,V).name]=[{name:"wrapper",func:i}],_e.prototype.clone=$p,_e.prototype.reverse=Up,_e.prototype.value=Dp,m.prototype.at=hm,m.prototype.chain=lm,m.prototype.commit=fm,m.prototype.next=dm,m.prototype.plant=gm,m.prototype.reverse=ym,m.prototype.toJSON=m.prototype.valueOf=m.prototype.value=mm,m.prototype.first=m.prototype.head,wi&&(m.prototype[wi]=pm),m},ni=fp();jr?((jr.exports=ni)._=ni,Ss._=ni):pt._=ni}).call(Wi)})(ua,ua.exports);var MS=Object.defineProperty,FS=Object.defineProperties,zS=Object.getOwnPropertyDescriptors,jl=Object.getOwnPropertySymbols,kS=Object.prototype.hasOwnProperty,HS=Object.prototype.propertyIsEnumerable,Ll=(o,t,i)=>t in o?MS(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,Jn=(o,t)=>{for(var i in t||(t={}))kS.call(t,i)&&Ll(o,i,t[i]);if(jl)for(var i of jl(t))HS.call(t,i)&&Ll(o,i,t[i]);return o},VS=(o,t)=>FS(o,zS(t));function Jt(o,t,i){let n;const a=ha(o);return t.rpcMap&&(n=t.rpcMap[a]),n||(n=`${qS}?chainId=eip155:${a}&projectId=${i}`),n}function ha(o){return o.includes("eip155")?Number(o.split(":")[1]):Number(o)}function qf(o){return o.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function BS(o,t){const i=Object.keys(t.namespaces).filter(a=>a.includes(o));if(!i.length)return[];const n=[];return i.forEach(a=>{const h=t.namespaces[a].accounts;n.push(...h)}),n}function KS(o={},t={}){const i=ql(o),n=ql(t);return ua.exports.merge(i,n)}function ql(o){var t,i,n,a;const h={};if(!US(o))return h;for(const[p,d]of Object.entries(o)){const v=xa(p)?[p]:d.chains,S=d.methods||[],I=d.events||[],R=d.rpcMap||{},x=es(p);h[x]=VS(Jn(Jn({},h[x]),d),{chains:Zo(v,(t=h[x])==null?void 0:t.chains),methods:Zo(S,(i=h[x])==null?void 0:i.methods),events:Zo(I,(n=h[x])==null?void 0:n.events),rpcMap:Jn(Jn({},R),(a=h[x])==null?void 0:a.rpcMap)})}return h}function WS(o){return o.includes(":")?o.split(":")[2]:o}function GS(o){const t={};for(const[i,n]of Object.entries(o)){const a=n.methods||[],h=n.events||[],p=n.accounts||[],d=xa(i)?[i]:n.chains?n.chains:qf(n.accounts);t[i]={chains:d,methods:a,events:h,accounts:p}}return t}const Mf={},Ye=o=>Mf[o],Xo=(o,t)=>{Mf[o]=t};class QS{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(this.chainId=t,!this.httpProviders[t]){const n=i||Jt(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(Ur.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;t[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||Jt(t,this.namespace);return typeof n>"u"?void 0:new Zr(new Jr(n,Ye("disableProviderPing")))}}class JS{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,i){const n=ha(t);if(!this.httpProviders[n]){const a=i||Jt(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!a)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,a)}this.chainId=n,this.events.emit(Ur.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,i){const n=i||Jt(`${this.name}:${t}`,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Zr(new Jr(n,Ye("disableProviderPing")))}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;const a=ha(i);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}async handleSwitchChain(t){var i,n;let a=t.request.params?(i=t.request.params[0])==null?void 0:i.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const h=parseInt(a,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class YS{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(!this.httpProviders[t]){const n=i||Jt(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.chainId=t,this.events.emit(Ur.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;t[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||Jt(t,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Zr(new Jr(n,Ye("disableProviderPing")))}}class ZS{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(this.chainId=t,!this.httpProviders[t]){const n=i||Jt(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(Ur.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;t[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||Jt(t,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Zr(new Jr(n,Ye("disableProviderPing")))}}class XS{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(this.chainId=t,!this.httpProviders[t]){const n=i||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(Ur.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{const n=this.getCardanoRPCUrl(i);t[i]=this.createHttpProvider(i,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}getCardanoRPCUrl(t){const i=this.namespace.rpcMap;if(i)return i[t]}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||this.getCardanoRPCUrl(t);return typeof n>"u"?void 0:new Zr(new Jr(n,Ye("disableProviderPing")))}}class eI{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(!this.httpProviders[t]){const n=i||Jt(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.chainId=t,this.events.emit(Ur.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;t[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||Jt(t,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Zr(new Jr(n,Ye("disableProviderPing")))}}class tI{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Ye("events"),this.client=Ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,i){if(!this.httpProviders[t]){const n=i||Jt(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.chainId=t,this.events.emit(Ur.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(i=>{var n;t[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,i=this.httpProviders[t];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return i}setHttpProvider(t,i){const n=this.createHttpProvider(t,i);n&&(this.httpProviders[t]=n)}createHttpProvider(t,i){const n=i||Jt(t,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Zr(new Jr(n,Ye("disableProviderPing")))}}var rI=Object.defineProperty,iI=Object.defineProperties,nI=Object.getOwnPropertyDescriptors,Ml=Object.getOwnPropertySymbols,sI=Object.prototype.hasOwnProperty,oI=Object.prototype.propertyIsEnumerable,Fl=(o,t,i)=>t in o?rI(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,Yn=(o,t)=>{for(var i in t||(t={}))sI.call(t,i)&&Fl(o,i,t[i]);if(Ml)for(var i of Ml(t))oI.call(t,i)&&Fl(o,i,t[i]);return o},ea=(o,t)=>iI(o,nI(t));class $a{constructor(t){this.events=new ya,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:us(hs({level:(t==null?void 0:t.logger)||Ul})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const i=new $a(t);return await i.initialize(),i}async request(t,i){const[n,a]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:Yn({},t),chainId:`${n}:${a}`,topic:this.session.topic})}sendAsync(t,i,n){this.request(t,n).then(a=>i(null,a)).catch(a=>i(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:xl("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,i){this.events.on(t,i)}once(t,i){this.events.once(t,i)}removeListener(t,i){this.events.removeListener(t,i)}off(t,i){this.events.off(t,i)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await a().then(h=>{this.session=h,this.namespaces||(this.namespaces=GS(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==Df)throw h;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,i){try{if(!this.session)return;const[n,a]=this.validateChain(t);this.getProvider(n).setDefaultChain(a,i)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if($l(i)){for(const n of i)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await RS.init({logger:this.providerOpts.logger||Ul,relayUrl:this.providerOpts.relayUrl||DS,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(i=>es(i)))];Xo("client",this.client),Xo("events",this.events),Xo("disableProviderPing",this.disableProviderPing),t.forEach(i=>{if(!this.session)return;const n=BS(i,this.session),a=qf(n),h=KS(this.namespaces,this.optionalNamespaces),p=ea(Yn({},h[i]),{accounts:n,chains:a});switch(i){case"eip155":this.rpcProviders[i]=new JS({namespace:p});break;case"solana":this.rpcProviders[i]=new YS({namespace:p});break;case"cosmos":this.rpcProviders[i]=new ZS({namespace:p});break;case"polkadot":this.rpcProviders[i]=new QS({namespace:p});break;case"cip34":this.rpcProviders[i]=new XS({namespace:p});break;case"elrond":this.rpcProviders[i]=new eI({namespace:p});break;case"multiversx":this.rpcProviders[i]=new tI({namespace:p});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:i}=t,{event:n}=i;if(n.name==="accountsChanged"){const a=n.data;a&&$l(a)&&this.events.emit("accountsChanged",a.map(WS))}else n.name==="chainChanged"?this.onChainChanged(i.chainId):this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:i})=>{var n;const{namespaces:a}=i,h=(n=this.client)==null?void 0:n.session.get(t);this.session=ea(Yn({},h),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:i})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",ea(Yn({},xl("USER_DISCONNECTED")),{data:t.topic}))}),this.on(Ur.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var i;this.getProvider(t).updateNamespace((i=this.session)==null?void 0:i.namespaces[t])})}setNamespaces(t){const{namespaces:i,optionalNamespaces:n,sessionProperties:a}=t;i&&Object.keys(i).length&&(this.namespaces=i),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=a,this.persist("namespaces",i),this.persist("optionalNamespaces",n)}validateChain(t){const[i,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,n];if(i&&!Object.keys(this.namespaces||{}).map(p=>es(p)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&n)return[i,n];const a=es(Object.keys(this.namespaces)[0]),h=this.rpcProviders[a].getDefaultChain();return[a,h]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,i=!1){var n;if(!this.namespaces)return;const[a,h]=this.validateChain(t);i||this.getProvider(a).setDefaultChain(h),((n=this.namespaces[a])!=null?n:this.namespaces[`${a}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,i){this.client.core.storage.setItem(`${Dl}/${t}`,i)}async getFromStore(t){return await this.client.core.storage.getItem(`${Dl}/${t}`)}}const aI=$a,cI="wc",uI="ethereum_provider",hI=`${cI}@2:${uI}:`,lI="https://rpc.walletconnect.com/v1/",la=["eth_sendTransaction","personal_sign"],fI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],fa=["chainChanged","accountsChanged"],dI=["message","disconnect","connect"];var pI=Object.defineProperty,gI=Object.defineProperties,yI=Object.getOwnPropertyDescriptors,zl=Object.getOwnPropertySymbols,mI=Object.prototype.hasOwnProperty,vI=Object.prototype.propertyIsEnumerable,kl=(o,t,i)=>t in o?pI(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i,Gi=(o,t)=>{for(var i in t||(t={}))mI.call(t,i)&&kl(o,i,t[i]);if(zl)for(var i of zl(t))vI.call(t,i)&&kl(o,i,t[i]);return o},Hl=(o,t)=>gI(o,yI(t));function os(o){return Number(o[0].split(":")[1])}function ta(o){return`0x${o.toString(16)}`}function wI(o){const{chains:t,optionalChains:i,methods:n,optionalMethods:a,events:h,optionalEvents:p,rpcMap:d}=o;if(!ra(t))throw new Error("Invalid chains");const v={chains:t,methods:n||la,events:h||fa,rpcMap:Gi({},t.length?{[os(t)]:d[os(t)]}:{})},S=h==null?void 0:h.filter(A=>!fa.includes(A)),I=n==null?void 0:n.filter(A=>!la.includes(A));if(!i&&!p&&!a&&!(S!=null&&S.length)&&!(I!=null&&I.length))return{required:t.length?v:void 0};const R=(S==null?void 0:S.length)&&(I==null?void 0:I.length)||!i,x={chains:[...new Set(R?v.chains.concat(i||[]):i)],methods:[...new Set(v.methods.concat(a!=null&&a.length?a:fI))],events:[...new Set(v.events.concat(p||dI))],rpcMap:d};return{required:t.length?v:void 0,optional:i.length?x:void 0}}class Ff{constructor(){this.events=new nr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=hI,this.on=(t,i)=>(this.events.on(t,i),this),this.once=(t,i)=>(this.events.once(t,i),this),this.removeListener=(t,i)=>(this.events.removeListener(t,i),this),this.off=(t,i)=>(this.events.off(t,i),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const i=new Ff;return await i.initialize(t),i}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,i){this.signer.sendAsync(t,i,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:i,optional:n}=wI(this.rpc);try{const a=await new Promise(async(p,d)=>{var v;this.rpc.showQrModal&&((v=this.modal)==null||v.subscribeModal(S=>{!S.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),d(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Hl(Gi({namespaces:Gi({},i&&{[this.namespace]:i})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(S=>{p(S)}).catch(S=>{d(new Error(S.message))})});if(!a)return;this.setChainIds(this.rpc.chains);const h=Gw(a.namespaces,[this.namespace]);this.setAccounts(h),this.events.emit("connect",{chainId:ta(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:i}=t,{event:n}=i;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const i=parseInt(t);this.chainId=i,this.events.emit("chainChanged",ta(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Hl(Gi({},Jw("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var i,n;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const i=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",ta(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const i=this.parseChainId(t);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(t){const[i,n,a]=t.split(":");return{chainId:`${i}:${n}`,address:a}}setAccounts(t){this.accounts=t.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var i,n;const a=(i=t==null?void 0:t.chains)!=null?i:[],h=(n=t==null?void 0:t.optionalChains)!=null?n:[],p=a.concat(h);if(!p.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const d=a.length?(t==null?void 0:t.methods)||la:[],v=a.length?(t==null?void 0:t.events)||fa:[],S=(t==null?void 0:t.optionalMethods)||[],I=(t==null?void 0:t.optionalEvents)||[],R=(t==null?void 0:t.rpcMap)||this.buildRpcMap(p,t.projectId),x=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(A=>this.formatChainId(A)),optionalChains:h.map(A=>this.formatChainId(A)),methods:d,events:v,optionalMethods:S,optionalEvents:I,rpcMap:R,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:x,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,i){const n={};return t.forEach(a=>{n[a]=this.getRpcUrl(a,i)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?os(this.rpc.chains):os(this.rpc.optionalChains),this.signer=await aI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const{WalletConnectModal:n}=await Ew(()=>import("./CE5scWAc.js").then(a=>a.i),__vite__mapDeps([0,1,2,3]),import.meta.url);i=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(Gi({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:i,optionalChains:n,rpcMap:a}=t;i&&ra(i)&&(this.rpc.chains=i.map(h=>this.formatChainId(h)),i.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)})),n&&ra(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(h=>this.formatChainId(h)),n.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)}))}getRpcUrl(t,i){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${lI}?chainId=eip155:${t}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:i==null?void 0:i.accounts),this.setAccounts(i==null?void 0:i.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(i=>this.parseAccount(i))}}export{dI as OPTIONAL_EVENTS,fI as OPTIONAL_METHODS,fa as REQUIRED_EVENTS,la as REQUIRED_METHODS,Ff as default};

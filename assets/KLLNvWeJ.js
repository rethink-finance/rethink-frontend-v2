import{_ as J}from"./Dl5sfn4-.js";import{u as K,d as Y,C as B,P as q,e as b,f as S,g as z,h as G}from"./CL_pIM7N.js";import{h as H}from"./DmMfJ0RA.js";import{d as Q,d7 as U,r as w,h as X,d1 as Z,cf as V,f as n,p as t,a as m,cF as x,c8 as c,e as l,cB as E,cY as $,b as F,l as ee,o as s,_ as ae}from"./D3HDfnxy.js";import"./COuEhvrh.js";import"./C8Z2lGgf.js";import"./CJiquoOh.js";import"./BFVrtpKD.js";import"./DPhX8wWY.js";import"./DWe-URJs.js";import"./8pzO0o2T.js";import"./CH598blW.js";import"./CMDKgJFj.js";import"./Ce8rn2uW.js";import"./DAa023eC.js";import"./BqVuMM-N.js";import"./B2xZHB7-.js";import"./D-HsWzDh.js";import"./DkcdTJJR.js";import"./cVa1OdO9.js";const oe={key:0},te={key:1},ne={key:0,class:"text-success"},se={key:1,class:"text-success"},de={key:2,class:"text-error"},ce={key:2},le={class:"ms-2"},re={key:0,class:"d-flex align-center"},ie={key:1},pe={key:3,class:"permissions__list flex-grow-1"},me={key:4},ue=Q({__name:"ProposalPermissionEntry",props:{functionName:{},calldataDecoded:{},chainId:{}},setup(R){const T=K(),a=R;U("chainId",a.chainId);const I=w([]),P=w(!1),L=w([]),_=w(),p=w(void 0),M=e=>{var o;return e!==((o=a.calldataDecoded)==null?void 0:o.functionSig)?{sighash:e,type:B.BLOCKED,executionOption:G.NONE,params:[]}:W.value},W=X(()=>{var o,d,A,u,f,g,D,y,v,h,N,r,k,C,O;const e={sighash:(o=a.calldataDecoded)==null?void 0:o.functionSig,type:B.SCOPED,executionOption:Y[(d=a.calldataDecoded)==null?void 0:d.options],params:[]};if(console.log("functionName",a.functionName,a.calldataDecoded),a.functionName==="scopeParameterAsOneOf")e.params=[{index:(A=a.calldataDecoded)==null?void 0:A.paramIndex,type:b[(u=a.calldataDecoded)==null?void 0:u.paramType],condition:q.ONE_OF,value:(f=a.calldataDecoded)==null?void 0:f.compValues}];else if(a.functionName==="scopeParameter")e.params=[{index:(g=a.calldataDecoded)==null?void 0:g.paramIndex,type:b[(D=a.calldataDecoded)==null?void 0:D.paramType],condition:S[(y=a.calldataDecoded)==null?void 0:y.paramComp],value:[(v=a.calldataDecoded)==null?void 0:v.compValue]}];else if(a.functionName==="scopeFunction")for(let i=0;i<((N=(h=a.calldataDecoded)==null?void 0:h.compValue)==null?void 0:N.length);i++)(r=a.calldataDecoded)!=null&&r.isParamScoped[i]&&e.params.push({index:i,type:b[(k=a.calldataDecoded)==null?void 0:k.paramType[i]],condition:S[(C=a.calldataDecoded)==null?void 0:C.paramComp[i]],value:[(O=a.calldataDecoded)==null?void 0:O.compValue[i]]});else a.functionName;return console.warn("COND: ",Z(e)),e}),j=async()=>{var o;if(p.value=void 0,Object.keys(a.calldataDecoded).length===0)return;const e=(o=a.calldataDecoded)==null?void 0:o.targetAddress;if(I.value=[],!(!e||!a.chainId)){P.value=!0;try{const d=await T.fetchAddressSourceCode(a.chainId,e);I.value=(d==null?void 0:d.ABI)||[],P.value=!1}catch(d){P.value=!1,console.error("Something went wrong fetching target ABI.",d)}T.getAddressLabel(e,a.chainId).then(d=>p.value=d)}};return V(()=>a.calldataDecoded,e=>{j()},{immediate:!0}),V(()=>I.value,()=>{const e=z(I.value);L.value=e,console.log(e),_.value=e==null?void 0:e.find(o=>o.selector===a.calldataDecoded.functionSig)},{immediate:!0,deep:!0}),(e,o)=>{var u,f,g,D,y,v,h,N;const d=ee("Icon"),A=J;return e.functionName=="scopeTarget"?(s(),n("div",oe,[o[0]||(o[0]=t(" Restricted access to target ")),m("strong",null,c((u=e.calldataDecoded)==null?void 0:u.targetAddress),1),l(p)?(s(),n(E,{key:0},[t(" ("+c(l(p))+") ",1)],64)):x("",!0),o[1]||(o[1]=t(". Only scoped functions are now allowed. "))])):e.functionName==="allowTarget"?(s(),n("p",te,[o[4]||(o[4]=t(" Role was ")),((f=e.calldataDecoded)==null?void 0:f.options)==1?(s(),n("span",ne,o[2]||(o[2]=[t(" granted "),m("strong",null,"call",-1),t(" access ")]))):((g=e.calldataDecoded)==null?void 0:g.options)==2?(s(),n("span",se,o[3]||(o[3]=[t(" granted "),m("strong",null,"delegatecall",-1),t(" access ")]))):(s(),n("strong",de," denied access ")),o[5]||(o[5]=t(" to contract ")),m("strong",null,c((D=e.calldataDecoded)==null?void 0:D.targetAddress),1),l(p)?(s(),n(E,{key:3},[t(" ("+c(l(p))+") ",1)],64)):x("",!0),o[6]||(o[6]=t(". "))])):e.functionName==="assignRoles"||e.functionName==="grantRoles"?(s(),n("div",ce,[o[7]||(o[7]=t(" Edit roles for ")),m("strong",null,c((y=e.calldataDecoded)==null?void 0:y.module),1),o[8]||(o[8]=t(": ")),m("div",le,[(s(!0),n(E,null,$(((h=(v=e.calldataDecoded)==null?void 0:v.memberOf)==null?void 0:h.length)||0,r=>{var k,C,O;return s(),n("div",{key:r},[(k=e.calldataDecoded)!=null&&k.memberOf[r-1]?(s(),n("span",re,[F(d,{icon:"octicon:check-circle-16",height:"1.2rem",width:"1.2rem",class:"text-success"}),t(" Added Role "+c((C=e.calldataDecoded)==null?void 0:C._roles[r-1]),1)])):(s(),n("span",ie,[F(d,{icon:"octicon:x-circle-16",class:"text-error",height:"1.2rem",width:"1.2rem"}),t(" Removed Role "+c((O=e.calldataDecoded)==null?void 0:O._roles[r-1]),1)]))])}),128))])])):(N=l(_))!=null&&N.selector?(s(),n("div",pe,[F(A,{func:l(_),disabled:"","func-conditions":M(l(_).selector),"only-show-condition-params":""},null,8,["func","func-conditions"])])):(s(),n("div",me,c(l(H)(e.calldataDecoded)),1))}}}),Se=ae(ue,[["__scopeId","data-v-bd0c1c82"]]);export{Se as default};

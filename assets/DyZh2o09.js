import B from"./DXxM2RMs.js";import{_ as k}from"./BhipA0pl.js";import{d as q,c9 as g,r as m,h as C,ca as D,d8 as N,f as M,b as n,c as U,w as _,e as l,a as f,V as E,p as H,i as P,c8 as J,o as A,_ as O}from"./D3HDfnxy.js";import{i as W,j,A as $}from"./CL_pIM7N.js";import{P as z}from"./DmMfJ0RA.js";import{V as h}from"./D3jptR6C.js";import{b as G}from"./C8Z2lGgf.js";const K={class:"add_from_library"},Q={class:"main_header__title"},X={class:"subtitle_steel_blue mb-0"},Y={key:0,class:"mt-4"},Z=q({__name:"AddFromLibrary",props:{chainId:{type:String,required:!0},fundAddress:{type:String,required:!0},safeAddress:{type:String,required:!0},baseDecimals:{type:Number,required:!0},baseSymbol:{type:String,required:!0},isFundNonInit:{type:Boolean,default:!1},alreadyUsedMethods:{type:Array,required:!0}},emits:["methods-added"],setup(a,{emit:F}){const I=F,r=a,w=W(),i=j(),{allNavMethods:S}=g(i),{uniqueNavMethods:x}=g(i),p=m(!1),c=m([]),u=m(""),b=m([]),R=C(()=>w.isActionState("fetchFundsNavMethodsAction",$.Loading)),V=s=>{c.value=s},T=()=>{const s=b.value.filter(e=>c.value.includes(e.detailsHash||""));I("methods-added",s)};D(async()=>{if(console.warn("fetch all nav methods",S.value[r.chainId]),!S.value[r.chainId].length){p.value=!0;const s=await i.fetchFundsInfoArrays(r.chainId);try{await i.fetchFundsNavMethods(r.chainId,s)}catch(e){console.error("Failed fetchFundsNavMethods",e)}p.value=!1}L()});const L=()=>{console.warn("setLibraryNavMethods",R.value),b.value=x.value[r.chainId].map(s=>{console.log("originalNavEntry",s);const e=JSON.parse(JSON.stringify(s));return e.positionType===z.Composable&&(console.warn("navEntry Composable: ",e),e.details.composable=e.details.composable.map(t=>{console.warn("composable: ",t);const d=e.pastNAVUpdateEntrySafeAddress,o=r.safeAddress;console.log("[ADD_LIB1] safeAddressToReplace",d),console.log("[ADD_LIB2] safeAddressReplacement",o);let y="",v="";return d&&o?(y=N("address",d).replace("0x",""),console.log("encodedSafeAddressToReplace",y),v=N("address",o).replace("0x",""),console.log("encodedSafeAddressReplacement",v)):(!d&&o&&console.warn("no safeAddressToReplace",d,t),!o&&d&&console.warn("no safeAddressReplacement",o,t)),{...t,encodedFunctionSignatureWithInputs:t.encodedFunctionSignatureWithInputs.replace(y,v)}})),e})};return(s,e)=>{const t=B,d=k;return A(),M("div",K,[n(t,null,{default:_(()=>[e[2]||(e[2]=f("div",{class:"main_header__title"}," Add From Library ",-1)),f("div",null,[n(E,{class:"bg-primary text-secondary",disabled:!l(c).length,onClick:T},{default:_(()=>e[1]||(e[1]=[H(" Add Methods ")])),_:1},8,["disabled"])])]),_:1}),n(t,null,{default:_(()=>[f("div",Q,[n(G,{modelValue:l(u),"onUpdate:modelValue":e[0]||(e[0]=o=>P(u)?u.value=o:null),label:"Search","prepend-inner-icon":"mdi-magnify",variant:"outlined","hide-details":"","single-line":"",class:"search"},null,8,["modelValue"])]),f("div",X,J(l(c).length)+" selected ",1)]),_:1}),l(p)?(A(),M("div",Y,[n(h,{type:"table-row"}),n(h,{type:"table-row"}),n(h,{type:"table-row"}),n(h,{type:"table-row"})])):(A(),U(d,{key:1,methods:l(b),"used-methods":a.alreadyUsedMethods,"fund-chain-id":a.chainId,"fund-address":a.fundAddress,"safe-address":a.safeAddress,"base-symbol":a.baseSymbol,"base-decimals":a.baseDecimals,"is-fund-non-init":a.isFundNonInit,selectable:"",search:l(u),"show-simulated-nav":"",idx:"addFromLibrary",onSelectedChanged:V},null,8,["methods","used-methods","fund-chain-id","fund-address","safe-address","base-symbol","base-decimals","is-fund-non-init","search"]))])}}}),re=O(Z,[["__scopeId","data-v-a0bd4f1d"]]);export{re as _};

import{O as ge,P as g,cl as Oe,ct as Ae,fv as E,n as O,dy as Y,dJ as pt,k as Le,t as lt,Z as me,d1 as J,fx as K,fB as yt,fC as _e,d5 as qe,d6 as Ge,fD as ct,ez as mt,fE as ft,c_ as fe,fF as He,ey as We,cZ as ve,fG as xe,fH as Tt,fI as bt,fJ as De,u as ht}from"./D3HDfnxy.js";import{D as gt,E as At,G as vt,b as Te,u as ee,n as Ce,P as M,H as Nt,x as St,I as Ue,J as ce,z as Ft,d as te,K as Mt,y as Q,L as wt,w as Et,f as xt,M as Dt,O as Ct,F as R}from"./DmMfJ0RA.js";import{u as $e}from"./DkcdTJJR.js";import{I as k}from"./cVa1OdO9.js";import{f as D}from"./Ce8rn2uW.js";const ne=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_value",type:"uint256"}],name:"burn",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_value",type:"uint256"}],name:"burnFrom",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"},{name:"_extraData",type:"bytes"}],name:"approveAndCall",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"",type:"address"},{name:"",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[{name:"initialSupply",type:"uint256"},{name:"tokenName",type:"string"},{name:"tokenSymbol",type:"string"}],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Burn",type:"event"}],Ut={abi:[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"Empty",type:"error"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"version",type:"uint8"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint64",name:"oldVoteExtension",type:"uint64"},{indexed:!1,internalType:"uint64",name:"newVoteExtension",type:"uint64"}],name:"LateQuorumVoteExtensionSet",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"proposalId",type:"uint256"}],name:"ProposalCanceled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"proposalId",type:"uint256"},{indexed:!1,internalType:"address",name:"proposer",type:"address"},{indexed:!1,internalType:"address[]",name:"targets",type:"address[]"},{indexed:!1,internalType:"uint256[]",name:"values",type:"uint256[]"},{indexed:!1,internalType:"string[]",name:"signatures",type:"string[]"},{indexed:!1,internalType:"bytes[]",name:"calldatas",type:"bytes[]"},{indexed:!1,internalType:"uint256",name:"voteStart",type:"uint256"},{indexed:!1,internalType:"uint256",name:"voteEnd",type:"uint256"},{indexed:!1,internalType:"string",name:"description",type:"string"}],name:"ProposalCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"proposalId",type:"uint256"}],name:"ProposalExecuted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"proposalId",type:"uint256"},{indexed:!1,internalType:"uint64",name:"extendedDeadline",type:"uint64"}],name:"ProposalExtended",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"proposalId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"eta",type:"uint256"}],name:"ProposalQueued",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"oldQuorumNumerator",type:"uint256"},{indexed:!1,internalType:"uint256",name:"newQuorumNumerator",type:"uint256"}],name:"QuorumNumeratorUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"oldTimelock",type:"address"},{indexed:!1,internalType:"address",name:"newTimelock",type:"address"}],name:"TimelockChange",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"voter",type:"address"},{indexed:!1,internalType:"uint256",name:"proposalId",type:"uint256"},{indexed:!1,internalType:"uint8",name:"support",type:"uint8"},{indexed:!1,internalType:"uint256",name:"weight",type:"uint256"},{indexed:!1,internalType:"string",name:"reason",type:"string"}],name:"VoteCast",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"voter",type:"address"},{indexed:!1,internalType:"uint256",name:"proposalId",type:"uint256"},{indexed:!1,internalType:"uint8",name:"support",type:"uint8"},{indexed:!1,internalType:"uint256",name:"weight",type:"uint256"},{indexed:!1,internalType:"string",name:"reason",type:"string"},{indexed:!1,internalType:"bytes",name:"params",type:"bytes"}],name:"VoteCastWithParams",type:"event"},{inputs:[],name:"BALLOT_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"CLOCK_MODE",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"COUNTING_MODE",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"pure",type:"function"},{inputs:[],name:"EXTENDED_BALLOT_TYPEHASH",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"targets",type:"address[]"},{internalType:"uint256[]",name:"values",type:"uint256[]"},{internalType:"bytes[]",name:"calldatas",type:"bytes[]"},{internalType:"bytes32",name:"descriptionHash",type:"bytes32"}],name:"cancel",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"},{internalType:"uint8",name:"support",type:"uint8"}],name:"castVote",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"},{internalType:"uint8",name:"support",type:"uint8"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"castVoteBySig",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"},{internalType:"uint8",name:"support",type:"uint8"},{internalType:"string",name:"reason",type:"string"}],name:"castVoteWithReason",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"},{internalType:"uint8",name:"support",type:"uint8"},{internalType:"string",name:"reason",type:"string"},{internalType:"bytes",name:"params",type:"bytes"}],name:"castVoteWithReasonAndParams",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"},{internalType:"uint8",name:"support",type:"uint8"},{internalType:"string",name:"reason",type:"string"},{internalType:"bytes",name:"params",type:"bytes"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"castVoteWithReasonAndParamsBySig",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"clock",outputs:[{internalType:"uint48",name:"",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"targets",type:"address[]"},{internalType:"uint256[]",name:"values",type:"uint256[]"},{internalType:"bytes[]",name:"calldatas",type:"bytes[]"},{internalType:"bytes32",name:"descriptionHash",type:"bytes32"}],name:"execute",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"getVotes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"timepoint",type:"uint256"},{internalType:"bytes",name:"params",type:"bytes"}],name:"getVotesWithParams",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"},{internalType:"address",name:"account",type:"address"}],name:"hasVoted",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"targets",type:"address[]"},{internalType:"uint256[]",name:"values",type:"uint256[]"},{internalType:"bytes[]",name:"calldatas",type:"bytes[]"},{internalType:"bytes32",name:"descriptionHash",type:"bytes32"}],name:"hashProposal",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"contract IVotesUpgradeable",name:"_token",type:"address"},{internalType:"string",name:"_govName",type:"string"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"lateQuorumVoteExtension",outputs:[{internalType:"uint64",name:"",type:"uint64"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC1155BatchReceived",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC1155Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC721Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"}],name:"proposalDeadline",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"}],name:"proposalEta",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"}],name:"proposalProposer",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"}],name:"proposalSnapshot",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"proposalThreshold",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"}],name:"proposalVotes",outputs:[{internalType:"uint256",name:"againstVotes",type:"uint256"},{internalType:"uint256",name:"forVotes",type:"uint256"},{internalType:"uint256",name:"abstainVotes",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"targets",type:"address[]"},{internalType:"uint256[]",name:"values",type:"uint256[]"},{internalType:"bytes[]",name:"calldatas",type:"bytes[]"},{internalType:"string",name:"description",type:"string"}],name:"propose",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"targets",type:"address[]"},{internalType:"uint256[]",name:"values",type:"uint256[]"},{internalType:"bytes[]",name:"calldatas",type:"bytes[]"},{internalType:"bytes32",name:"descriptionHash",type:"bytes32"}],name:"queue",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"quorum",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"quorumDenominator",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"quorumNumerator",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"quorumNumerator",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"target",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"relay",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint64",name:"newVoteExtension",type:"uint64"}],name:"setLateQuorumVoteExtension",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"proposalId",type:"uint256"}],name:"state",outputs:[{internalType:"enum IGovernorUpgradeable.ProposalState",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"timelock",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"token",outputs:[{internalType:"contract IERC5805Upgradeable",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"newQuorumNumerator",type:"uint256"}],name:"updateQuorumNumerator",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract TimelockControllerUpgradeable",name:"newTimelock",type:"address"}],name:"updateTimelock",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"version",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"votingDelay",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[],name:"votingPeriod",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{stateMutability:"payable",type:"receive"}]};var _=(e=>(e.Idle="idle",e.Loading="loading",e.Success="success",e.Error="error",e))(_||{});const Vt=ge("actionState",{state:()=>({loadingStates:{}}),getters:{isActionState:e=>(t,n)=>e.loadingStates[t]===n,isActionStateLoading:e=>t=>e.loadingStates[t]===_.Loading,getActionState:e=>t=>e.loadingStates[t]},actions:{setActionState(e,t){this.loadingStates[e]=t}}});async function h(e,t,n=!1){const a=Vt();if(n&&a.isActionState(e,_.Loading)){console.warn(`Action "${e}" is already in progress.`);return}a.setActionState(e,_.Loading);try{const s=await t();return a.setActionState(e,_.Success),s}catch(s){throw console.error(`Error in action "${e}":`,s),a.setActionState(e,_.Error),s}}const L={abi:[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"delegator",type:"address"},{indexed:!0,internalType:"address",name:"fromDelegate",type:"address"},{indexed:!0,internalType:"address",name:"toDelegate",type:"address"}],name:"DelegateChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"delegate",type:"address"},{indexed:!1,internalType:"uint256",name:"previousBalance",type:"uint256"},{indexed:!1,internalType:"uint256",name:"newBalance",type:"uint256"}],name:"DelegateVotesChanged",type:"event"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"version",type:"uint8"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"FundSettings",outputs:[{internalType:"uint256",name:"depositFee",type:"uint256"},{internalType:"uint256",name:"withdrawFee",type:"uint256"},{internalType:"uint256",name:"performanceFee",type:"uint256"},{internalType:"uint256",name:"managementFee",type:"uint256"},{internalType:"uint256",name:"performaceHurdleRateBps",type:"uint256"},{internalType:"address",name:"baseToken",type:"address"},{internalType:"address",name:"safe",type:"address"},{internalType:"bool",name:"isExternalGovTokenInUse",type:"bool"},{internalType:"bool",name:"isWhitelistedDeposits",type:"bool"},{internalType:"address",name:"governanceToken",type:"address"},{internalType:"address",name:"fundAddress",type:"address"},{internalType:"address",name:"governor",type:"address"},{internalType:"string",name:"fundName",type:"string"},{internalType:"string",name:"fundSymbol",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"_feeBal",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"_navUpdateLatestIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"_navUpdateLatestTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"_totalDepositBal",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint32",name:"pos",type:"uint32"}],name:"checkpoints",outputs:[{components:[{internalType:"uint32",name:"fromBlock",type:"uint32"},{internalType:"uint224",name:"votes",type:"uint224"}],internalType:"struct ERC20VotesUpgradeable.Checkpoint",name:"",type:"tuple"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"delegatee",type:"address"}],name:"delegate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"delegatee",type:"address"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"expiry",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"delegateBySig",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"delegates",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"feeManagePeriod",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"feePerformancePeriod",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"fundMetadata",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"getCurrentPendingDepositBal",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"getCurrentPendingWithdrawalBal",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"enum IGovernableFundStorage.FundFeeType",name:"feeType",type:"uint8"}],name:"getFeeCollector",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"getFundSettings",outputs:[{components:[{internalType:"uint256",name:"depositFee",type:"uint256"},{internalType:"uint256",name:"withdrawFee",type:"uint256"},{internalType:"uint256",name:"performanceFee",type:"uint256"},{internalType:"uint256",name:"managementFee",type:"uint256"},{internalType:"uint256",name:"performaceHurdleRateBps",type:"uint256"},{internalType:"address",name:"baseToken",type:"address"},{internalType:"address",name:"safe",type:"address"},{internalType:"bool",name:"isExternalGovTokenInUse",type:"bool"},{internalType:"bool",name:"isWhitelistedDeposits",type:"bool"},{internalType:"address[]",name:"allowedDepositAddrs",type:"address[]"},{internalType:"address[]",name:"allowedManagers",type:"address[]"},{internalType:"address",name:"governanceToken",type:"address"},{internalType:"address",name:"fundAddress",type:"address"},{internalType:"address",name:"governor",type:"address"},{internalType:"string",name:"fundName",type:"string"},{internalType:"string",name:"fundSymbol",type:"string"},{internalType:"address[4]",name:"feeCollectors",type:"address[4]"}],internalType:"struct IGovernableFundStorage.Settings",name:"",type:"tuple"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"getFundStartTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"getNavEntry",outputs:[{components:[{internalType:"enum IGovernableFundStorage.NavUpdateType",name:"entryType",type:"uint8"},{components:[{internalType:"address",name:"tokenPair",type:"address"},{internalType:"address",name:"aggregatorAddress",type:"address"},{internalType:"bytes",name:"functionSignatureWithEncodedInputs",type:"bytes"},{internalType:"address",name:"assetTokenAddress",type:"address"},{internalType:"address",name:"nonAssetTokenAddress",type:"address"},{internalType:"bool",name:"isReturnArray",type:"bool"},{internalType:"uint256",name:"returnLength",type:"uint256"},{internalType:"uint256",name:"returnIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"}],internalType:"struct IGovernableFundStorage.NAVLiquidUpdate[]",name:"liquid",type:"tuple[]"},{components:[{internalType:"uint256",name:"baseCurrencySpent",type:"uint256"},{internalType:"uint256",name:"amountAquiredTokens",type:"uint256"},{internalType:"address",name:"tokenAddress",type:"address"},{internalType:"bool",name:"isNFT",type:"bool"},{internalType:"string[]",name:"otcTxHashes",type:"string[]"},{internalType:"enum IGovernableFundStorage.NAVNFTType",name:"nftType",type:"uint8"},{internalType:"uint256",name:"nftIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"}],internalType:"struct IGovernableFundStorage.NAVIlliquidUpdate[]",name:"illiquid",type:"tuple[]"},{components:[{internalType:"address",name:"oracleAddress",type:"address"},{internalType:"address",name:"nftAddress",type:"address"},{internalType:"enum IGovernableFundStorage.NAVNFTType",name:"nftType",type:"uint8"},{internalType:"uint256",name:"nftIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"}],internalType:"struct IGovernableFundStorage.NAVNFTUpdate[]",name:"nft",type:"tuple[]"},{components:[{internalType:"address",name:"remoteContractAddress",type:"address"},{internalType:"string",name:"functionSignatures",type:"string"},{internalType:"bytes",name:"encodedFunctionSignatureWithInputs",type:"bytes"},{internalType:"uint256",name:"normalizationDecimals",type:"uint256"},{internalType:"bool",name:"isReturnArray",type:"bool"},{internalType:"uint256",name:"returnValIndex",type:"uint256"},{internalType:"uint256",name:"returnArraySize",type:"uint256"},{internalType:"enum IGovernableFundStorage.NAVComposableUpdateReturnType",name:"returnValType",type:"uint8"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"},{internalType:"bool",name:"isNegative",type:"bool"}],internalType:"struct IGovernableFundStorage.NAVComposableUpdate[]",name:"composable",type:"tuple[]"},{internalType:"bool",name:"isPastNAVUpdate",type:"bool"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateEntryIndex",type:"uint256"},{internalType:"string",name:"description",type:"string"}],internalType:"struct IGovernableFundStorage.NavUpdateEntry[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"uint256",name:"start",type:"uint256"},{internalType:"uint256",name:"end",type:"uint256"}],name:"getNavUpdateTime",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"getPastTotalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"getPastVotes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getVotes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"numCheckpoints",outputs:[{internalType:"uint32",name:"",type:"uint32"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_name_",type:"string"},{internalType:"string",name:"_symbol_",type:"string"},{components:[{internalType:"uint256",name:"depositFee",type:"uint256"},{internalType:"uint256",name:"withdrawFee",type:"uint256"},{internalType:"uint256",name:"performanceFee",type:"uint256"},{internalType:"uint256",name:"managementFee",type:"uint256"},{internalType:"uint256",name:"performaceHurdleRateBps",type:"uint256"},{internalType:"address",name:"baseToken",type:"address"},{internalType:"address",name:"safe",type:"address"},{internalType:"bool",name:"isExternalGovTokenInUse",type:"bool"},{internalType:"bool",name:"isWhitelistedDeposits",type:"bool"},{internalType:"address[]",name:"allowedDepositAddrs",type:"address[]"},{internalType:"address[]",name:"allowedManagers",type:"address[]"},{internalType:"address",name:"governanceToken",type:"address"},{internalType:"address",name:"fundAddress",type:"address"},{internalType:"address",name:"governor",type:"address"},{internalType:"string",name:"fundName",type:"string"},{internalType:"string",name:"fundSymbol",type:"string"},{internalType:"address[4]",name:"feeCollectors",type:"address[4]"}],internalType:"struct IGovernableFundStorage.Settings",name:"_fundSettings",type:"tuple"},{internalType:"address",name:"navCalculatorAddress",type:"address"},{internalType:"address",name:"fundDelgateCallFlowAddress",type:"address"},{internalType:"address",name:"fundDelgateCallNavAddress",type:"address"},{internalType:"string",name:"_fundMetadata",type:"string"},{internalType:"uint256",name:"_feePerformancePeriod",type:"uint256"},{internalType:"uint256",name:"_feeManagePeriod",type:"uint256"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"clock",outputs:[{internalType:"uint48",name:"",type:"uint48"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"CLOCK_MODE",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"pure",type:"function",constant:!0},{inputs:[{components:[{internalType:"uint256",name:"depositFee",type:"uint256"},{internalType:"uint256",name:"withdrawFee",type:"uint256"},{internalType:"uint256",name:"performanceFee",type:"uint256"},{internalType:"uint256",name:"managementFee",type:"uint256"},{internalType:"uint256",name:"performaceHurdleRateBps",type:"uint256"},{internalType:"address",name:"baseToken",type:"address"},{internalType:"address",name:"safe",type:"address"},{internalType:"bool",name:"isExternalGovTokenInUse",type:"bool"},{internalType:"bool",name:"isWhitelistedDeposits",type:"bool"},{internalType:"address[]",name:"allowedDepositAddrs",type:"address[]"},{internalType:"address[]",name:"allowedManagers",type:"address[]"},{internalType:"address",name:"governanceToken",type:"address"},{internalType:"address",name:"fundAddress",type:"address"},{internalType:"address",name:"governor",type:"address"},{internalType:"string",name:"fundName",type:"string"},{internalType:"string",name:"fundSymbol",type:"string"},{internalType:"address[4]",name:"feeCollectors",type:"address[4]"}],internalType:"struct IGovernableFundStorage.Settings",name:"_fundSettings",type:"tuple"},{internalType:"string",name:"_fundMetadata",type:"string"},{internalType:"uint256",name:"_feePerformancePeriod",type:"uint256"},{internalType:"uint256",name:"_feeManagePeriod",type:"uint256"}],name:"updateSettings",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"enum IGovernableFundStorage.NavUpdateType",name:"entryType",type:"uint8"},{components:[{internalType:"address",name:"tokenPair",type:"address"},{internalType:"address",name:"aggregatorAddress",type:"address"},{internalType:"bytes",name:"functionSignatureWithEncodedInputs",type:"bytes"},{internalType:"address",name:"assetTokenAddress",type:"address"},{internalType:"address",name:"nonAssetTokenAddress",type:"address"},{internalType:"bool",name:"isReturnArray",type:"bool"},{internalType:"uint256",name:"returnLength",type:"uint256"},{internalType:"uint256",name:"returnIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"}],internalType:"struct IGovernableFundStorage.NAVLiquidUpdate[]",name:"liquid",type:"tuple[]"},{components:[{internalType:"uint256",name:"baseCurrencySpent",type:"uint256"},{internalType:"uint256",name:"amountAquiredTokens",type:"uint256"},{internalType:"address",name:"tokenAddress",type:"address"},{internalType:"bool",name:"isNFT",type:"bool"},{internalType:"string[]",name:"otcTxHashes",type:"string[]"},{internalType:"enum IGovernableFundStorage.NAVNFTType",name:"nftType",type:"uint8"},{internalType:"uint256",name:"nftIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"}],internalType:"struct IGovernableFundStorage.NAVIlliquidUpdate[]",name:"illiquid",type:"tuple[]"},{components:[{internalType:"address",name:"oracleAddress",type:"address"},{internalType:"address",name:"nftAddress",type:"address"},{internalType:"enum IGovernableFundStorage.NAVNFTType",name:"nftType",type:"uint8"},{internalType:"uint256",name:"nftIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"}],internalType:"struct IGovernableFundStorage.NAVNFTUpdate[]",name:"nft",type:"tuple[]"},{components:[{internalType:"address",name:"remoteContractAddress",type:"address"},{internalType:"string",name:"functionSignatures",type:"string"},{internalType:"bytes",name:"encodedFunctionSignatureWithInputs",type:"bytes"},{internalType:"uint256",name:"normalizationDecimals",type:"uint256"},{internalType:"bool",name:"isReturnArray",type:"bool"},{internalType:"uint256",name:"returnValIndex",type:"uint256"},{internalType:"uint256",name:"returnArraySize",type:"uint256"},{internalType:"enum IGovernableFundStorage.NAVComposableUpdateReturnType",name:"returnValType",type:"uint8"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"},{internalType:"bool",name:"isNegative",type:"bool"}],internalType:"struct IGovernableFundStorage.NAVComposableUpdate[]",name:"composable",type:"tuple[]"},{internalType:"bool",name:"isPastNAVUpdate",type:"bool"},{internalType:"uint256",name:"pastNAVUpdateIndex",type:"uint256"},{internalType:"uint256",name:"pastNAVUpdateEntryIndex",type:"uint256"},{internalType:"string",name:"description",type:"string"}],internalType:"struct IGovernableFundStorage.NavUpdateEntry[]",name:"navUpdateData",type:"tuple[]"},{internalType:"address[]",name:"pastNAVUpdateEntryFundAddress",type:"address[]"},{internalType:"bool",name:"processWithdraw",type:"bool"}],name:"updateNav",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"navExecutor",type:"address"}],name:"executeNAVUpdate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"flowCall",type:"bytes"}],name:"fundFlowsCall",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"totalWithrawalBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[{internalType:"uint8",name:"feeKind",type:"uint8"}],name:"calculateAccrued",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"enum IGovernableFundStorage.FundFeeType",name:"feeType",type:"uint8"}],name:"collectFees",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"toggleDaoFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"bps",type:"uint256"}],name:"setDaoFeeBps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"setDaoFeeAddr",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"ownr",type:"address"}],name:"valueOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0},{inputs:[],name:"totalNAV",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function",constant:!0}]},Bt={calculateMetrics:async(e,t)=>{const n=await Pt(t,e);e.sharePrice=n,e.cumulativeReturnPercent=At(void 0,n,e.baseToken.decimals,e.fundToken.decimals)}},Rt={calculateMetrics:async(e,t)=>{const n=t==null?void 0:t.timestamp,a=await Ot(e,t);console.debug("  [METRICS] lastNAVUpdateTotalDepositBalance",a);const s=e.baseToken.decimals;e.cumulativeReturnPercent=n?vt(a||0n,e.lastNAVUpdateTotalNAV||0n,s):0}},kt=e=>{const t={"0xabc961afc18dfe9f062cf9a8046346e92a934d08":Bt},n=e.address.toLowerCase();return n in t?t[n]:Rt},It=async e=>{if(!e){console.error("Error: this.fund is not available");return}try{const t=e.navUpdates,n=t[(t==null?void 0:t.length)-1],a=n==null?void 0:n.timestamp;console.debug("  [METRICS] title",e.title),console.debug("  [METRICS] totalDepositBalance",e.totalDepositBalance),console.debug("  [METRICS] fund.lastNAVUpdateTotalNAV",e.lastNAVUpdateTotalNAV),console.debug("  [METRICS] last NAV update",n),e&&(await kt(e).calculateMetrics(e,n),e.lastNAVUpdateTotalNAV=a?e.lastNAVUpdateTotalNAV:e.totalDepositBalance,e.isNavUpdatesLoading=!1,e.sharpeRatio=gt(t,e.totalDepositBalance))}catch(t){console.error("Error calculating fund performance metrics: ",e,t),e.isNavUpdatesLoading=!1}},Pt=async(e,t)=>{if(e!=null&&e.timestamp){const n=g(),a=$e(),s=await a.initializeBlockTimeContext(t.chainId,!1),i=(s==null?void 0:s.averageBlockTime)||0,r=Te(String(e.totalNAV||"0"),t==null?void 0:t.baseToken.decimals),o=Number(await a.getBlockByTimestamp(t.chainId,e.timestamp/1e3,i)||0);try{const d=await n.callWithRetry(t.chainId,()=>n.getCustomContract(t.chainId,ne,t.fundToken.address).methods.totalSupply().call({},o)),p=Te(String(d||"0"),t.fundToken.decimals),u=t.baseToken.decimals,l=t.fundToken.decimals,y=u-l,c=y>0?r*10n**BigInt(y):r,m=y<0?p*10n**BigInt(-y):p,T=10n**36n,A=p>0n?c*T/m:0n;return parseFloat(ee(A,36))}catch(d){console.error("Error getting share price",d);return}}return 0},Ot=async(e,t)=>{if(t!=null&&t.timestamp){const n=g();let a=0;const{$getExplorer:s}=Oe();try{a=await s(e.chainId).getBlockNumberFromTimestamp(t.timestamp/1e3)}catch(i){console.error("Error getting block number from timestamp",i)}console.debug("  [METRICS] lastNavUpdateBlockNumber from EXPLORER",a);try{return await n.callWithRetry(e.chainId,async()=>{const i=n.getCustomContract(e.chainId,L.abi,e.address);return BigInt(await i.methods._totalDepositBal().call({},a)||0)})}catch(i){return console.error("Error getting total deposit balance at last NAV update",i),null}}return null},Je=e=>{const t=(e==null?void 0:e.entries)||[],n=Ce.reduce((a,s)=>(a[s]=0n,a),{});if(t)for(const a of t)a.positionType===M.Composable?a.details.composable[0].functionSignatures.includes("illiquidCalc")?n[M.Illiquid]+=a.pastNavValue||0n:a.details.composable[0].functionSignatures.includes("liquidCalc")?n[M.Liquid]+=a.pastNavValue||0n:n[a.positionType]+=a.pastNavValue||0n:n[a.positionType]+=a.pastNavValue||0n;return Ce.map(a=>(e&&e.navParts&&(n[M.Liquid]+=(e.navParts.baseAssetOIVBal||0n)+(e.navParts.feeBal||0n)+(e.navParts.baseAssetSafeBal||0n)),{type:Nt[a],count:n[a].toString()}))};function Lt(e){return h(`fetchFundLatestSnapshot_${e.chainId}_${e.address}`,()=>qt(e))}function _t(e,t){return h(`fetchFundLatestSnapshots_${e}`,()=>Gt(e,t))}async function qt(e){console.warn("FETCH LATEST SNAPSHOT Fund ",e.chainId,e.address);const t=Ae(),n=await fetch(`${t.public.BACKEND_URL}/nav/latest-snapshot/${e.address}?fundChainId=${e.chainId}`);if(!n.ok)return console.error(`Failed to fetch latest snapshot for fund ${e.chainId} ${e.address}:`,n.statusText),e;const a=await n.json();return console.warn("Fund ",e.chainId,e.address," NAV SNAPSHOT",a),je(e,a)}async function Gt(e,t){console.warn("FETCH LATEST SNAPSHOTS ChainId ",e);const n=Ae();try{const a=t.map(r=>r.address),s=await fetch(`${n.public.BACKEND_URL}/nav/latest-snapshots`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fundChainId:e,fundAddresses:a})});if(!s.ok)return console.error(`Failed to fetch latest snapshot for chain ${e}:`,s.statusText),t;const i=await s.json();return console.warn("Funds chainId ",e," NAV SNAPSHOTS",i),t.map(r=>je(r,i.find(o=>o.fundAddress===r.address)))}catch(a){return console.error(`Error fetching latest snapshot for ChainId ${e}:`,a),t}}const je=(e,t)=>{var s,i;let n;try{t!=null&&t.calculatedAt&&(n=St(new Date(t==null?void 0:t.calculatedAt)))}catch(r){console.error(r)}const a=(s=e==null?void 0:e.positionTypeCounts)!=null&&s.length?e==null?void 0:e.positionTypeCounts:(i=t==null?void 0:t.positionTypeCounts)!=null&&i.length?t==null?void 0:t.positionTypeCounts:[];return{...e,totalSimulatedNavCalculatedAt:n,totalSimulatedNav:BigInt((t==null?void 0:t.totalSimulatedNav)||0),totalSimulatedNavFormatted:t==null?void 0:t.totalSimulatedNavFormatted,totalSimulatedNavUSD:t==null?void 0:t.totalSimulatedNavUSD,totalSimulatedNavUSDFormatted:t==null?void 0:t.totalSimulatedNavUSDFormatted,totalDepositBalance:t==null?void 0:t.totalDepositBalance,sharpeRatio:t==null?void 0:t.sharpeRatio,lastNAVUpdateTotalNAV:t==null?void 0:t.totalNAV,cumulativeReturnPercent:t==null?void 0:t.cumulativeReturnPercent,positionTypeCounts:a,isNavUpdatesLoading:!1}};function Ht(e){return e.length?_t(e[0].chainId,e):Promise.resolve([])}const Wt=async(e,t)=>{const n=F();n.resetFundData(e,t),n.selectedFundChain=e,n.selectedFundAddress=t;try{await n.fetchFundMetaData(e,t),await n.fetchFundNAVData(),n.fund&&Lt(n.fund).then(a=>{console.warn("TTT fetchFundLatestSnapshotAction DONE111",e,t,a),Object.assign(n.fund,a),console.warn("TTT fetchFundLatestSnapshotAction DONE222",e,t,n.fund)}).catch(a=>{console.error(`Failed fetching latest snapshot for ${t}`,a),$t(n.fund),n.calculateFundPerformanceMetrics(n.fund)}),n.fetchUserFundData(e,t),n.fetchFundPendingDepositRedemptionBalance()}catch(a){throw console.error(`Failed fetching fund data for ${t}`,a),a}},$t=e=>{var a;if(!e||!((a=e.navUpdates)!=null&&a.length))return;const t=e.navUpdates,n=t[t.length-1];e.positionTypeCounts=Je(n)},ae=""+new URL("default_avatar.5CRjHovZ.webp",import.meta.url).href,Jt=e=>{const t=new URLSearchParams(e),n=t.get("mode")||"",a=t.get("from");return n in Ue||console.error("Fund clock mode is not in valid options: ",n,e),{mode:Ue[n],...a?{from:a}:{}}},jt=e=>{const t={};return Object.entries(e).forEach(([n,a])=>{const s=n;t[s]=typeof a=="bigint"?a.toString():a}),t},Qe={[E.POLYGON]:[{address:"0x0dCd5D9cF6DFF56E7Ce2cbed1d39369e1B5f2ac4",strategistName:"ShineDAO",strategistUrl:"https://discord.gg/HMhRGBnxub"},{address:"0xBE0B0C435EA1156F76d3E116Fbd5606743ab179a",strategistName:"The DAO of Capital",strategistUrl:"https://discord.gg/punj9gPZP3"},{address:"0xFc3de74eA28474FF02e378F5F8658354E481d7B9",strategistName:"The DAO of Capital",strategistUrl:"https://discord.gg/punj9gPZP3"},{address:"0xc748d5E77B998608Ef84d063b9694f2dBB81a325",strategistName:"soonami.io",strategistUrl:"https://soonami.io/venture-staking"}],[E.BASE]:[{address:"0x533f164d91e3F8169a7043f7094f44af87Fb7CA4",strategistName:"INDEFI",strategistUrl:"https://indefi.io/"}],[E.ARBITRUM]:[{address:"0x00a4DCBBB7Eb5d0c4Ef33Ab9763DDE5Cd91A4b10",strategistName:"Flex.hl",strategistUrl:"https://x.com/kinzflx"},{address:"0x5E0f37920DDee57dAbAf5A73B21D51075AeDbEBE",strategistName:"Harmonix",strategistUrl:"https://harmonix.fi/"},{address:"0xABC961AFc18dfE9F062cf9a8046346E92a934D08",strategistName:"QuantCheck Labs",strategistUrl:"https://www.quantchecklabs.com/"},{address:"0x5A7638b7b831262081804e88657b2D83E8491b1E",strategistName:"carrotfunding.io",strategistUrl:"https://carrotfunding.io"}],[E.ETHEREUM]:[{address:"0xaC3D76E29f866702E17f571cccb15937E5A17303",strategistName:"soonami.io",strategistUrl:"https://soonami.io/venture-staking"}]},Qt=async(e,t)=>{var r,o;const n=g(),a=$e(),s=F(),i=(r=n.chainContracts[e])==null?void 0:r.rethinkReaderContract;try{console.debug("getFundMetaData",t,e,i);const d=await n.callWithRetry(e,()=>i.methods.getFundMetaData(t).call());console.log("fundMetaData",d);const{startTime:p,totalDepositBal:u,feeBalance:l,feePerformancePeriod:y,feeManagePeriod:c,fundTokenDecimals:m,fundBaseTokenDecimals:T,fundGovernanceTokenDecimals:A,fundTokenSupply:f,fundGovernanceTokenSupply:I,safeContractBaseTokenBalance:P,fundContractBaseTokenBalance:G,fundMetadata:V,fundBaseTokenSymbol:x,fundGovernanceTokenSymbol:U,fundGovernanceData:z,fundSettings:S}=d,{votingDelay:oe,votingPeriod:de,proposalThreshold:H,lateQuorumVoteExtension:W,quorumNumerator:ue,quorumDenominator:pe,clockMode:it}=z;S.performancePeriod=y,S.managementPeriod=c,console.debug("fundSettings: ",S);const b=jt(S),$=Jt(it);console.debug("parsedClockMode: ",$),console.log("parsedFundSettings: ",b),console.debug("fundGovernanceTokenSupply: ",I);const rt=n.getCustomContract(e,ne,(b==null?void 0:b.governanceToken)??""),X=await n.callWithRetry(e,()=>rt.methods.totalSupply().call());I!==X&&console.warn("[MISMATCH] fundGovernanceTokenSupply: ",I,"fundGovernanceTokenSupplyFixed: ",X);const Me=X*ue/pe,Z=await a.initializeBlockTimeContext(e),le=(Z==null?void 0:Z.averageBlockTime)||0;console.warn("fetchFundMetaDataAction blockTimeContext",Z);const we=O[e],Ee=void 0,B={originalFundSettings:b,lastNAVUpdateTotalNAV:void 0,chainId:e,chainName:we.chainName,chainShort:we.chainShort,address:b.fundAddress||"",title:b.fundName||"N/A",clockMode:$,description:"N/A",safeAddress:b.safe||"",governorAddress:b.governor||"",photoUrl:ae,inceptionDate:p?Q(new Date(Number(p)*1e3)):"",lastNavUpdateTime:Ee?Q(new Date(Number(Ee)*1e3)):"",fundToken:{symbol:b.fundSymbol,address:b.fundAddress,decimals:Number(m)??18},baseToken:{symbol:x??"",address:b.baseToken,decimals:Number(T)??18},governanceToken:{symbol:U??"",address:b.governanceToken,decimals:Number(A)??18},totalDepositBalance:u||BigInt("0"),governanceTokenTotalSupply:X,fundTokenTotalSupply:f,netDeposits:"",isWhitelistedDeposits:b.isWhitelistedDeposits,allowedDepositAddresses:b.allowedDepositAddrs,allowedManagerAddresses:b.allowedManagers,plannedSettlementPeriod:"",minLiquidAssetShare:"",votingDelay:ce(oe,le,$.mode),votingPeriod:ce(de,le,$.mode),proposalThreshold:!H&&H!==0n?"N/A":`${Mt(H)} ${U||"votes"}`,quorumVotes:Me,quorumVotesFormatted:te(Me,A),quorumNumerator:ue,quorumDenominator:pe,quorumPercentage:Ft(ue,pe),lateQuorum:ce(W,le,$.mode),depositFee:b.depositFee.toString(),depositFeeAddress:b.feeCollectors[0],withdrawFee:b.withdrawFee.toString(),withdrawFeeAddress:b.feeCollectors[1],managementPeriod:b.managementPeriod.toString(),managementFee:b.managementFee.toString(),managementFeeAddress:b.feeCollectors[2],performancePeriod:b.performancePeriod.toString(),performanceFee:b.performanceFee.toString(),performanceFeeAddress:b.feeCollectors[3],performaceHurdleRateBps:b.performaceHurdleRateBps,feeCollectors:b.feeCollectors,feeBalance:l*-1n,safeContractBaseTokenBalance:P,fundContractBaseTokenBalance:G,navUpdates:[]};if(console.log("fund fund: ",B),V){const w=JSON.parse(V),{strategistName:ot,strategistUrl:dt,oivChatUrl:ut}=((o=Qe[e])==null?void 0:o.find(ye=>(ye==null?void 0:ye.address)===t))||{strategistName:"",strategistUrl:"",oivChatUrl:""};B.description=w.description,B.photoUrl=w.photoUrl||ae,B.plannedSettlementPeriod=w.plannedSettlementPeriod,B.minLiquidAssetShare=w.minLiquidAssetShare,B.strategistName=(w==null?void 0:w.strategistName)||ot,B.strategistUrl=(w==null?void 0:w.strategistUrl)||dt,B.oivChatUrl=(w==null?void 0:w.oivChatUrl)||ut}return s.chainFunds[e][t]=B,B}catch(d){return console.error("Error in promises: ",d,"fund: ",t),{}}},Ye={abi:[{inputs:[{internalType:"address",name:"oiv",type:"address"},{internalType:"bytes",name:"data",type:"bytes"}],name:"storeNAVData",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"oiv",type:"address"}],name:"getNAVData",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function",constant:!0}]};var ie=(e=>(e[e.DepositFee=0]="DepositFee",e[e.WithdrawFee=1]="WithdrawFee",e[e.ManagementFee=2]="ManagementFee",e[e.PerformanceFee=3]="PerformanceFee",e))(ie||{});const Yt=L.abi.find(e=>e.name==="collectFees"&&e.type==="function"),Ne=e=>Y(Yt,[e]),Kt=Ne(ie.DepositFee),zt=Ne(ie.ManagementFee),Xt=Ne(ie.PerformanceFee),Zt=(e,t)=>{const n={value:[{isArray:!1,data:"1",internalType:"uint16",name:"role"},{isArray:!1,data:null,internalType:"address",name:"targetAddress"},{isArray:!1,data:null,internalType:"bytes4",name:"functionSig"},{isArray:!0,data:[],internalType:"bool[]",name:"isParamScoped"},{isArray:!0,data:[],internalType:"enum ParameterType[]",name:"paramType"},{isArray:!0,data:[],internalType:"enum Comparison[]",name:"paramComp"},{isArray:!0,data:[],internalType:"bytes[]",name:"compValue"},{isArray:!1,data:"1",internalType:"enum ExecutionOptions",name:"options"}],valueMethodIdx:19},a={value:[{idx:0,isArray:!1,data:"1",internalType:"uint16",name:"role"},{idx:1,isArray:!1,data:null,internalType:"address",name:"targetAddress"}],valueMethodIdx:24};n.value[1].data=e,a.value[1].data=e,n.value[2].data="0xa61f5814";const s=["0x000000000000000000000000"+t.slice(2)],i=[!0],r=["0"];return n.value[3].data=i,n.value[4].data=r,n.value[5].data=r,n.value[6].data=s,[n,a]},en=e=>{var t;return((t=e.find(n=>"pastNAVUpdateIndex"in n))==null?void 0:t.pastNAVUpdateIndex)??0},tn=JSON.parse('[{"inputs":[{"internalType":"address","name":"_owner","type":"address"},{"internalType":"address","name":"_avatar","type":"address"},{"internalType":"address","name":"_target","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"ArraysDifferentLength","type":"error"},{"inputs":[],"name":"ModuleTransactionFailed","type":"error"},{"inputs":[],"name":"NoMembership","type":"error"},{"inputs":[],"name":"SetUpModulesAlreadyCalled","type":"error"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"},{"indexed":false,"internalType":"uint16[]","name":"roles","type":"uint16[]"},{"indexed":false,"internalType":"bool[]","name":"memberOf","type":"bool[]"}],"name":"AssignRoles","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousAvatar","type":"address"},{"indexed":true,"internalType":"address","name":"newAvatar","type":"address"}],"name":"AvatarSet","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"guard","type":"address"}],"name":"ChangedGuard","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"}],"name":"DisabledModule","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"}],"name":"EnabledModule","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"initiator","type":"address"},{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"avatar","type":"address"},{"indexed":false,"internalType":"address","name":"target","type":"address"}],"name":"RolesModSetup","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"},{"indexed":false,"internalType":"uint16","name":"defaultRole","type":"uint16"}],"name":"SetDefaultRole","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"multisendAddress","type":"address"}],"name":"SetMultisendAddress","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousTarget","type":"address"},{"indexed":true,"internalType":"address","name":"newTarget","type":"address"}],"name":"TargetSet","type":"event"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"enum ExecutionOptions","name":"options","type":"uint8"}],"name":"allowTarget","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"module","type":"address"},{"internalType":"uint16[]","name":"_roles","type":"uint16[]"},{"internalType":"bool[]","name":"memberOf","type":"bool[]"}],"name":"assignRoles","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"avatar","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"defaultRoles","outputs":[{"internalType":"uint16","name":"","type":"uint16"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"prevModule","type":"address"},{"internalType":"address","name":"module","type":"address"}],"name":"disableModule","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"module","type":"address"}],"name":"enableModule","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"}],"name":"execTransactionFromModule","outputs":[{"internalType":"bool","name":"success","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"}],"name":"execTransactionFromModuleReturnData","outputs":[{"internalType":"bool","name":"","type":"bool"},{"internalType":"bytes","name":"","type":"bytes"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"},{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"bool","name":"shouldRevert","type":"bool"}],"name":"execTransactionWithRole","outputs":[{"internalType":"bool","name":"success","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"},{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"bool","name":"shouldRevert","type":"bool"}],"name":"execTransactionWithRoleReturnData","outputs":[{"internalType":"bool","name":"success","type":"bool"},{"internalType":"bytes","name":"returnData","type":"bytes"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getGuard","outputs":[{"internalType":"address","name":"_guard","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"start","type":"address"},{"internalType":"uint256","name":"pageSize","type":"uint256"}],"name":"getModulesPaginated","outputs":[{"internalType":"address[]","name":"array","type":"address[]"},{"internalType":"address","name":"next","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"guard","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_module","type":"address"}],"name":"isModuleEnabled","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"multisend","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"}],"name":"revokeTarget","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"},{"internalType":"enum ExecutionOptions","name":"options","type":"uint8"}],"name":"scopeAllowFunction","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"},{"internalType":"bool[]","name":"isParamScoped","type":"bool[]"},{"internalType":"enum ParameterType[]","name":"paramType","type":"uint8[]"},{"internalType":"enum Comparison[]","name":"paramComp","type":"uint8[]"},{"internalType":"bytes[]","name":"compValue","type":"bytes[]"},{"internalType":"enum ExecutionOptions","name":"options","type":"uint8"}],"name":"scopeFunction","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"},{"internalType":"enum ExecutionOptions","name":"options","type":"uint8"}],"name":"scopeFunctionExecutionOptions","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"},{"internalType":"uint256","name":"paramIndex","type":"uint256"},{"internalType":"enum ParameterType","name":"paramType","type":"uint8"},{"internalType":"enum Comparison","name":"paramComp","type":"uint8"},{"internalType":"bytes","name":"compValue","type":"bytes"}],"name":"scopeParameter","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"},{"internalType":"uint256","name":"paramIndex","type":"uint256"},{"internalType":"enum ParameterType","name":"paramType","type":"uint8"},{"internalType":"bytes[]","name":"compValues","type":"bytes[]"}],"name":"scopeParameterAsOneOf","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"}],"name":"scopeRevokeFunction","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"}],"name":"scopeTarget","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_avatar","type":"address"}],"name":"setAvatar","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"module","type":"address"},{"internalType":"uint16","name":"role","type":"uint16"}],"name":"setDefaultRole","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_guard","type":"address"}],"name":"setGuard","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_multisend","type":"address"}],"name":"setMultisend","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_target","type":"address"}],"name":"setTarget","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes","name":"initParams","type":"bytes"}],"name":"setUp","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"target","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint16","name":"role","type":"uint16"},{"internalType":"address","name":"targetAddress","type":"address"},{"internalType":"bytes4","name":"functionSig","type":"bytes4"},{"internalType":"uint8","name":"paramIndex","type":"uint8"}],"name":"unscopeParameter","outputs":[],"stateMutability":"nonpayable","type":"function"}]'),nn={abi:tn};var j=(e=>(e[e.NONE=0]="NONE",e[e.SEND=1]="SEND",e[e.DELEGATE_CALL=2]="DELEGATE_CALL",e[e.BOTH=3]="BOTH",e))(j||{}),an=(e=>(e[e.REMOVE=0]="REMOVE",e[e.PENDING=1]="PENDING",e[e.NONE=2]="NONE",e))(an||{}),v=(e=>(e.EQUAL_TO="EqualTo",e.ONE_OF="OneOf",e.GREATER_THAN="GreaterThan",e.LESS_THAN="LessThan",e))(v||{}),C=(e=>(e.STATIC="Static",e.DYNAMIC="Dynamic",e.DYNAMIC32="Dynamic32",e.NO_RESTRICTION="NoRestriction",e))(C||{}),N=(e=>(e[e.INT=0]="INT",e[e.UINT=1]="UINT",e[e.BOOLEAN=2]="BOOLEAN",e[e.BYTES=3]="BYTES",e[e.BYTES_FIXED=4]="BYTES_FIXED",e[e.ADDRESS=5]="ADDRESS",e[e.STRING=6]="STRING",e[e.ARRAY=7]="ARRAY",e[e.TUPLE=8]="TUPLE",e[e.UNSUPPORTED=9]="UNSUPPORTED",e))(N||{}),se=(e=>(e.BLOCKED="None",e.WILDCARDED="Target",e.SCOPED="Function",e))(se||{}),sn=(e=>(e[e.SCOPE_TARGET=0]="SCOPE_TARGET",e[e.SCOPE_FUNCTION=1]="SCOPE_FUNCTION",e[e.SCOPE_PARAM=2]="SCOPE_PARAM",e[e.UPDATE_FUNCTION_EXECUTION_OPTION=3]="UPDATE_FUNCTION_EXECUTION_OPTION",e))(sn||{});function pa(e){return e.some(t=>t)?se.SCOPED:se.BLOCKED}var rn=(e=>(e.FALSE="false",e.TRUE="true",e))(rn||{});const la={[v.EQUAL_TO]:"is equal to",[v.ONE_OF]:"is one of",[v.GREATER_THAN]:"is greater than",[v.LESS_THAN]:"is less than"};function on(e){var t;return e?e.baseType==="address"?N.ADDRESS:e.baseType==="string"?N.STRING:e.baseType==="bool"?N.BOOLEAN:e.baseType==="tuple"?N.TUPLE:e.baseType.startsWith("uint")?N.UINT:e.baseType.startsWith("int")?N.INT:e.baseType==="array"?((t=e.arrayChildren)==null?void 0:t.baseType)==="array"?N.UNSUPPORTED:N.ARRAY:e.baseType.startsWith("bytes")&&e.baseType!=="bytes"?N.BYTES_FIXED:N.BYTES:N.UNSUPPORTED}function ya(e){switch(e){case N.UINT:return[v.EQUAL_TO,v.ONE_OF,v.LESS_THAN,v.GREATER_THAN];case N.BOOLEAN:return[v.EQUAL_TO]}return[v.EQUAL_TO,v.ONE_OF]}function ca(e){return!(e!=null&&e.type)||e.type===se.BLOCKED}function ma(e){return e===N.ARRAY?C.DYNAMIC32:e===N.BYTES||e===N.STRING?C.DYNAMIC:C.STATIC}function Se(e){return e.stateMutability?!["view","pure"].includes(e.stateMutability):!0}const fa=e=>{if(!e)return[];const t=new pt(e),n=[];return t.forEachFunction(a=>{Se(a)&&n.push(a)}),n};function Ta(e,t){const n=on(e);return n===N.ARRAY||n===N.TUPLE?JSON.parse(t):t}function ba(e){switch(e){case v.EQUAL_TO:return 0;case v.GREATER_THAN:return 1;case v.LESS_THAN:return 2;case v.ONE_OF:return 3}}const ha={0:v.EQUAL_TO,1:v.GREATER_THAN,2:v.LESS_THAN,3:v.ONE_OF};function ga(e){switch(e){case C.STATIC:return 0;case C.DYNAMIC:return 1;case C.DYNAMIC32:return 2;case C.NO_RESTRICTION:throw new Error("No restriction should not go on chain. This should be unscoped via unscopeParameter")}}const Aa={0:C.STATIC,1:C.DYNAMIC,2:C.DYNAMIC32,3:C.NO_RESTRICTION},va={0:j.NONE,1:j.SEND,2:j.DELEGATE_CALL,3:j.BOTH},Ke=e=>e.liquid.map(t=>[t.tokenPair||me,t.aggregatorAddress||"",t.functionSignatureWithEncodedInputs||"0x",t.assetTokenAddress||"",t.nonAssetTokenAddress||me,t.isReturnArray||!1,parseInt(t.returnLength)||0,parseInt(t.returnIndex)||0,parseInt(t.pastNAVUpdateIndex)||0]),ze=(e,t)=>{if(!t)throw new Error("Failed preparing NAV Illiquid method, base decimals are not known.");return e.illiquid.map(n=>{var s,i;const a=((s=n.otcTxHashes)==null?void 0:s.map(r=>r.trim()).filter(r=>r!==""))||[];return[Te(((i=n.baseCurrencySpent)==null?void 0:i.toString())??"0",t),parseInt(n.amountAquiredTokens)||0,n.tokenAddress,n.isNFT,a,parseInt(n.nftType)||0,parseInt(n.nftIndex)||0,parseInt(n.pastNAVUpdateIndex)||0]})},Xe=e=>e.nft.map(t=>[t.oracleAddress,t.nftAddress,t.nftType,parseInt(t.nftIndex)||0,parseInt(t.pastNAVUpdateIndex)||0]),Ze=e=>e.composable.map(t=>[t.remoteContractAddress,t.functionSignatures,t.encodedFunctionSignatureWithInputs,parseInt(t.normalizationDecimals)||0,t.isReturnArray,parseInt(t.returnValIndex)||0,parseInt(t.returnArraySize)||0,parseInt(t.returnValType)||0,parseInt(t.pastNAVUpdateIndex)||0,t.isNegative]),et=e=>{var n;if(!e)return;const t=e.internalType??"";if(e.isArray){const a=[];for(let s=0;s<((n=e.data)==null?void 0:n.length);s++)t.startsWith("address")||t.startsWith("bytes")||t.startsWith("int")||t.startsWith("uint")||t.startsWith("enum")?a.push(e.data[s]):t.startsWith("bool")&&(typeof e.data[s]=="boolean"?a.push(e.data[s]):a.push(e.data[s]==="true"));return a}if(t.startsWith("address"))return e.data;if(t.startsWith("bytes"))return e.data;if(t.startsWith("int"))return e.data;if(t.startsWith("uint"))return e.data;if(t.startsWith("enum"))return e.data;if(t.startsWith("bool"))return typeof e.data=="boolean"?e.data:e.data==="true"},Fe=(e,t)=>{let n;const a=wt[t.entryType];try{t.description===""?n={}:n=JSON.parse(t.description??"{}")}catch(o){console.warn("Failed to parse NAV entry JSON description string: ",o)}const s=Et(t),i=xt(s);let r=a;return a===M.Composable&&(s.composable[0].functionSignatures.includes("illiquidCalc")?r=M.Illiquid:s.composable[0].functionSignatures.includes("liquidCalc")&&(r=M.Liquid)),{index:e,positionType:a,displayPositionType:r,positionName:n==null?void 0:n.positionName,valuationSource:n==null?void 0:n.valuationSource,details:s,detailsJson:i,detailsHash:Le(lt(i))}};var dn=(e=>(e.Setup="setup",e.Details="details",e))(dn||{});const Na={setup:{name:"Permission Setup",formTitle:"Set up Permission Function",key:"setup"},details:{name:"Proposal Details",formTitle:"Provide Proposal Information",key:"details"}},re=nn.abi.filter(e=>e.type==="function"),un=re.filter(e=>Se(e)),pn={};re.forEach((e,t)=>{e.name&&(pn[e.name]=t)});const Ve=re.map((e,t)=>({title:e.name,value:e.name,valueMethodIdx:t,isWriteFunction:Se(e)})).filter(e=>e.isWriteFunction),ln={label:"Contract Method",key:"contractMethod",type:k.Select,defaultValue:Ve[0].value,choices:Ve},yn=e=>{const t=["uint","int"],n=["address","bytes"],a=["bool"],s="E.g. 0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045";let i=k.Text,r=`E.g. ${e.type}`.replace("[]",""),o=[D.required],d=[],p;if(t.some(u=>e.type.includes(u)))i=k.Number,e.type.includes("uint8")?o=[D.required,D.isValidUint8]:e.type.includes("uint16")&&(o=[D.required,D.isValidUint16]);else if(n.some(u=>e.type.includes(u))){if(o=[D.required],e.type.includes("address")&&(r=s,o.push(D.isValidAddress)),e.type.includes("bytes")){const u=Number(e.type.replace(/\D/g,""));u!==0&&(r=`E.g. 0x${"00".repeat(u)}`,o.push(D.isValidByteLength(u))),o.push(D.isValidHexString)}}else a.some(u=>e.type.includes(u))&&(i=k.Select,d=[{title:"true",value:!0},{title:"false",value:!1}],p=!1);return{label:e.name,key:e.name,internalType:e.internalType,input:e,type:i,rules:o,placeholder:r,isArray:e.type.includes("[]"),choices:d,defaultValue:p}},Sa=(e,t)=>{const n=[],a=[],s=[];for(let i=0;i<t.length;i++){const r=t[i],o=tt[r.contractMethod].filter(p=>p.key!=="contractMethod").map(p=>et({...p,data:r[p.key]}));console.warn("roleModFunctionData",r.contractMethod,o),console.warn("roleModWriteFunctionAbiMap[trx.contractMethod]",be[r.contractMethod]);const d=Y(be[r.contractMethod],o);n.push(d),a.push(e),s.push(0)}return{encodedRoleModEntries:n,targets:a,gasValues:s}},be={},tt=un.reduce((e,t)=>{be[t.name]=t;const n=t.inputs.map(yn),a=JSON.parse(JSON.stringify(ln));return a.defaultValue=t.name,e[t.name]=[a,...n],e},{}),Fa={setup:tt,details:[{label:"Proposal Title",key:"proposalTitle",type:k.Text,placeholder:"E.g. Proposal Title",charLimit:150,rules:[D.required,D.charLimit(150)]},{label:"Proposal Description",key:"proposalDescription",type:k.Textarea,placeholder:"E.g. Proposal Description",rules:[D.required]},{label:"Transactions Overview",key:"transactionsOverview",type:k.ReadonlyJSON,required:!1},{label:"Transactions Raw JSON",key:"transactionsRawJSON",type:k.ReadonlyJSON,required:!1}]},nt=L.abi.find(e=>e.name==="updateNav"&&e.type==="function"),cn=Ye.abi.find(e=>e.name==="storeNAVData"&&e.type==="function"),Ma=(e,t,n=!1)=>{const a=[],s=[];for(const r of e){if(r.deleted)continue;const o=JSON.parse(JSON.stringify(r.details));r.pastNAVUpdateEntryFundAddress&&s.push(r.pastNAVUpdateEntryFundAddress);let d=0;if(r.positionType===M.Liquid)o.liquid=Ke(o);else if(r.positionType===M.Illiquid){if(!t)throw new Error("Failed preparing NAV method, base decimals are not known.");o.illiquid=ze(o,t)}else r.positionType===M.NFT?o.nft=Xe(o):r.positionType===M.Composable&&(o.composable=Ze(o));d=en(o[r.positionType]);let p=o.description;typeof p=="object"&&p!==null&&(p=JSON.stringify(o.description)),a.push([parseInt(o.entryType),J(o.liquid),J(o.illiquid),J(o.nft),J(o.composable),o.isPastNAVUpdate,d,parseInt(o.pastNAVUpdateEntryIndex),p])}console.log("navUpdateEntries: ",a),console.log("pastNavUpdateEntryAddresses: ",s),console.log("processWithdraw: ",n);const i=Y(nt,[a,s,n]);return console.log("encodedNavUpdateEntries: ",i),i},mn=e=>yt(nt,e),wa=(e,t,n=!1,a=!1,s=!1)=>{const i=[t],r=[0],o=[e];return console.log("NAV collectFlowFees: ",n),n&&(i.push(t),r.push(0),o.push(Kt)),console.log("NAV collectManagementFees: ",a),a&&(i.push(t),r.push(0),o.push(zt)),console.log("NAV collectPerformanceFees: ",s),s&&(i.push(t),r.push(0),o.push(Xt)),{targets:i,gasValues:r,calldatas:o}},Ea=(e,t,n,a)=>{const{getNAVExecutorBeaconProxyAddress:s}=K(),i=s(n),r=Y(cn,[t,e]),o=fn(t,n,a);return console.warn("encodedNavUpdateEntries",t,e),console.warn("encodedDataStoreNAVDataNavUpdateEntries",r),{targets:[i].concat(o.targets),gasValues:[0].concat(o.gasValues),calldatas:[r].concat(o.calldatas)}},fn=(e,t,n)=>{const{getNAVExecutorBeaconProxyAddress:a}=K(),s=a(t),i=Zt(e,s),[r,o,d]=Tn(i,n);return{targets:o,gasValues:d,calldatas:r}},Tn=(e,t)=>{console.log("roleModAddress: ",t);const n=[],a=[],s=[];for(let i=0;i<e.length;i++){const r=re[e[i].valueMethodIdx];console.log("roleModFunctionABI: ",JSON.stringify(r,null,2));const o=[];for(let p=0;p<e[i].value.length;p++)o.push(et(e[i].value[p]));const d=Y(r,o);console.log("roleModFunctionData: ",i,JSON.stringify(o,null,2)),n.push(d),a.push(t),s.push(0)}return[n,a,s]},at={[E.POLYGON]:{},[E.ARBITRUM]:{},[E.ETHEREUM]:{},[E.BASE]:{"0x533f164d91e3F8169a7043f7094f44af87Fb7CA4":[69]}},bn=async(e,t)=>{try{const n=JSON.parse(JSON.stringify(J(t),qe),Ge);await _e.setItem(e,n),console.log(`Saved data to ${e}`)}catch(n){console.error(`Error saving data to ${e}:`,n)}},hn=async(e,t={})=>{try{return await _e.getItem(e)||t}catch(n){return console.error(`Error loading data from ${e}:`,n),null}},gn=async()=>{var i,r;const e=F(),t=g(),n=e.fund;if(!n||!(n!=null&&n.address))return;const a=(i=t.chainContracts[n.chainId])==null?void 0:i.rethinkReaderContract;try{const o=await t.callWithRetry(n.chainId,()=>a.methods.getFundNAVData(n==null?void 0:n.address).call());let d=await e.parseFundNAVUpdates(n.chainId,o,e.selectedFundAddress);console.log("FUND NAV DATA",d);const p=((r=at[n.chainId])==null?void 0:r[n.address])||[];if(d=p.length?d.filter(l=>!p.includes(l.index)):d,!d.length){const l=await An(n.chainId,n.address);console.log("FETCHED GET NAV DATA",l),e.fundInitialNAVMethods=await Be(e.selectedFundAddress,l),e.fundManagedNAVMethods=e.fundInitialNAVMethods,e.refreshSimulateNAVCounter++}const u=d[d.length-1];n.lastNAVUpdateTotalNAV=d.length?u.totalNAV||0n:n.totalDepositBalance||0n,n.navUpdates=d}catch(o){console.error("Error calling getNAVDataForFund: ",o,"fund: ",n==null?void 0:n.address)}const s=JSON.parse(JSON.stringify(e.fundLastNAVUpdateMethods,qe),Ge);e.fundManagedNAVMethods=await Be(e.selectedFundAddress,s),e.refreshSimulateNAVCounter++},An=async(e,t)=>{const n=g(),a=[];console.debug("getNAVData",e,t);const{getNAVExecutorBeaconProxyAddress:s}=K(),i=s(e);if(!t)return a;try{const r=n.getCustomContract(e,Ye.abi,i),o=await n.callWithRetry(e,()=>r.methods.getNAVData(t).call(),1,[310]),d=mn(o);for(const[p,u]of d.navUpdateData.entries()){const l=Fe(p,u);a.push(l)}}catch(r){if(r.code!==ct)throw console.error("Failed loading NAV methods data from getNAVData.",r),r}return console.debug("getNAVData parsed NAV methods",e,t,a),a},Be=async(e,t)=>{var i;const n=await hn("navUpdateEntries");(i=n[e])!=null&&i.length||(n[e]=t,bn("navUpdateEntries",n));const a=n[e]||[],s=new Map(t.map(r=>[r.detailsHash,r]));return a.forEach(r=>{r.isNew=!s.has(r.detailsHash),s.set(r.detailsHash,r)}),Array.from(s.values())};function vn(e){const t=q(),n=F();console.log("start calculateFundsPerformanceMetricsAction ",e);for(const a of t.chainFunds[e])n.calculateFundPerformanceMetrics(a)}const Nn=Ae(),Sn=Nn.public.ENV_EXCLUDE_TEST_FUNDS,Fn=mt("excludeTestFunds",Sn),Mn={"0x89":[{address:"0xf48E3fa13cb2390e472cf1CA64F941eB7BD27475",alwaysExclude:!0},{address:"0x0657DC652F88B55Dd16f5D6cE687672264f9b61E",alwaysExclude:!0},{address:"0x8fAE33f10854c20a811246849A0d4131caf72125",alwaysExclude:!0},{address:"0x6DFbEE70f1250C2dECb3E9bCb2BE3AF19b15e631",alwaysExclude:!0},{address:"0x82CBA6D1A6dCeb408d7F048493262b83c9744f4D",alwaysExclude:!1},{address:"0xcfD904C4C857784686029995886d627da1aeFbe4",alwaysExclude:!1},{address:"0xe93CB20Fc113355753B6D237c3949E0452981dC3",alwaysExclude:!0},{address:"0x6edC5f675C5A20e867aeF0633033a17EA256637E",alwaysExclude:!0},{address:"0x920fdA0F59bDc852eD19e3ad975a808101ea2a29",alwaysExclude:!0},{address:"0x1550D564fEBE8c398F3cc398c9ac2a9e89E89A4F",alwaysExclude:!1},{address:"0x07094Bb5f175A4E6b074e5E79F6439a8A929533B",alwaysExclude:!1},{address:"0x98F1c2035680E4215cD5726a11279da96C07835F",alwaysExclude:!1},{address:"0xdac03eD03EFDa65A1488c7f3f0302636491726B6",alwaysExclude:!0},{address:"0xBb1E02AcA8F7Cb2403c0Bf3aaA74001d38Beb488",alwaysExclude:!0},{address:"0x1673458dDf6C0ea24ce5598918F3cA1e58f2d795",alwaysExclude:!1}],"0xa4b1":[{address:"0xA5138779Bb08C8DE44692e183c586817a0bcEb42",alwaysExclude:!1},{address:"0x74759a4607B97360956AbFd44cA4B2A0EC2A27C9",alwaysExclude:!1},{address:"0xd1FCcFb737E1b436Da057011Dc56231035285688",alwaysExclude:!1},{address:"0x80b5426A71c19Da522ddDeD4745eADE57a51E334",alwaysExclude:!1},{address:"0x4DF9aD4B872D8E906990205aD055Bc00c39EEa74",alwaysExclude:!1},{address:"0xbaA81241A186BC547Ec9e7a306755D4079b559cD",alwaysExclude:!1},{address:"0xB9e1dC350af83a3127aDc8CFB48a9B4abADCA184",alwaysExclude:!1},{address:"0xe3c31b33FCBd905E978aCEa64b2b043Cc81DDA7c",alwaysExclude:!0},{address:"0xC27eE955a44F0A9e7AC509dD54E8221eE06A9592",alwaysExclude:!0},{address:"0x539a56974295B8BF7023F2d85144Ca0010953ee2",alwaysExclude:!0},{address:"0x5A7638b7b831262081804e88657b2D83E8491b1E",alwaysExclude:!1},{address:"0x5E0f37920DDee57dAbAf5A73B21D51075AeDbEBE",alwaysExclude:!1},{address:"0x1D672d59724082EeeB575d1c7f42A6e5d1e327be",alwaysExclude:!0},{address:"0x9674B98e146c6bB120604a12E2EB03AC957BB6C6",alwaysExclude:!0},{address:"0xDD0B24e283f9084129380a1aEc325e05e691E47A",alwaysExclude:!0},{address:"0xB637Af0447faABDc10151152DD359cf947584120",alwaysExclude:!0}],"0xfc":[],"0x1":[{address:"0x7ed95418063d5b61bDE7b40D65F93739c0CFdcf4",alwaysExclude:!1},{address:"0x51cf0Bc0f5312d824a55B83B2c032Fb8c96c249a",alwaysExclude:!1},{address:"0xB6aB76d451B98a992FB84A93602527CC30cd3b22",alwaysExclude:!1}],"0x2105":[{address:"0x1D66EB6cC3b80c76B6fF08aC13f93a2DAEA4C855",alwaysExclude:!1},{address:"0xFC5fF4dc70EaEc998863668212B01cBE51000A4b",alwaysExclude:!1},{address:"0xC38e9E111CCBd435d9DE53ED2Dd7Db3993839238",alwaysExclude:!1},{address:"0x61d5e3dC0907EADa4D9B06D8B33Cd96c3510b533",alwaysExclude:!1},{address:"0x016623a2b54F7a6DAdB35D3400557a1b79466429",alwaysExclude:!1},{address:"0x2e40fDbA4d07E6b7aBCcBCCe3f6D28bDea727395",alwaysExclude:!1},{address:"0x34f1Ec0A0af19d622B281488C1B1ba0B5aE20860",alwaysExclude:!0},{address:"0x23C44260731B8614aa7F3B28AB0bafDb1610743c",alwaysExclude:!0},{address:"0x16dd2b60DEc7d3fE7C08f6B29732Fb51dDd2c176",alwaysExclude:!0},{address:"0x86acCa1a926FEa47985Df8Ef5A8c0d0cDA650a62",alwaysExclude:!0},{address:"0x457960e6946ed94e82512992ba9dAaBDa5539010",alwaysExclude:!0}]},wn=Object.fromEntries(Object.entries(Mn).map(([e,t])=>{const n=t.filter(a=>Fn?!0:a.alwaysExclude).map(a=>a.address.toLowerCase());return[e,n]}));async function En(){const e=q();async function t(a){var p,u;if(!a)return;let s=e.chainFundsInfoArrays[a];s!=null&&s.length||(s=await e.fetchFundsInfoArrays(a));const i=[],r=[[],[]],o={};for(let l=0;l<s[0].length;l++){const y=s[0][l],c=s[1][l];(p=wn[a])!=null&&p.includes(y.toLowerCase())||(r[0].push(y),r[1].push(c),o[y]=c,i.push(y))}if(console.debug(`Chain ${a} - Filtered Funds: `,r),e.chainFundsInfoArrays[a]=r,(u=e.chainFunds[a])!=null&&u.length)return;const d=await e.fetchFundsMetaData(a,i,o);e.chainFunds[a]=d,Ht(d).then(l=>{e.chainFunds[a]=l,console.debug(`Chain ${a} - Funds with Current Value: `,l)}).catch(async l=>{console.error("Failed to fetch latest snapshots",a,l),e.chainFunds[a]=d,console.debug(`Chain ${a} - Funds Metadata (without Current Value): `,d);try{await e.fetchFundsNavMethods(a,r,!1)}catch(y){console.error("Failed fetchFundsNavMethods",a,r,y);return}try{await e.calculateFundsPerformanceMetrics(a)}catch(y){console.error("Failed calculateFundsPerformanceMetrics",a,y)}}),console.debug(`Funds fetched for chain: ${a}`)}const n=ft.map(a=>t(a));await Promise.allSettled(n),console.warn("ALL FUNDS FETCHED: ",e.chainFunds)}async function xn(e){var s;const t=g(),n=(s=t.chainContracts[e])==null?void 0:s.fundFactoryContract;if(!n)throw new Error(`No fund factory contract found for chainId: ${e}`);const a=await t.callWithRetry(e,()=>n.methods.registeredFundsLength().call());return await t.callWithRetry(e,()=>n.methods.registeredFundsData(0,a).call())}async function Dn(e,t,n){var o,d,p,u,l,y,c;console.log("process fund fetchFundsMetaDataAction fetchFundsMetaDataAction fetchFundsMetaDataAction ",e);const a=g(),s=fe([]),i=(o=a.chainContracts[e])==null?void 0:o.rethinkReaderContract;if(!i)throw new Error(`No reader contract found for chainId: ${e}`);const r=O[e];try{console.log("process fund fundsMetaData",e,t);const m=await i.methods.getFundsMetaData(t).call();console.log("process fund fundsMetaData done",e,"fundsMetaData:",m);for(const[T,A]of t.entries()){const f=m[T],I=f.totalDepositBal||0n,P=Number(f.fundBaseTokenDecimals),G=Number(f.fundTokenDecimals),V=f.startTime,x=void 0,U=fe({chainId:e,chainName:r.chainName,chainShort:r.chainShort,address:A,title:f.fundName||"N/A",description:"N/A",safeAddress:"",governorAddress:"",photoUrl:ae,inceptionDate:V?Q(new Date(Number(V)*1e3)):"",lastNavUpdateTime:x?Q(new Date(Number(x)*1e3)):"",fundToken:{symbol:n[A].fundSymbol,address:A,decimals:G},fundTokenTotalSupply:f.fundTokenSupply||0n,baseToken:{address:((d=f.fundSettings)==null?void 0:d.baseToken)||"",symbol:f.fundBaseTokenSymbol,decimals:P},governanceToken:{symbol:f.fundGovernanceTokenSymbol,address:((p=f.fundSettings)==null?void 0:p.governanceToken)||"",decimals:Number(f.fundGovernanceTokenDecimals)},governanceTokenTotalSupply:f.fundGovernanceTokenSupply||0n,totalDepositBalance:I,cumulativeReturnPercent:void 0,monthlyReturnPercent:void 0,sharpeRatio:void 0,positionTypeCounts:[],sharePrice:void 0,netDeposits:"",isWhitelistedDeposits:!0,allowedDepositAddresses:((u=f.fundSettings)==null?void 0:u.allowedDepositAddrs)||[],allowedManagerAddresses:((l=f.fundSettings)==null?void 0:l.allowedManagers)||[],plannedSettlementPeriod:"",minLiquidAssetShare:"",votingDelay:"",votingPeriod:"",proposalThreshold:"",quorumVotes:0n,quorumVotesFormatted:"0",quorumNumerator:BigInt(0),quorumDenominator:BigInt(0),quorumPercentage:"N/A",lateQuorum:"",depositFee:"",depositFeeAddress:"",withdrawFee:"",withdrawFeeAddress:"",managementPeriod:"",managementFee:"",managementFeeAddress:"",performancePeriod:"",performanceFee:"",performanceFeeAddress:"",performaceHurdleRateBps:"",feeCollectors:((y=f.fundSettings)==null?void 0:y.feeCollectors)||[],feeBalance:f.feeBalance||0n,safeContractBaseTokenBalance:f.safeContractBaseTokenBalance||0n,fundContractBaseTokenBalance:f.fundContractBaseTokenBalance||0n,navUpdates:[],isNavUpdatesLoading:!0}),z=f.fundMetadata;if(z){const S=JSON.parse(z),{strategistName:oe,strategistUrl:de,oivChatUrl:H}=((c=Qe[e])==null?void 0:c.find(W=>(W==null?void 0:W.address)===A))||{strategistName:"",strategistUrl:"",oivChatUrl:""};U.description=S.description,U.photoUrl=S.photoUrl||ae,U.plannedSettlementPeriod=S.plannedSettlementPeriod,U.minLiquidAssetShare=S.minLiquidAssetShare,U.strategistName=(S==null?void 0:S.strategistName)||oe,U.strategistUrl=(S==null?void 0:S.strategistUrl)||de,U.oivChatUrl=(S==null?void 0:S.oivChatUrl)||H}s.push(U)}return s}catch(m){return console.error("Error calling getFundNavMetaData: ",m," addresses: ",t),s}}const Cn={[E.POLYGON]:["0xd87d9b63abe927264903466398cabf9e105ac2fae7c6dc76f822d8ef89e7012d","0xe63fd752a9fdc61a6bb0ac72d9134f09f1f85778192fa6d10278bd9a09a425e9","0x36e7ba53628d044345c9d4e0e9b917f5479d1d4a3e212a0e5b56493f67958020","0x6798edd8ad8861e9e653967ad7938d3646b3058d1a5b6dc98352d99648f45e43","0xeaf175c9485c6b69e0d2005b58a57da04d12c8b0f27bae21547abebdf527c374","0x94f12e7002169840f86b41a8dd9b238449dcf449c2f9be33e3d3717c4bdb3b84","0x37c0cad1bac6a4cdd3a7e5f13162b8b1c7fd8db96ce2557de5db67e1f8213ece","0x003651b0da2306f94cde72d015b08ba7d647d94cddd832a0ece2814a433abf5f","0xb749dd887a361f0a54620e6b951cdbe81b247fd13579b1adccbebb3f20d2fdc5","0xb2ff5e623b7d7968f1be9368581d2a8b81a196be14fd49bf17f2d81cc6a5a792","0xb39cda6e5b4682c22be024de190ef1b4d51272080717f6736d23336d66816d90","0x2c7539dd92643763ddfeb50e7128163bd84b23888ef23aa51b8699c3062f7afe","0xd0725050839976f202c5b166fc8ace2bdf0efbebff6b6c1948a4ad1bc381dab2","0x052b2ebc7e0f9a5bf5a1669a37adece81720835d78a2c59017ef13067815be5a","0x49c45e0947c491f5335b0e7928042945fe18d8068b9177b8abb869d8197eab68","0x46288396afeaf4a1627e8ecfabbd155b6af4c57c915634e39773d4cfe204cb54","0x0090f1dd1b1b6d4e795ee88b9e68106c6850652c3a8d20b60abb698d837fdfa5","0x193875a6a73b0fdb7f91a8d1fec9720631c0e15a77381bb8705ae664820ff191","0x3f1ebea95611c81d5d1796f2b8ba5aa0a4c096be233b1b6e364d672a90b51541","0x185b86eb262389d024f24547dbe747fac1fd105d4fdb289760271d283f8455bc","0x89af9028f446bd5dfa641ae943850706f94954a90276b37bec6d85c240b3fba2","0xd35f068cd38e3889ea64c766e5f0bc2dc3115b277da66a8f45ae03a8b36bbb56"],[E.ARBITRUM]:["0x0293c6201842b711a6e597b77d14aee1fc2705dfa681303d6ec20f7a2fe8df18","0xb2ff5e623b7d7968f1be9368581d2a8b81a196be14fd49bf17f2d81cc6a5a792","0xb39cda6e5b4682c22be024de190ef1b4d51272080717f6736d23336d66816d90","0x2c7539dd92643763ddfeb50e7128163bd84b23888ef23aa51b8699c3062f7afe","0xd0725050839976f202c5b166fc8ace2bdf0efbebff6b6c1948a4ad1bc381dab2","0x052b2ebc7e0f9a5bf5a1669a37adece81720835d78a2c59017ef13067815be5a","0x49c45e0947c491f5335b0e7928042945fe18d8068b9177b8abb869d8197eab68","0x46288396afeaf4a1627e8ecfabbd155b6af4c57c915634e39773d4cfe204cb54","0x0090f1dd1b1b6d4e795ee88b9e68106c6850652c3a8d20b60abb698d837fdfa5","0x193875a6a73b0fdb7f91a8d1fec9720631c0e15a77381bb8705ae664820ff191","0x3f1ebea95611c81d5d1796f2b8ba5aa0a4c096be233b1b6e364d672a90b51541","0x185b86eb262389d024f24547dbe747fac1fd105d4fdb289760271d283f8455bc","0x89af9028f446bd5dfa641ae943850706f94954a90276b37bec6d85c240b3fba2","0x19c959f6f3fd6989839cd304b866bfdfe1a80e1b0592ed518f1f8f2dd90a4411","0x6c80ba925bb107ec6de84d455971bffe3a68ff07ae25cd48438831cae43ab2d4","0xde0634bfae9120b4f389d806e0d8dd97207216faad976d71023ba224d91635de","0xfcb42c544584c67c31f19b4d61dcc1eecffed421c4b48c2d50d58a89c106c90e","0x1d4074ac2806f50033711a64f9722b63115d188999a192557c6d5b229cfce103","0x74ea80401cbaa208e2b9774b9c14b859463bcb68d2aaf826a9cc217216cdbb7d","0x6e39f72f7a4776f59ede9bf1c0325f9f79535b8a655e572baaefa75670aae2c1"],[E.ETHEREUM]:[],[E.BASE]:["0x4226e636db1dbaa1da860ce7df92d151aaea7f23934b94a21bc75d2c1d6233ee","0x50a4f3bc878614729c8dc9365a4ad9ea717e089870d706459c85e1f8fb89ac94"]};var Ie;const Un=((Ie=L.abi.find(e=>e.name==="getNavEntry"&&e.type==="function"))==null?void 0:Ie.outputs)||[];var Pe;const Vn=((Pe=He.abi.find(e=>e.name==="getNAVParts"&&e.type==="function"))==null?void 0:Pe.outputs)||[],st=e=>We(Un,e)[0],Bn=e=>We(Vn,e)[0],Rn=!0;async function kn(e,t,n=!0){var l;console.log("start calculating fund nav data ",e);const a=q(),s=g(),i=t[0],r=(l=s.chainContracts[e])==null?void 0:l.rethinkReaderContract;if(!r)throw new Error(`No reader contract found for chainId: ${e}`);const o=await r.methods.getFundsNAVData(i).call(),d=[];a.navMethodDetailsHashToFundAddress={};for(const[y,c]of o.entries()){const m=i[y];await In(e,c,m,y,a,t,d)}const p=new Map;for(const y of d)y.detailsHash&&!p.has(y.detailsHash)&&p.set(y.detailsHash,y);const u=Array.from(p.values());n&&(a.allNavMethods[e]=d,a.uniqueNavMethods[e]=u)}async function In(e,t,n,a,s,i,r){var l,y,c,m,T,A;if(s.chainFundNAVUpdates[e][n]=[],!((l=t.encodedNavUpdate)!=null&&l.length))return;let o=await s.fundStore.parseFundNAVUpdates(e,t,n);const d=((y=at[e])==null?void 0:y[n])||[];console.log("EXCLUDED INDEXES2",d),o=d.length?o.filter(f=>!d.includes(f.index)):o,s.chainFundNAVUpdates[e][n]=o,(m=(c=s.chainFunds)==null?void 0:c[e])!=null&&m[a]&&(s.chainFunds[e][a].navUpdates=o);const p=o[o.length-1],u=(T=s.chainFunds[e])==null?void 0:T[a];for(const[f,I]of t.encodedNavUpdate.entries())try{const P=st(I);for(const[G,V]of P.entries()){if(V.isPastNAVUpdate||V.pastNAVUpdateIndex!==0n)continue;const x=Fe(G,V);Rn&&x.detailsHash&&((A=Cn[e])!=null&&A.includes(x.detailsHash))||(x.pastNAVUpdateEntryFundAddress=n,x.pastNAVUpdateEntrySafeAddress=i[1][a].safe,r.push(x),x.detailsHash?s.navMethodDetailsHashToFundAddress[x.detailsHash]=n:console.error("Missing detailsHash for NAV method ",f,V))}}catch(P){console.log("Error processing NAV methods: ",P)}u&&(u.positionTypeCounts=Je(p),u.lastNAVUpdateTotalNAV=o.length?p.totalNAV||0n:u.totalDepositBalance||0n)}const q=ge({id:"funds",state:()=>({chainFunds:{},chainFundsInfoArrays:{},chainFundNAVUpdates:Object.fromEntries(Object.keys(O).map(e=>[e,{}])),allNavMethods:Object.fromEntries(Object.keys(O).map(e=>[e,[]])),uniqueNavMethods:Object.fromEntries(Object.keys(O).map(e=>[e,[]])),navMethodDetailsHashToFundAddress:{}}),getters:{funds(){return Object.values(this.chainFunds).reduce((e,t)=>e.concat(t),[])},fundStore(){return F()},web3Store(){return g()},chainAddressLabelMap(){const e={};for(const t in this.chainFunds.keys){e[t]={};for(const n of this.chainFunds[t])e[t][n.safeAddress]=n.title+" Safe",e[t][n.address]=n.title+" Vault"}return e}},actions:{fetchFundsInfoArrays(e){return h("fetchFundsInfoArraysAction",()=>xn(e))},fetchFunds(){return h("fetchFundsAction",()=>En())},fetchFundsMetaData(e,t,n){return h("fetchFundsMetaDataAction",()=>Dn(e,t,n))},fetchFundsNavMethods(e,t,n=!0){return h("fetchFundsNavMethodsAction",()=>kn(e,t,n))},calculateFundsPerformanceMetrics(e){return h("calculateFundsPerformanceMetricsAction",()=>vn(e))}}}),Pn=async(e,t,n=!1)=>{var l,y,c,m,T,A;const a=F(),s=q(),i=g(),r=ve();if(!((l=s.allNavMethods[e])!=null&&l.length)){const f=await s.fetchFundsInfoArrays(e);console.log("[CURRENT NAV] simulate fetch all nav methods"),await s.fetchFundsNavMethods(e,f)}console.log("[CURRENT NAV] START SIMULATE:");const o=((y=a.fund)==null?void 0:y.safeAddress)||"",d=((m=(c=a.fund)==null?void 0:c.baseToken)==null?void 0:m.decimals)||18,p=((A=(T=a.fund)==null?void 0:T.baseToken)==null?void 0:A.symbol)||"",u=[];for(const f of a.fundLastNAVUpdateMethods)u.push(r.requestConcurrencyLimit(()=>i.callWithRetry(e,()=>a.fetchSimulatedNAVMethodValue(e,t,o,d,p,f,!1,n),1,[-32603])));await Promise.allSettled(u)},On=async(e,t,n,a,s,i,r=!1,o=!1)=>{var y;const d=q(),p=g(),u=ve();if(console.log("fetchSimulatedNAVMethodValueAction: ",i,"safeAddress",n,"baseDecimals",a,"baseSymbol",s),!i.detailsHash){console.error("No detailsHash provided in navEntry.",i);return}if(!a||!s){console.error("simulateNAVMethodValue error: No fund base decimals or symbol.");return}if(!n){console.error("simulateNAVMethodValue error: No fund safe address.");return}const l=(y=p.chainContracts[e])==null?void 0:y.navCalculatorContract;try{i.foundMatchingPastNAVUpdateEntryFundAddress=!0,i.pastNAVUpdateEntryFundAddress||(i.pastNAVUpdateEntryFundAddress=d.navMethodDetailsHashToFundAddress[i.detailsHash??""]),i.pastNAVUpdateEntryFundAddress||(i.pastNAVUpdateEntryFundAddress=t,i.foundMatchingPastNAVUpdateEntryFundAddress=!1);let c=Dt[i.positionType];const m=[];if(i.positionType===M.Liquid?(m.push(Ke(i.details)),m.push(n)):i.positionType===M.Illiquid?(m.push(ze(i.details,a)),m.push(n)):i.positionType===M.NFT?m.push(Xe(i.details)):i.positionType===M.Composable&&(m.push(Ze(i.details)),console.warn("IS NON INIT TRUE"),r&&(c=c.replace("ReadOnly","NonInitReadOnly"))),m.push(t,0,!1,parseInt(i.details.pastNAVUpdateIndex),parseInt(i.details.pastNAVUpdateEntryIndex),i.pastNAVUpdateEntryFundAddress),r&&i.positionType===M.Composable){const{rethinkContractAddresses:T}=K(),A=o?"GovernableFundFactoryV1.5BeaconProxy":"GovernableFundFactoryBeaconProxy";m.push(T[A][e],u.activeAccountAddress)}console.debug("simulate json: ",JSON.stringify(m,null,2)),i.simulatedNavFormatted="N/A",i.simulatedNav=0n;try{const T=await p.callWithRetry(e,()=>l.methods[c](...m).call(),1,[-32603,310]);console.warn("simulated value: ",T);const A=T?te(T,a,!0,!1):"0";i.simulatedNavFormatted=A+" "+s,i.simulatedNav=T,i.isSimulatedNavError=!1}catch(T){i.isSimulatedNavError=!0,console.error("simulateNAVMethodValue: Failed simulating value for entry, check if there was some difference when hashing details on INAVMethod detailsHash: ",i,T)}}catch(c){console.error("simulateNAVMethodValue error: ",c)}},Ln=async()=>{var n,a,s,i;const e=F(),t=g();if(e.fundUserData.baseTokenBalance=BigInt("0"),!((a=(n=e.fund)==null?void 0:n.baseToken)!=null&&a.address)){console.log("Fund baseToken.address is not set.");return}if(!e.activeAccountAddress){console.log("activeAccountAddress is not set.");return}return e.fundUserData.baseTokenBalance=await t.callWithRetry(e.selectedFundChain,()=>e.fundBaseTokenContract.methods.balanceOf(e.activeAccountAddress).call()),console.log(`user base token balance of ${(i=(s=e.fund)==null?void 0:s.baseToken)==null?void 0:i.symbol} is ${e.fundUserData.baseTokenBalance}`),e.fundUserData.baseTokenBalance},_n=async()=>{var n,a,s,i;const e=F(),t=g();if(e.fundUserData.fundAllowance=BigInt("0"),!((a=(n=e.fund)==null?void 0:n.baseToken)!=null&&a.address)){console.log("Fund baseToken.address is not set.");return}return e.activeAccountAddress?(e.fundUserData.fundAllowance=await t.callWithRetry(e.selectedFundChain,()=>e.fundBaseTokenContract.methods.allowance(e.activeAccountAddress,e.selectedFundAddress).call()),console.log(`user fund allowance of ${(i=(s=e.fund)==null?void 0:s.baseToken)==null?void 0:i.symbol} is ${e.fundUserData.fundAllowance}`),e.fundUserData.fundAllowance):console.error("Active account not found")},qn=async(e,t)=>{var c,m,T;console.debug("fetchUserFundDataAction, refresh user balances",e,t);const n=F(),a=g();n.fetchUserFundDepositRedemptionRequests();const s=(c=a.chainContracts[e])==null?void 0:c.rethinkReaderContract,i=n.activeAccountAddress;if(!i||!s)return;const r=await a.callWithRetry(e,()=>s.methods.getFundUserData(t,i).call()),{baseTokenBalance:o,fundTokenBalance:d,governanceTokenBalance:p,fundAllowance:u,fundShareValue:l,fundDelegateAddress:y}=r;((m=n.fund)==null?void 0:m.address)!==((T=n.fund)==null?void 0:T.governanceToken.address)?(n.fundUserData.fundDelegateAddress=await a.callWithRetry(e,()=>n.fundGovernanceTokenContract.methods.delegates(n.activeAccountAddress).call()),y!==n.fundUserData.fundDelegateAddress&&console.warn("[MISMATCH] wrong delegate to address from reader contract",y,"should be:",n.fundUserData.fundDelegateAddress)):n.fundUserData.fundDelegateAddress=y,n.fundUserData.baseTokenBalance=BigInt(o),n.fundUserData.fundTokenBalance=BigInt(d),n.fundUserData.governanceTokenBalance=BigInt(p),n.fundUserData.fundAllowance=BigInt(u),n.fundUserData.fundShareValue=BigInt(l)},Gn=async()=>{var n,a;const e=F(),t=g();if(e.fundUserData.fundDelegateAddress="",!((a=(n=e.fund)==null?void 0:n.governanceToken)!=null&&a.address)){console.log("Fund governanceToken.address is not set.");return}if(!e.activeAccountAddress){console.log("activeAccountAddress is not set.");return}return console.warn("FETCH userFundDelegateAddress"),e.fundUserData.fundDelegateAddress=await t.callWithRetry(e.selectedFundChain,()=>e.fundGovernanceTokenContract.methods.delegates(e.activeAccountAddress).call()),console.warn("FETCH userFundDelegateAddress",e.fundUserData.fundDelegateAddress),e.fundUserData.fundDelegateAddress};var he=(e=>(e.Deposit="Deposit",e.Redemption="Redemption",e))(he||{});const Hn={Deposit:273,Redemption:274},Wn=async()=>{const e=F();if(!e.activeAccountAddress)return console.error("Active account not found");if(!e.selectedFundAddress)return"";const[t,n]=await Promise.allSettled([()=>e.fetchUserFundTransactionRequest(he.Deposit),()=>e.fetchUserFundTransactionRequest(he.Redemption)].map(i=>e.accountStore.requestConcurrencyLimit(i))),a=t.status==="fulfilled"?t.value:void 0,s=n.status==="fulfilled"?n.value:void 0;e.fundUserData.depositRequest=a,e.fundUserData.redemptionRequest=s},$n=async()=>{var a;const e=F(),t=g();if(e.fundUserData.fundShareValue=BigInt("0"),!e.activeAccountAddress)return console.error("Active account not found");if(!((a=e.fund)!=null&&a.fundTokenTotalSupply))return e.fundUserData.fundShareValue;let n=BigInt("0");try{n=await t.callWithRetry(e.selectedFundChain,()=>e.fundContract.methods.valueOf(e.activeAccountAddress).call())}catch(s){console.error("The total fund balance is probably 0, which is why MetaMask may be showing the 'Internal JSON-RPC... division by 0' error. -> ",s)}return console.log("balanceWei user fund share value:",n),e.fundUserData.fundShareValue=n,e.fundUserData.fundShareValue},Jn=async()=>{var n,a,s,i;const e=F(),t=g();if(e.fundUserData.fundTokenBalance=BigInt("0"),!((a=(n=e.fund)==null?void 0:n.fundToken)!=null&&a.address)){console.log("Fund fundToken.address is not set.");return}if(!e.activeAccountAddress){console.log("activeAccountAddress is not set.");return}return e.fundUserData.fundTokenBalance=await t.callWithRetry(e.selectedFundChain,()=>e.fundContract.methods.balanceOf(e.activeAccountAddress).call()),console.log(`user fund token balance of ${(i=(s=e.fund)==null?void 0:s.fundToken)==null?void 0:i.symbol} is ${e.fundUserData.fundTokenBalance}`),e.fundUserData.fundTokenBalance};function Re(e){return e.startsWith("0x")?e.slice(2):e}function jn(e,t){const n=Re(xe(Tt(t),32)),s=Re(xe(bt(e),32))+n;return Le("0x"+s)}function Qn(e){return"0x"+(BigInt(e)+BigInt(1)).toString(16)}const Yn=async e=>{const t=F(),n=g(),a=t.fundAddress,s=t.selectedFundChain;if(!s)return;const i=n.chainProviders[s];if(!t.activeAccountAddress||!a)return;const r=Hn[e],o=jn(t.activeAccountAddress,r),d=Qn(o);console.debug("[FETCH REQUEST] AMOUNT",e);try{const p=await n.callWithRetry(s,()=>i==null?void 0:i.eth.getStorageAt(a,o));console.debug("[FETCH REQUEST] AMOUNT fetched",e,p);let u=De(p);u=u==="0x"?0n:BigInt(u),console.debug("[FETCH REQUEST] fetch TS",e);const l=await n.callWithRetry(s,()=>i==null?void 0:i.eth.getStorageAt(a,d));console.debug("[FETCH REQUEST] TS",e,l);let y=De(l);return y=y==="0x"?0:Number(y)*1e3,{amount:u,timestamp:y,type:e}}catch(p){console.error(`Failed fetching deposit/withdrawal request ${a} slot: ${r}. -> `,p)}},Kn=async()=>{var n,a,s,i;const e=F(),t=g();if(e.selectedFundChain){if(e.fundUserData.governanceTokenBalance=BigInt("0"),!((a=(n=e.fund)==null?void 0:n.governanceToken)!=null&&a.address)){console.log("Fund governanceToken.address is not set.");return}if(!e.activeAccountAddress){console.log("activeAccountAddress is not set.");return}e.fundUserData.governanceTokenBalance=await t.callWithRetry(e.selectedFundChain,()=>e.fundGovernanceTokenContract.methods.balanceOf(e.activeAccountAddress).call()),console.log(`user governance token balance is ${e.fundUserData.governanceTokenBalance} ${(i=(s=e.fund)==null?void 0:s.fundToken)==null?void 0:i.symbol}`)}},zn=async(e,t,n)=>{var d,p;const a=[];t.encodedNavParts.forEach(u=>{const l=Bn(u);a.push({baseAssetOIVBal:l.baseAssetOIVBal,baseAssetSafeBal:l.baseAssetSafeBal,feeBal:l.feeBal,totalNAV:l.totalNAV})});const s=fe([]),i=t.updateTimes.length,r=t.updateTimes;for(let u=0;u<i;u++){const l=Number(r[u]*1000n);s.push({index:u+1,date:r[u]?Q(new Date(l)):`#${(u+1).toString()}}`,timestamp:l,navParts:a[u],totalNAV:(d=a[u])==null?void 0:d.totalNAV,entries:[]})}t.encodedNavUpdate.forEach((u,l)=>{let y=[];try{y=st(u)}catch(c){console.error("Error decoding navUpdate entry: ",c)}for(const[c,m]of y.entries()){const T=Fe(c,m);s[l].entries.push(T)}});const o=((p=s[s.length-1])==null?void 0:p.entries)??[];for(let u=0;u<o.length;u++)await Xn(e,n,u,o[u]);return s},Xn=async(e,t,n,a)=>{var o;const i=(o=g().chainContracts[e])==null?void 0:o.navCalculatorContract;if(!i)throw new Error(`No navCalculatorContract found for chainId: ${e}`);const r=Ct[a.positionType];a.pastNavValue=void 0,a.pastNavValueLoading=!0,a.pastNavValueError=!1;try{const d=await i.methods[r](t,n).call();a.pastNavValue=d.reduce((p,u)=>p+u,0n)}catch(d){a.pastNavValueError=!0,console.error(`Failed to fetch NAV method last NAV value ${n}:`,a,d)}a.pastNavValueLoading=!1},Zn=async()=>{const e=F(),{getNAVExecutorBeaconProxyAddress:t}=K();try{const n=t(e.selectedFundChain);if(!n){e.toastStore.errorToast("The NAV Executor address is not available for this network. Please contact the Rethink Finance support.");return}return await e.fundContract.send("executeNAVUpdate",{},n).on("transactionHash",a=>{console.log("tx hash: "+a),e.toastStore.warningToast("The transaction has been submitted. Please wait for it to be confirmed.")}).on("receipt",a=>{console.log(a),a.status?e.toastStore.successToast("The recalculation of vault NAV has Succeeded"):e.toastStore.errorToast("The recalculation of vault NAV has failed. Please contact the Rethink Finance support.")}).on("error",a=>{throw console.log(a),e.toastStore.errorToast("There has been an error. Please contact the Rethink Finance support."),a})}catch(n){throw console.error("Error updating NAV: ",n),e.toastStore.errorToast("There has been an error. Please contact the Rethink Finance support."),n}},ea={abi:[{inputs:[],name:"InvalidShortString",type:"error"},{inputs:[{internalType:"string",name:"str",type:"string"}],name:"StringTooLong",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"delegator",type:"address"},{indexed:!0,internalType:"address",name:"fromDelegate",type:"address"},{indexed:!0,internalType:"address",name:"toDelegate",type:"address"}],name:"DelegateChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"delegate",type:"address"},{indexed:!1,internalType:"uint256",name:"previousBalance",type:"uint256"},{indexed:!1,internalType:"uint256",name:"newBalance",type:"uint256"}],name:"DelegateVotesChanged",type:"event"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"clock",outputs:[{internalType:"uint48",name:"",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[],name:"CLOCK_MODE",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint32",name:"pos",type:"uint32"}],name:"checkpoints",outputs:[{components:[{internalType:"uint32",name:"fromBlock",type:"uint32"},{internalType:"uint224",name:"votes",type:"uint224"}],internalType:"struct ERC20Votes.Checkpoint",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"numCheckpoints",outputs:[{internalType:"uint32",name:"",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"delegates",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getVotes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"getPastVotes",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"timepoint",type:"uint256"}],name:"getPastTotalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"delegatee",type:"address"}],name:"delegate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"delegatee",type:"address"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"expiry",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"delegateBySig",outputs:[],stateMutability:"nonpayable",type:"function"}]},ta=JSON.parse('[{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"owner","type":"address"}],"name":"AddedOwner","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"approvedHash","type":"bytes32"},{"indexed":true,"internalType":"address","name":"owner","type":"address"}],"name":"ApproveHash","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"handler","type":"address"}],"name":"ChangedFallbackHandler","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"guard","type":"address"}],"name":"ChangedGuard","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"threshold","type":"uint256"}],"name":"ChangedThreshold","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"}],"name":"DisabledModule","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"}],"name":"EnabledModule","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"bytes32","name":"txHash","type":"bytes32"},{"indexed":false,"internalType":"uint256","name":"payment","type":"uint256"}],"name":"ExecutionFailure","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"module","type":"address"}],"name":"ExecutionFromModuleFailure","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"module","type":"address"}],"name":"ExecutionFromModuleSuccess","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"bytes32","name":"txHash","type":"bytes32"},{"indexed":false,"internalType":"uint256","name":"payment","type":"uint256"}],"name":"ExecutionSuccess","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"owner","type":"address"}],"name":"RemovedOwner","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"module","type":"address"},{"indexed":false,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"},{"indexed":false,"internalType":"bytes","name":"data","type":"bytes"},{"indexed":false,"internalType":"enum Enum.Operation","name":"operation","type":"uint8"}],"name":"SafeModuleTransaction","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"},{"indexed":false,"internalType":"bytes","name":"data","type":"bytes"},{"indexed":false,"internalType":"enum Enum.Operation","name":"operation","type":"uint8"},{"indexed":false,"internalType":"uint256","name":"safeTxGas","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"baseGas","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"gasPrice","type":"uint256"},{"indexed":false,"internalType":"address","name":"gasToken","type":"address"},{"indexed":false,"internalType":"address payable","name":"refundReceiver","type":"address"},{"indexed":false,"internalType":"bytes","name":"signatures","type":"bytes"},{"indexed":false,"internalType":"bytes","name":"additionalInfo","type":"bytes"}],"name":"SafeMultiSigTransaction","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"sender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"SafeReceived","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"initiator","type":"address"},{"indexed":false,"internalType":"address[]","name":"owners","type":"address[]"},{"indexed":false,"internalType":"uint256","name":"threshold","type":"uint256"},{"indexed":false,"internalType":"address","name":"initializer","type":"address"},{"indexed":false,"internalType":"address","name":"fallbackHandler","type":"address"}],"name":"SafeSetup","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"bytes32","name":"msgHash","type":"bytes32"}],"name":"SignMsg","type":"event"},{"stateMutability":"nonpayable","type":"fallback"},{"inputs":[],"name":"VERSION","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"uint256","name":"_threshold","type":"uint256"}],"name":"addOwnerWithThreshold","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"hashToApprove","type":"bytes32"}],"name":"approveHash","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"approvedHashes","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_threshold","type":"uint256"}],"name":"changeThreshold","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"dataHash","type":"bytes32"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"bytes","name":"signatures","type":"bytes"},{"internalType":"uint256","name":"requiredSignatures","type":"uint256"}],"name":"checkNSignatures","outputs":[],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"bytes32","name":"dataHash","type":"bytes32"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"bytes","name":"signatures","type":"bytes"}],"name":"checkSignatures","outputs":[],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"prevModule","type":"address"},{"internalType":"address","name":"module","type":"address"}],"name":"disableModule","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"domainSeparator","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"module","type":"address"}],"name":"enableModule","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"},{"internalType":"uint256","name":"safeTxGas","type":"uint256"},{"internalType":"uint256","name":"baseGas","type":"uint256"},{"internalType":"uint256","name":"gasPrice","type":"uint256"},{"internalType":"address","name":"gasToken","type":"address"},{"internalType":"address","name":"refundReceiver","type":"address"},{"internalType":"uint256","name":"_nonce","type":"uint256"}],"name":"encodeTransactionData","outputs":[{"internalType":"bytes","name":"","type":"bytes"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"},{"internalType":"uint256","name":"safeTxGas","type":"uint256"},{"internalType":"uint256","name":"baseGas","type":"uint256"},{"internalType":"uint256","name":"gasPrice","type":"uint256"},{"internalType":"address","name":"gasToken","type":"address"},{"internalType":"address payable","name":"refundReceiver","type":"address"},{"internalType":"bytes","name":"signatures","type":"bytes"}],"name":"execTransaction","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"}],"name":"execTransactionFromModule","outputs":[{"internalType":"bool","name":"success","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"}],"name":"execTransactionFromModuleReturnData","outputs":[{"internalType":"bool","name":"success","type":"bool"},{"internalType":"bytes","name":"returnData","type":"bytes"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getChainId","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"start","type":"address"},{"internalType":"uint256","name":"pageSize","type":"uint256"}],"name":"getModulesPaginated","outputs":[{"internalType":"address[]","name":"array","type":"address[]"},{"internalType":"address","name":"next","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getOwners","outputs":[{"internalType":"address[]","name":"","type":"address[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"offset","type":"uint256"},{"internalType":"uint256","name":"length","type":"uint256"}],"name":"getStorageAt","outputs":[{"internalType":"bytes","name":"","type":"bytes"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getThreshold","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"},{"internalType":"uint256","name":"safeTxGas","type":"uint256"},{"internalType":"uint256","name":"baseGas","type":"uint256"},{"internalType":"uint256","name":"gasPrice","type":"uint256"},{"internalType":"address","name":"gasToken","type":"address"},{"internalType":"address","name":"refundReceiver","type":"address"},{"internalType":"uint256","name":"_nonce","type":"uint256"}],"name":"getTransactionHash","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"module","type":"address"}],"name":"isModuleEnabled","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"owner","type":"address"}],"name":"isOwner","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"nonce","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"prevOwner","type":"address"},{"internalType":"address","name":"owner","type":"address"},{"internalType":"uint256","name":"_threshold","type":"uint256"}],"name":"removeOwner","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"value","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"enum Enum.Operation","name":"operation","type":"uint8"}],"name":"requiredTxGas","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"handler","type":"address"}],"name":"setFallbackHandler","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"guard","type":"address"}],"name":"setGuard","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address[]","name":"_owners","type":"address[]"},{"internalType":"uint256","name":"_threshold","type":"uint256"},{"internalType":"address","name":"to","type":"address"},{"internalType":"bytes","name":"data","type":"bytes"},{"internalType":"address","name":"fallbackHandler","type":"address"},{"internalType":"address","name":"paymentToken","type":"address"},{"internalType":"uint256","name":"payment","type":"uint256"},{"internalType":"address payable","name":"paymentReceiver","type":"address"}],"name":"setup","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"signedMessages","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"targetContract","type":"address"},{"internalType":"bytes","name":"calldataPayload","type":"bytes"}],"name":"simulateAndRevert","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"prevOwner","type":"address"},{"internalType":"address","name":"oldOwner","type":"address"},{"internalType":"address","name":"newOwner","type":"address"}],"name":"swapOwner","outputs":[],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}]'),na={abi:ta},aa=async(e,t)=>{const n=g();if(!e)throw new Error("No vault chainId provided, cannot fetch vault settings.");if(!t)throw new Error("No fundAddress provided, cannot fetch vault settings.");const a=n.getCustomContract(e,L.abi,t);console.log("GET fund settings");const s=await n.callWithRetry(e,()=>a.methods.getFundSettings().call());return console.log("fund settings:",s),s},sa=async e=>{const t=F(),n=g();if(!e)return"";let a=t.fundRoleModAddress[e];if(a)return a;const s="0x0000000000000000000000000000000000000001";return a=(await n.callWithRetry(t.selectedFundChain,()=>t.fundSafeContract.methods.getModulesPaginated(s,10).call()))[0][1],t.fundRoleModAddress[e]=a,a},ke={baseTokenBalance:0n,fundTokenBalance:0n,governanceTokenBalance:0n,fundAllowance:0n,fundShareValue:0n,fundDelegateAddress:"",depositRequest:void 0,redemptionRequest:void 0},F=ge({id:"fund",state:()=>({chainFunds:Object.fromEntries(Object.keys(O).map(e=>[e,{}])),chainAddressSourceCode:Object.fromEntries(Object.keys(O).map(e=>[e,{}])),fundUserData:structuredClone(ke),selectedFundChain:E.ETHEREUM,selectedFundAddress:"",fundManagedNAVMethods:[],fundInitialNAVMethods:[],fundRoleModAddress:{},refreshSimulateNAVCounter:0}),getters:{accountStore(){return ve()},activeAccountAddress(){var e;return(e=this.accountStore.activeAccount)==null?void 0:e.address},web3Store(){return g()},fundsStore(){return q()},toastStore(){return ht()},fundAddress(){var e;return((e=this.fund)==null?void 0:e.address)??this.selectedFundAddress??""},fund(){var e,t;return(t=(e=this.chainFunds)==null?void 0:e[this.selectedFundChain])==null?void 0:t[this.selectedFundAddress]},addressLabelMap(){var t,n,a,s;const e={};return(t=this.fund)!=null&&t.safeAddress&&(e[this.fund.safeAddress]=((n=this.fund)==null?void 0:n.title)+" Safe"),(a=this.fund)!=null&&a.address&&(e[this.fund.address]=((s=this.fund)==null?void 0:s.title)+" Vault"),e},isUsingZodiacPilotExtension(){var e,t;return((e=this.activeAccountAddress)==null?void 0:e.toLowerCase())===((t=this.fund)==null?void 0:t.safeAddress.toLowerCase())},baseToFundTokenExchangeRate(){var a,s,i,r,o,d,p,u,l,y,c,m,T;if(!((s=(a=this.fund)==null?void 0:a.baseToken)!=null&&s.decimals)||!((r=(i=this.fund)==null?void 0:i.fundToken)!=null&&r.decimals))return R.fromString("0");if(!this.fundLastNAVUpdate){if(!((o=this.fund)!=null&&o.baseToken)||!((d=this.fund)!=null&&d.fundToken))return R.fromString("0");if(((p=this.fund)==null?void 0:p.fundToken.decimals)===((u=this.fund)==null?void 0:u.baseToken.decimals))return R.fromString("1");const A=Number((l=this.fund)==null?void 0:l.fundToken.decimals)-Number((y=this.fund)==null?void 0:y.baseToken.decimals);let f=R.fromString("1"+"0".repeat(Math.abs(A)));return A>=0&&(f=R.fromString("1").div(f)),f}if(!this.fundLastNAVUpdate.totalNAV||!((c=this.fund)!=null&&c.fundTokenTotalSupply))return R.fromString("0");const e=((m=this.fund)==null?void 0:m.totalSimulatedNav)||this.fundLastNAVUpdate.totalNAV;console.warn("Total Simulated NAV: ",(T=this.fund)==null?void 0:T.totalSimulatedNav,"Last NAV: ",this.fundLastNAVUpdate.totalNAV);const t=R.fromString(ee(e,this.fund.baseToken.decimals));return R.fromString(ee(this.fund.fundTokenTotalSupply,this.fund.fundToken.decimals)).div(t)},fundToBaseTokenExchangeRate(){return this.baseToFundTokenExchangeRate.eq(R.fromString("0"))?this.baseToFundTokenExchangeRate:R.fromString("1").div(this.baseToFundTokenExchangeRate)},userDepositRequest(){return this.fundUserData.depositRequest},userRedemptionRequest(){return this.fundUserData.redemptionRequest},userCurrentValue(){var t,n,a,s;if((t=this.fundLastNAVUpdate)!=null&&t.timestamp)return((n=this.fundUserData)==null?void 0:n.fundShareValue)||0n;const e=((a=this.fund)==null?void 0:a.fundTokenTotalSupply)||0n;return e?(this.fundTotalNAV*((s=this.fundUserData)==null?void 0:s.fundTokenBalance)||0n)/e:0n},fundTotalNAV(){var e,t,n;return(e=this.fundLastNAVUpdate)!=null&&e.timestamp?((t=this.fund)==null?void 0:t.lastNAVUpdateTotalNAV)||0n:((n=this.fund)==null?void 0:n.totalDepositBalance)||0n},fundTotalNAVFormattedShort(){var e;return(e=this.fund)!=null&&e.address?this.getFormattedBaseTokenValue(this.fundTotalNAV):"N/A"},selectedFundSlug(){var e,t;return(this.selectedFundChain||"")+"-"+(((e=this.fund)==null?void 0:e.fundToken.symbol)||"")+"-"+(((t=this.fund)==null?void 0:t.address)||"")},fundLastNAVUpdate(){var t,n,a,s;const e=(n=(t=this.fund)==null?void 0:t.navUpdates)==null?void 0:n.length;if(e)return console.warn("fundLastNAVUpdate",(a=this.fund)==null?void 0:a.navUpdates[e-1]),(s=this.fund)==null?void 0:s.navUpdates[e-1]},fundLastNAVUpdateMethods(){var e;return((e=this.fundLastNAVUpdate)==null?void 0:e.entries)||[]},userDepositRequestExists(){var e;return(((e=this.fundUserData.depositRequest)==null?void 0:e.amount)||0)>0},userRedemptionRequestExists(){var e;return(((e=this.fundUserData.redemptionRequest)==null?void 0:e.amount)||0)>0},userFundSuggestedAllowance(){var n,a;const e=((n=this.fundUserData)==null?void 0:n.baseTokenBalance)||0n,t=((a=this.fundUserData.depositRequest)==null?void 0:a.amount)||0n;return e+t},userFundSuggestedAllowanceFormatted(){var e;return ee(this.userFundSuggestedAllowance,(e=this.fund)==null?void 0:e.baseToken.decimals)},isUserWalletWhitelisted(){var t,n,a;return(t=this.fund)!=null&&t.isWhitelistedDeposits?(((n=this.fund)==null?void 0:n.allowedDepositAddresses)||[]).map(s=>s.toLowerCase()).includes(((a=this.activeAccountAddress)==null?void 0:a.toLowerCase())||""):!0},shouldUserDelegate(){var e,t;return((e=this.fundUserData)==null?void 0:e.fundDelegateAddress)===me||!((t=this.fundUserData)!=null&&t.fundDelegateAddress)},shouldUserRequestDeposit(){return!this.userDepositRequestExists},shouldUserApproveAllowance(){var e,t;return this.userDepositRequestExists&&(((e=this.fundUserData)==null?void 0:e.fundAllowance)||0n)<(((t=this.fundUserData.depositRequest)==null?void 0:t.amount)||0n)},canUserProcessDeposit(){return!this.shouldUserRequestDeposit&&!this.shouldUserApproveAllowance},shouldUserWaitSettlementOrCancelDeposit(){var e,t,n,a,s;return console.log(`Should process deposit: fundLastNAVUpdate.timestamp: ${(e=this.fundLastNAVUpdate)==null?void 0:e.timestamp} 
        userDepositRequest.timestamp ${(t=this.fundUserData.depositRequest)==null?void 0:t.timestamp}`),!this.canUserProcessDeposit||!((n=this.fundLastNAVUpdate)!=null&&n.timestamp)||!((a=this.fundUserData.depositRequest)!=null&&a.timestamp)?!1:this.fundUserData.depositRequest.timestamp>=((s=this.fundLastNAVUpdate)==null?void 0:s.timestamp)},shouldUserWaitSettlementOrCancelRedemption(){var e,t,n,a,s;return console.log(`Should process withdraw: fundLastNAVUpdate.timestamp: ${(e=this.fundLastNAVUpdate)==null?void 0:e.timestamp} 
        userDepositRequest.timestamp ${(t=this.fundUserData.redemptionRequest)==null?void 0:t.timestamp}`),!((n=this.fundLastNAVUpdate)!=null&&n.timestamp)||!((a=this.fundUserData.redemptionRequest)!=null&&a.timestamp)?!1:this.fundUserData.redemptionRequest.timestamp>=((s=this.fundLastNAVUpdate)==null?void 0:s.timestamp)},totalCurrentSimulatedNAV(){var t,n,a;return(this.fundLastNAVUpdateMethods.reduce((s,i)=>s+(i.simulatedNav||0n),0n)||0n)+(((t=this.fund)==null?void 0:t.fundContractBaseTokenBalance)||0n)+(((n=this.fund)==null?void 0:n.safeContractBaseTokenBalance)||0n)+(((a=this.fund)==null?void 0:a.feeBalance)||0n)},getFormattedBaseTokenValue:e=>(t,n=!0,a=!1,s,i)=>{var u,l,y,c;const r=(l=(u=e.chainFunds)==null?void 0:u[e.selectedFundChain])==null?void 0:l[e.selectedFundAddress],o=s||((y=r==null?void 0:r.baseToken)==null?void 0:y.symbol),d=i||((c=r==null?void 0:r.baseToken)==null?void 0:c.decimals)||18,p=t?te(t,d,n,a):"0";return o?p+" "+o:p},getFormattedFundTokenValue:e=>(t,n=!0,a=!1)=>{var d,p;const s=(p=(d=e.chainFunds)==null?void 0:d[e.selectedFundChain])==null?void 0:p[e.selectedFundAddress],i=s==null?void 0:s.fundToken.symbol,r=s==null?void 0:s.fundToken.decimals;return r?(t?te(t,r,n,a):"0")+" "+i:t},navCalculatorContract(){return this.web3Store.getCustomContract(this.selectedFundChain,He.abi,this.web3Store.NAVCalculatorBeaconProxyAddress)},fundContract(){return this.web3Store.getCustomContract(this.selectedFundChain,L.abi,this.selectedFundAddress)},fundSafeContract(){var e;return this.web3Store.getCustomContract(this.selectedFundChain,na.abi,(e=this.fund)==null?void 0:e.safeAddress)},fundGovernorContract(){var e;return this.web3Store.getCustomContract(this.selectedFundChain,Ut.abi,(e=this.fund)==null?void 0:e.governorAddress)},fundBaseTokenContract(){var e,t;return this.web3Store.getCustomContract(this.selectedFundChain,ne,(t=(e=this.fund)==null?void 0:e.baseToken)==null?void 0:t.address)},fundGovernanceTokenContract(){var e;return this.web3Store.getCustomContract(this.selectedFundChain,ea.abi,(e=this.fund)==null?void 0:e.governanceToken.address)}},actions:{resetFundData(e,t){this.chainFunds[e][t]=void 0,this.fundUserData.depositRequest=void 0,this.fundUserData.redemptionRequest=void 0,this.fundManagedNAVMethods=[],this.fundInitialNAVMethods=[],this.fundRoleModAddress={},this.fundUserData=structuredClone(ke)},async fetchAddressSourceCode(e,t){var s;if(!t)return;if(this.chainAddressSourceCode[e][t])return this.chainAddressSourceCode[e][t];const{$getExplorer:n}=Oe();let a;try{a=n(e)}catch{this.chainAddressSourceCode[e][t]=void 0;return}if(t.toLowerCase()===((s=this.fund)==null?void 0:s.address.toLowerCase())){const i={ContractName:this.fund.title+" (GovernableFund)",ABI:JSON.stringify(L.abi)};return this.chainAddressSourceCode[e][t]=i,i}try{const i=await a.sourceCode(t);if(i.Proxy==="0"){try{const r=this.web3Store.getCustomContract(e,ne,t);i.symbol=await r.methods.symbol().call()}catch{}this.chainAddressSourceCode[e][t]=i}return i}catch{this.chainAddressSourceCode[e][t]=void 0;return}},async getAddressLabel(e,t){var a,s;if(!t)return;if(this.addressLabelMap[e])return this.addressLabelMap[e];if((a=this.fundsStore.chainAddressLabelMap[t])!=null&&a[e])return(s=this.fundsStore.chainAddressLabelMap[t])==null?void 0:s[e];const n=await this.fetchAddressSourceCode(t,e);if(n!=null&&n.symbol){let i=n==null?void 0:n.symbol;if(n!=null&&n.ContractName)return i+=` (${n.ContractName})`,i}return n==null?void 0:n.ContractName},fetchFundData(e,t){return h("fetchFundDataAction",()=>Wt(e,t))},fetchFundSettings(e,t){return h("fetchFundSettingsAction",()=>aa(e,t))},fetchFundNAVData(){return h("fetchFundNAVDataAction",()=>gn())},fetchUserFundData(e,t){return h("fetchUserFundDataAction",()=>qn(e,t))},fetchFundMetaData(e,t){return h("fetchFundMetaDataAction",()=>Qt(e,t))},fetchFundPendingDepositRedemptionBalance(){this.fund&&(this.fund.pendingDepositBalanceError=!1,this.fund.pendingRedemptionBalanceError=!1,this.fund.pendingDepositBalanceLoading=!0,this.fund.pendingRedemptionBalanceLoading=!0,this.web3Store.callWithRetry(this.selectedFundChain,()=>this.fundContract.methods.getCurrentPendingDepositBal().call()).then(e=>{this.fund&&(this.fund.pendingDepositBalance=e)}).catch(e=>{console.error("failed fetching fund deposit requests balance.",e),this.fund&&(this.fund.pendingDepositBalanceError=!0)}).finally(()=>{this.fund&&(this.fund.pendingDepositBalanceLoading=!1)}),this.web3Store.callWithRetry(this.selectedFundChain,()=>this.fundContract.methods.getCurrentPendingWithdrawalBal().call()).then(e=>{this.fund&&(this.fund.pendingRedemptionBalance=e)}).catch(e=>{console.error("failed fetching fund redemption requests balance.",e),this.fund&&(this.fund.pendingRedemptionBalanceError=!0)}).finally(()=>{this.fund&&(this.fund.pendingRedemptionBalanceLoading=!1)}))},simulateCurrentNAV(e=!1){return h("fetchSimulateCurrentNAVAction",()=>Pn(this.selectedFundChain,this.fundAddress,e))},fetchSimulatedNAVMethodValue(e,t,n,a,s,i,r=!1,o=!1){return h("fetchSimulatedNAVMethodValueAction",()=>On(e,t,n,a,s,i,r,o))},parseFundNAVUpdates(e,t,n){return h("parseFundNAVUpdatesAction",()=>zn(e,t,n))},fetchUserBaseTokenBalance(){return h("fetchUserBaseTokenBalanceAction",()=>Ln())},fetchUserFundTokenBalance(){return h("fetchUserFundTokenBalanceAction",()=>Jn())},fetchUserGovernanceTokenBalance(){return h("fetchUserGovernanceTokenBalanceAction",()=>Kn())},fetchUserFundDelegateAddress(){return h("fetchUserFundDelegateAddressAction",()=>Gn())},fetchUserFundAllowance(){return h("fetchUserFundAllowanceAction",()=>_n())},fetchUserFundShareValue(){return h("fetchUserFundShareValueAction",()=>$n())},fetchUserFundDepositRedemptionRequests(){return h("fetchUserFundDepositRedemptionRequestsAction",()=>Wn())},fetchUserFundTransactionRequest(e){return h("fetchUserFundTransactionRequestAction",()=>Yn(e))},async fetchFundContractBaseTokenBalance(){var t;if(!((t=this.fund)!=null&&t.address))return;this.fund.fundContractBaseTokenBalanceLoading=!0;let e=BigInt("0");try{e=await this.web3Store.callWithRetry(this.selectedFundChain,()=>{var n;return this.fundBaseTokenContract.methods.balanceOf((n=this.fund)==null?void 0:n.address).call()}),this.fund.fundContractBaseTokenBalanceError=!1}catch(n){this.fund.fundContractBaseTokenBalanceError=!0,console.error("Failed fetching fetchFundBaseTokenBalance error. -> ",n)}this.fund.fundContractBaseTokenBalance=e,this.fund.fundContractBaseTokenBalanceLoading=!1},fetchRoleModAddress(e){return h("fetchRoleModAddressAddressAction",()=>sa(e))},postUpdateNAV(){return h("postUpdateNAVAction",()=>Zn())},calculateFundPerformanceMetrics(e){return h("calculateFundPerformanceMetricsAction",()=>It(e))}}});export{_ as A,h as B,se as C,Na as D,ne as E,ca as F,na as G,pa as H,on as I,N as J,Ta as K,sn as L,ma as M,Ye as N,rn as O,v as P,ya as Q,Ut as R,la as S,Fe as T,be as U,An as V,fn as W,he as X,nn as Z,dn as a,Fa as b,Sa as c,va as d,Aa as e,ha as f,fa as g,j as h,Vt as i,q as j,hn as k,Ma as l,wa as m,Ea as n,an as o,tt as p,ga as q,C as r,bn as s,ba as t,F as u,pn as v,re as w,Ve as x,et as y,L as z};

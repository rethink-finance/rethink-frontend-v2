import be from"./CzFhc0vV.js";import{u as ne,i as we,A as ve,F as je,E as ze,Y as De}from"./BMM55Xfq.js";import{d as Q,r as P,cC as Ae,f as u,o as n,b as v,e as s,_ as K,a as i,w as A,q as R,c as V,cF as F,c8 as h,cu as M,cY as de,db as Ye,G as le,d9 as He,h as k,cx as ee,z as pe,V as ue,i as me,c9 as ge,cZ as $e,ck as Ge,d6 as Ke,P as Be,f8 as Ze,l as ye,dJ as Qe,u as Te,cK as Je,fK as Xe,Z as Ue,ca as et,p as tt,er as st,es as nt,da as ot}from"./_BmmGIGi.js";import{p as Pe}from"./ByJoLLJq.js";import{i as Ne,t as at}from"./BjIfPQ7A.js";import{d as ie,s as Ee,Q as lt,t as qe,R as Ce,u as ke,b as fe,F as ce,v as it}from"./BwiW5Nlt.js";import rt from"./PfKl3Gg-.js";import dt from"./DlPKfCSi.js";import ut from"./xHieza-o.js";import{_ as ct}from"./B-BrJIQs.js";import{V as se}from"./E_YhHG9T.js";import Ve from"./BypdNV1Y.js";import{n as Ie}from"./C-6dRAei.js";import{_ as Re}from"./rabGxBID.js";import ft from"./CBeRrrVN.js";import{u as mt}from"./DxTlZv4G.js";import{V as Se}from"./DtO3A6PH.js";import _t from"./CyOBiGYz.js";import pt from"./DAKP5pNJ.js";import vt from"./BSRo00oN.js";import ht from"./DPb0Tc9L.js";import"./D4QhXGu9.js";import"./BJ2h6DUM.js";import"./cVa1OdO9.js";import"./CKS8D1OD.js";import"./DWhwHasW.js";import"./CsjIet9h.js";import"./BlSCcxsD.js";import"./D5-R3KnC.js";import"./B5L2f44s.js";const gt={class:"main_grid"},kt=Q({__name:"Basics",props:{fund:{type:Object,default:()=>{}}},setup(e){const o=ne(),l=e,d=P("");return Ae(()=>{var a;return(a=l.fund)==null?void 0:a.address},async()=>{var a,t;(a=l.fund)!=null&&a.address?d.value=await o.fetchRoleModAddress((t=l.fund)==null?void 0:t.address):d.value=""},{deep:!0,immediate:!0}),(a,t)=>{var f,c,_;const r=be;return n(),u("div",gt,[v(r,{title:(f=e.fund.fundToken)==null?void 0:f.symbol,subtitle:"Vault Token Symbol"},null,8,["title"]),v(r,{title:(c=e.fund.baseToken)==null?void 0:c.symbol,subtitle:"Denomination Asset"},null,8,["title"]),v(r,{title:e.fund.safeAddress,subtitle:"Safe Contract"},null,8,["title"]),v(r,{title:(_=e.fund.fundToken)==null?void 0:_.address,subtitle:"Admin Contract"},null,8,["title"]),v(r,{title:s(d),subtitle:"Roles Modifier Contract"},null,8,["title"])])}}}),bt=Q({name:"Deposits",props:{fund:{type:Object,default:()=>{}}},computed:{depositsTitle(){var o,l;const e=((l=(o=this.fund)==null?void 0:o.allowedDepositAddresses)==null?void 0:l.length)??0;return e===1?`${e} Address`:`${e} Addresses`},depositsBody(){var e,o;return(o=(e=this.fund)==null?void 0:e.allowedDepositAddresses)!=null&&o.length?this.fund.allowedDepositAddresses.join(`
`):"There are currently no whitelisted deposit addresses."}}}),yt={class:"main_grid"};function Tt(e,o,l,d,a,t){const r=be;return n(),u("div",yt,[v(r,{title:e.depositsTitle,body:e.depositsBody},null,8,["title","body"])])}const wt=K(bt,[["render",Tt]]),Dt=Q({name:"Management",props:{fund:{type:Object,default:()=>{}}},data(){return{parsedPlannedSettlement:""}},computed:{managementTitle(){var o,l;const e=((l=(o=this.fund)==null?void 0:o.allowedManagerAddresses)==null?void 0:l.length)??0;return e===1?`${e} Address`:`${e} Addresses`},managementBody(){var e,o;return(o=(e=this.fund)==null?void 0:e.allowedManagerAddresses)!=null&&o.length?this.fund.allowedManagerAddresses.join(`
`):"There are currently no addresses."}},async mounted(){var e,o;await Pe((e=this.fund)==null?void 0:e.chainId,(o=this.fund)==null?void 0:o.plannedSettlementPeriod).then(l=>{this.parsedPlannedSettlement=(l==null?void 0:l.toString())||""}).catch(l=>{console.error("Error parsing planned settlement",l)})}}),At={class:"main_grid"};function $t(e,o,l,d,a,t){const r=be;return n(),u("div",At,[v(r,{title:e.parsedPlannedSettlement,subtitle:"Planned Settlement Cycle"},null,8,["title"]),v(r,{title:e.fund.minLiquidAssetShare||"N/A",subtitle:"Min. Liquid Asset Share "},null,8,["title"])])}const Ft=K(Dt,[["render",$t]]),Ct=Q({name:"Fees",props:{fund:{type:Object,default:()=>{}}},methods:{formatPeriod(e){return e==0?"365":JSON.stringify(e)},formatFee(e){return e==null?"N/A":`${(Number(e)/100).toString()}%`},formatAddress(e){return!e||Ne(e)?"N/A":e}}}),St={class:"main_grid main_grid--full-width"};function xt(e,o,l,d,a,t){var f,c,_,B,D,I,w,p,C,S;const r=be;return n(),u("div",St,[v(r,{title:e.formatFee((f=e.fund)==null?void 0:f.managementFee),subtitle:"Management Fee",title2:e.formatAddress((c=e.fund)==null?void 0:c.managementFeeAddress),subtitle2:"Distributed to",title3:e.formatPeriod((_=e.fund)==null?void 0:_.managementPeriod),subtitle3:"Fee Period (Days)",class:"main_grid__item"},null,8,["title","title2","title3"]),v(r,{title:e.formatFee((B=e.fund)==null?void 0:B.performanceFee),subtitle:"Performance Fee",title2:e.formatAddress((D=e.fund)==null?void 0:D.performanceFeeAddress),subtitle2:"Distributed to","grow-column2":!0,title3:e.formatPeriod((I=e.fund)==null?void 0:I.performancePeriod),subtitle3:"Fee Period (Days)",class:"main_grid__item"},null,8,["title","title2","title3"]),v(r,{title:e.formatFee((w=e.fund)==null?void 0:w.depositFee),subtitle:"Deposit Fee",title2:e.formatAddress((p=e.fund)==null?void 0:p.depositFeeAddress),subtitle2:"Distributed to",class:"main_grid__item"},null,8,["title","title2"]),v(r,{title:e.formatFee((C=e.fund)==null?void 0:C.withdrawFee),subtitle:"Exit Fee",title2:e.formatAddress((S=e.fund)==null?void 0:S.withdrawFeeAddress),subtitle2:"Distributed to",class:"main_grid__item"},null,8,["title","title2"])])}const Vt=K(Ct,[["render",xt],["__scopeId","data-v-ba01aa8a"]]),Rt=Q({name:"Governance",props:{fund:{type:Object,default:()=>{}}},computed:{governanceTokenTotalSupplyFormatted(){return ie(this.fund.governanceTokenTotalSupply,this.fund.governanceToken.decimals)+" "+this.fund.governanceToken.symbol},quorumFormatted(){return`${this.fund.quorumPercentage} (${this.fund.quorumVotesFormatted} ${this.fund.governanceToken.symbol})`}}}),Ut={class:"accordion_content"},qt={class:"main_card"},Bt={class:"main_card"},Pt={class:"main_card"},Nt={class:"main_card"};function Et(e,o,l,d,a,t){const r=kt,f=wt,c=Ft,_=Vt;return n(),u("div",Ut,[i("div",qt,[o[0]||(o[0]=i("div",{class:"subtitle_steel_blue"}," Basics ",-1)),v(r,{fund:e.fund},null,8,["fund"])]),i("div",Bt,[o[1]||(o[1]=i("div",{class:"subtitle_steel_blue"}," Whitelist ",-1)),v(f,{fund:e.fund,class:"whitelist_card"},null,8,["fund"])]),i("div",Pt,[o[2]||(o[2]=i("div",{class:"subtitle_steel_blue"}," Management ",-1)),v(c,{fund:e.fund},null,8,["fund"])]),i("div",Nt,[o[3]||(o[3]=i("div",{class:"subtitle_steel_blue"}," Fees ",-1)),v(_,{fund:e.fund},null,8,["fund"])])])}const It=K(Rt,[["render",Et],["__scopeId","data-v-315de81a"]]),Wt={class:"overview"},Mt=Q({__name:"index",props:{fund:{type:Object,default:()=>({})}},setup(e){return(o,l)=>{const d=It,a=be;return n(),u("div",Wt,[v(a,{title:"Vault Settings",class:"data_row_card"},{body:A(()=>[v(d,{fund:e.fund},null,8,["fund"])]),_:1})])}}}),Lt=K(Mt,[["__scopeId","data-v-781db018"]]),Ot={name:"FundInfoDescription",props:{fund:{type:Object,default:()=>{}}},data(){return{maxDescriptionLength:300,showMore:!1}},computed:{buttonLinks(){return[{title:"DeBank - NAV",href:this.deBankUrl,showTooltip:!1},{title:"Safe - Custody",href:this.custodyUrl,showTooltip:!1},{isHidden:!this.fund.oivChatUrl,title:"Vault Chat",href:this.fund.oivChatUrl,showTooltip:!1}]},deBankUrl(){return`https://debank.com/profile/${this.fund.safeAddress}`},custodyUrl(){return`https://app.safe.global/balances?safe=${this.fund.chainShort}:${this.fund.safeAddress}`},isDescriptionToLong(){var e;return(e=this.fund)!=null&&e.description?this.fund.description.length>this.maxDescriptionLength:!1},fundDescriptionText(){var e,o,l,d;return(e=this.fund)!=null&&e.description?this.isDescriptionToLong&&!this.showMore?((l=(o=this.fund)==null?void 0:o.description)==null?void 0:l.slice(0,this.maxDescriptionLength))+"...":(d=this.fund)==null?void 0:d.description:""}}},jt={class:"fund_description"},zt={class:"fund_description__buttons"},Yt={class:"text-secondary"};function Ht(e,o,l,d,a,t){const r=rt,f=dt,c=ut;return n(),u("div",jt,[v(c,{title:"Information",class:"fund_description__header"},{"header-right":A(()=>[i("div",zt,[(n(!0),u(M,null,de(t.buttonLinks,_=>(n(),u(M,null,[_.isHidden?F("",!0):(n(),V(r,{key:_.title,title:_.title,href:_.href,"show-tooltip":_.showTooltip},null,8,["title","href","show-tooltip"]))],64))),256))])]),tools:A(()=>[i("p",Yt,[R(h(t.fundDescriptionText)+" ",1),t.isDescriptionToLong?(n(),V(f,{key:0,modelValue:a.showMore,"onUpdate:modelValue":o[0]||(o[0]=_=>a.showMore=_)},null,8,["modelValue"])):F("",!0)])]),_:1})])}const Gt=K(Ot,[["render",Ht],["__scopeId","data-v-0df68513"]]),Kt={name:"PositionTypesBar",props:{positionTypeCounts:{type:Array,default:()=>[]}},computed:{totalCountSum(){return this.positionTypeCounts.reduce((e,o)=>e+BigInt(o.count),0n)},calculatedPositionTypes(){return this.positionTypeCounts.filter(e=>BigInt(e.count)>0n).map(e=>{var d;const o=Number(e.count)/Number(this.totalCountSum),l=Math.max(o,.05);return{width:Ee(o,!1),style:{width:l*100+"%"},class:`bg_nav_${((d=e.type)==null?void 0:d.key)||""}`,...e}})}}},Zt={class:"position_types_bar"},Qt={key:1,class:"d-flex flex-grow-1 justify-end"},Jt={class:"position_types_bar__item bg_nav_liquid",style:{width:"100%"}};function Xt(e,o,l,d,a,t){var r;return n(),u("div",Zt,[t.totalCountSum>0&&((r=t.calculatedPositionTypes)!=null&&r.length)?(n(!0),u(M,{key:0},de(t.calculatedPositionTypes,(f,c)=>{var _;return n(),u("div",{key:c,class:le(["position_types_bar__item",f.class]),style:Ye(f.style)},[(_=f==null?void 0:f.type)!=null&&_.name?(n(),V(se,{key:0,activator:"parent",location:"bottom"},{default:A(()=>{var B;return[R(h((B=f==null?void 0:f.type)==null?void 0:B.name)+" of "+h(f.width),1)]}),_:2},1024)):F("",!0)],6)}),128)):(n(),u("div",Qt,[i("div",Jt,[v(se,{activator:"parent",location:"bottom"},{default:A(()=>o[0]||(o[0]=[R(" Liquid of 100% ")])),_:1})])]))])}const es=K(Kt,[["render",Xt],["__scopeId","data-v-6ded85e1"]]),ts={class:"fund_insights"},ss={class:"data_bar__item"},ns={class:"data_bar__title"},os={class:"data_bar__item"},as={class:"text-white"},ls={key:0,class:"nav_usd_value ms-2"},is={class:"data_bar__item"},rs={class:"data_bar__title"},ds={class:"data_bar__item"},us={class:"data_bar__item"},cs={class:"data_bar__title"},fs=Q({__name:"Insights",props:{fund:{type:Object,default:()=>{}}},setup(e){const o=ne(),l=we(),d=He(),a=k(()=>l.isActionState("fetchFundNAVDataAction",ve.Loading)),t=k(()=>l.isActionState("calculateFundPerformanceMetricsAction",ve.Loading)),r=k(()=>{var c,_;return l.isActionState(`fetchFundLatestSnapshot_${(c=f.fund)==null?void 0:c.chainId}_${(_=f.fund)==null?void 0:_.address}`,ve.Loading)}),f=e;return(c,_)=>{const B=ct,D=es,I=Ve;return n(),u("div",ts,[v(I,{class:"data_bar"},{default:A(()=>{var w,p,C;return[i("div",ss,[i("div",ns,[v(B,{"chain-short":(w=f.fund)==null?void 0:w.chainShort,class:"mr-2"},null,8,["chain-short"]),R(" "+h(s(lt)(e.fund.chainName)||"N/A"),1)]),_[0]||(_[0]=i("div",{class:"data_bar__subtitle"}," Chain ",-1))]),i("div",os,[i("div",{class:le(["data_bar__title",{"justify-center":s(a)}])},[s(r)?(n(),V(ee,{key:0,class:"d-flex",size:"18",width:"2",indeterminate:""})):e.fund.totalSimulatedNav!=null?(n(),u(M,{key:1},[e.fund.totalSimulatedNavCalculatedAt?(n(),V(se,{key:0,disabled:!s(d).isManageMode,location:"bottom"},{activator:A(({props:S})=>[i("div",pe({class:"d-flex flex-row"},S),[i("div",as,h(s(qe)(s(ie)(e.fund.totalSimulatedNav||e.fund.lastNAVUpdateTotalNAV,e.fund.baseToken.decimals,!1,!1))+" "+e.fund.baseToken.symbol),1),e.fund.totalSimulatedNavUSD?(n(),u("div",ls," ("+h(e.fund.totalSimulatedNavUSD?"$"+s(qe)(e.fund.totalSimulatedNavUSD):"N/A")+") ",1)):F("",!0)],16)]),default:A(()=>[_[1]||(_[1]=R(" Calculated on ")),i("strong",null,h(e.fund.totalSimulatedNavCalculatedAt),1)]),_:1},8,["disabled"])):F("",!0)],64)):(n(),u(M,{key:2},[s(a)?(n(),V(ee,{key:0,class:"d-flex",size:"18",width:"2",indeterminate:""})):F("",!0),R(" "+h(s(o).fundTotalNAVFormattedShort??"N/A"),1)],64))],2),_[2]||(_[2]=i("div",{class:"data_bar__subtitle"}," Current NAV ",-1))]),i("div",is,[i("div",rs,h(e.fund.inceptionDate),1),_[3]||(_[3]=i("div",{class:"data_bar__subtitle"}," Inception Date ",-1))]),i("div",ds,[i("div",{class:le(["data_bar__title",{"justify-center":s(t)}])},[s(t)?(n(),V(ee,{key:0,class:"d-flex",size:"18",width:"2",indeterminate:""})):(n(),u("div",{key:1,class:le(["data_bar__title",s(Ie)(((p=e.fund)==null?void 0:p.cumulativeReturnPercent)||0)])},h(s(Ee)(e.fund.cumulativeReturnPercent,!0)??"N/A"),3))],2),_[4]||(_[4]=i("div",{class:"data_bar__subtitle"}," Cumulative ",-1))]),i("div",us,[i("div",cs,[v(D,{"position-type-counts":((C=e.fund)==null?void 0:C.positionTypeCounts)??[]},null,8,["position-type-counts"])]),_[5]||(_[5]=i("div",{class:"data_bar__subtitle"}," Position Types ",-1))])]}),_:1})])}}}),ms=K(fs,[["__scopeId","data-v-df48b20b"]]),_s={name:"FundInfoMyDeposits",props:{fund:{type:Object,default:()=>{}}},setup(){const e=ne(),o=we();return{fundStore:e,actionStateStore:o}},computed:{fundBaseToken(){var e;return(e=this.fundStore.fund)==null?void 0:e.baseToken},fundToken(){var e;return(e=this.fundStore.fund)==null?void 0:e.fundToken},userFundTokenBalanceFormatted(){return this.fundToken?this.fundStore.getFormattedFundTokenValue(this.fundStore.fundUserData.fundTokenBalance):"N/A"},userFundAllowanceFormatted(){return this.fundBaseToken?this.fundStore.getFormattedBaseTokenValue(this.fundStore.fundUserData.fundAllowance):"N/A"},userCurrentValueFormatted(){return this.fundBaseToken?this.fundStore.getFormattedBaseTokenValue(this.fundStore.userCurrentValue):"N/A"},isLoadingUserBalances(){return this.actionStateStore.isActionState("fetchUserBalancesAction",ve.Loading)}},methods:{numberColorClass:Ie}},ps={class:"my_deposits"},vs={class:"data_bar__item"},hs={class:"data_bar__item"},gs={class:"data_bar__item"};function ks(e,o,l,d,a,t){const r=Ve;return n(),u("div",ps,[v(r,{title:"My Deposits"},{default:A(()=>[i("div",vs,[i("div",{class:le(["data_bar__title",{"justify-center":t.isLoadingUserBalances}])},[t.isLoadingUserBalances?(n(),V(ee,{key:0,class:"d-flex",size:"18",width:"2",indeterminate:""})):(n(),u(M,{key:1},[R(h(t.userFundTokenBalanceFormatted),1)],64))],2),o[0]||(o[0]=i("div",{class:"data_bar__subtitle"}," LP Tokens ",-1))]),i("div",hs,[i("div",{class:le(["data_bar__title",{"justify-center":t.isLoadingUserBalances}])},[t.isLoadingUserBalances?(n(),V(ee,{key:0,class:"d-flex",size:"18",width:"2",indeterminate:""})):(n(),u(M,{key:1},[R(h(t.userCurrentValueFormatted),1)],64))],2),o[1]||(o[1]=i("div",{class:"data_bar__subtitle"}," Current Value ",-1))]),i("div",gs,[i("div",{class:le(["data_bar__title",{"justify-center":t.isLoadingUserBalances}])},[t.isLoadingUserBalances?(n(),V(ee,{key:0,class:"d-flex",size:"18",width:"2",indeterminate:""})):(n(),u(M,{key:1},[R(h(t.userFundAllowanceFormatted),1)],64))],2),o[2]||(o[2]=i("div",{class:"data_bar__subtitle"}," Allowance ",-1))])]),_:1})])}const bs=K(_s,[["render",ks]]),ys={class:"fund_info_governance"},Ts={class:"data_bar__item"},ws={class:"data_bar__title"},Ds={class:"data_bar__item"},As={class:"data_bar__title"},$s={class:"data_bar__item"},Fs=Q({__name:"Governance",props:{fund:{type:Object,default:()=>{}}},setup(e){const o=ne(),l=P(!1),d=e,a=k(()=>{var r;return ie(o.fundUserData.governanceTokenBalance,(r=d.fund)==null?void 0:r.governanceToken.decimals,!1,!0)}),t=k(()=>{var r;return o.fundUserData.fundDelegateAddress.toLowerCase()===((r=o==null?void 0:o.activeAccountAddress)==null?void 0:r.toLowerCase())?"Myself":at(o.fundUserData.fundDelegateAddress)});return(r,f)=>{const c=Ve,_=Re;return n(),u("div",ys,[v(c,{title:"Governance"},{default:A(()=>[i("div",Ts,[i("div",ws,[s(Ne)(s(o).fundUserData.fundDelegateAddress)?(n(),u(M,{key:0},[R(" N/A ")],64)):(n(),u(M,{key:1},[v(se,{activator:"parent",location:"bottom"},{default:A(()=>[R(h(s(o).fundUserData.fundDelegateAddress),1)]),_:1}),R(" "+h(s(t)),1)],64))]),f[2]||(f[2]=i("div",{class:"data_bar__subtitle"}," Delegating To ",-1))]),i("div",Ds,[i("div",As,h(s(a))+" "+h(e.fund.governanceToken.symbol),1),f[3]||(f[3]=i("div",{class:"data_bar__subtitle"}," Voting Power ",-1))]),i("div",$s,[v(ue,{class:"button",variant:"outlined",onClick:f[0]||(f[0]=B=>l.value=!0)},{default:A(()=>f[4]||(f[4]=[R(" Delegate ")])),_:1})])]),_:1}),v(_,{modelValue:s(l),"onUpdate:modelValue":f[1]||(f[1]=B=>me(l)?l.value=B:null)},null,8,["modelValue"])])}}}),Cs=K(Fs,[["__scopeId","data-v-f128c0a9"]]),Ss={name:"Info",props:{fund:{type:Object,default:()=>{}}},setup(){const{isConnected:e}=ge($e());return{isConnected:e}}},xs={key:0,class:"fund_info"},Vs={key:0,class:"fund_info__user_data main_grid"};function Rs(e,o,l,d,a,t){var B;const r=Gt,f=ms,c=bs,_=Cs;return(B=l.fund)!=null&&B.address?(n(),u("div",xs,[v(r,{fund:l.fund},null,8,["fund"]),v(f,{fund:l.fund},null,8,["fund"]),d.isConnected?(n(),u("div",Vs,[v(c,{fund:l.fund},null,8,["fund"]),v(_,{fund:l.fund},null,8,["fund"])])):F("",!0)])):F("",!0)}const Us=K(Ss,[["render",Rs],["__scopeId","data-v-b0024938"]]);var te=(e=>(e.NAV="nav",e.SHARE_PRICE="share-price",e))(te||{});const Fe={nav:"var(--color-primary)","share-price":"var(--color-primary)"},xe={nav:{value:"NAV",key:"nav"},"share-price":{value:"Share Price",key:"share-price"}},qs={class:"price_type_selector"},Bs={class:"price_type_selector__price"},Ps={key:1},Ns={class:"price_type_selector__selected"},Es={key:0,class:"price_type_selector__options"},Is=["onClick"],Ws=Q({__name:"TypeSelector",props:{value:{},selected:{},typeOptions:{},isLoading:{type:Boolean}},emits:["update:selected"],setup(e,{emit:o}){const l=e,d=o,a=P(!1),t=k(()=>xe[l.selected].value),r=k(()=>Object.keys(l.typeOptions).length>1),f=_=>{d("update:selected",_.key),a.value=!1},c=()=>{r.value&&(a.value=!a.value)};return(_,B)=>{const D=ft;return n(),u("div",qs,[i("div",{class:le(["price_type_selector__select_button",{"price_type_selector__select_button--hover":s(r)}]),onClick:c},[i("div",null,[i("div",Bs,[_.isLoading?(n(),V(ee,{key:0,class:"d-flex",size:"20",width:"3",indeterminate:""})):(n(),u("span",Ps,h(_.value),1))]),i("div",Ns,h(s(t)),1)]),s(r)?(n(),V(D,{key:0,active:s(a)},null,8,["active"])):F("",!0)],2),s(a)?(n(),u("div",Es,[(n(!0),u(M,null,de(_.typeOptions,I=>(n(),u("div",{key:I.key,class:le(["price_type_selector__option",{"option-active":_.selected===I.key}]),onClick:w=>f(I)},h(I.value),11,Is))),128))])):F("",!0)])}}}),Ms=K(Ws,[["__scopeId","data-v-aaf021c0"]]);function Ls(e,o){return je(`fetchFundNavUpdates_${e}_${o}`,()=>Os(e,o))}async function Os(e,o){console.debug("[BACKEND] FETCH Fund NAV updates ",e,o);const l=Ge(),d=await fetch(`${l.public.BACKEND_URL}/nav/nav-updates/${o}?fundChainId=${e}`);if(!d.ok)return console.error(`[BACKEND] Failed to fetch NAV updates for fund ${e} ${o}:`,d.statusText),[];const a=await d.json();return console.debug("[BACEKDN] Fund ",e,o," NAV UPDATES",a),js(a)}const js=e=>e.map(o=>({...o,totalNAV:o.totalNAV!=null?BigInt(o.totalNAV):null,sharePrice:Number(o.sharePrice),totalDepositBalance:o.totalDepositBalance!=null?BigInt(o.totalDepositBalance):null,navParts:typeof o.navParts=="string"?JSON.parse(o.navParts,Ke):o.navParts||{}})),zs=(e,o=1)=>{const l=parseFloat(e);if(isNaN(l))return e;const d=["K","M","B","T"];let a=l,t="";for(let r=d.length-1;r>=0;r--){const f=Math.pow(1e3,r+1);if(l>=f){a=l/f,t=d[r];break}}return Ce(a.toFixed(o))+t},Ys={key:0,class:"chart"},Hs={class:"chart__toolbar"},Gs={class:"chart__chart_wrapper"},Ks={key:1,class:"meta"},Zs={key:1,class:"w-100 d-flex justify-center align-center h-100"},Qs=Q({__name:"index",props:{fund:{}},setup(e){const o=ne(),l=mt(),d=Be(),a=we(),t=e,r=P(te.NAV),f=P([]),c=P(!0),_=k(()=>{var y;return{[te.NAV]:o.fundTotalNAVFormattedShort,[te.SHARE_PRICE]:((y=f.value[f.value.length-1])==null?void 0:y.toString())||"0"}[r.value]}),B=k(()=>[{name:xe[r.value].value,data:w.value}]),D=k(()=>a.isActionState("fetchFundNAVDataAction",ve.Loading)),I=k(()=>{var g,y;return((y=(g=t.fund)==null?void 0:g.navUpdates)==null?void 0:y.map(U=>U.totalNAV||0n))||[]}),w=k(()=>{var y,U;return{[te.NAV]:((U=(y=t.fund)==null?void 0:y.navUpdates)==null?void 0:U.map(x=>{var W;return parseFloat(ke(x.totalNAV||0n,(W=t.fund)==null?void 0:W.baseToken.decimals))}))||[],[te.SHARE_PRICE]:f.value}[r.value]}),p=k(()=>{var y,U,x,W;return{[te.NAV]:((U=(y=t.fund)==null?void 0:y.navUpdates)==null?void 0:U.map(G=>G.date))||[],[te.SHARE_PRICE]:((W=(x=t.fund)==null?void 0:x.navUpdates)==null?void 0:W.map(G=>G.date))||[]}[r.value]}),C=k(()=>{var g;return{chart:{id:"nav-area-chart",type:"area",background:"var(--color-gray-light-transparent)",stacked:!1,zoom:{enabled:!1},toolbar:{show:!1}},dataLabels:{enabled:!1},context:{navUpdates:((g=t.fund)==null?void 0:g.navUpdates)||[]},markers:{size:0,colors:["transparent"],strokeColors:Fe[r.value],strokeWidth:2},grid:{show:!1,padding:{right:0}},fill:{type:"gradient",gradient:{shadeIntensity:1,inverseColors:!1,opacityFrom:.25,opacityTo:.1,type:"vertical",stops:[20,100]},colors:[Fe[r.value]]},stroke:{show:!0,curve:"straight",lineCap:"round",width:2,colors:[Fe[r.value]]},yaxis:{min:Math.min(...w.value)*.95,max:Math.max(...w.value)*1.05,forceNiceScale:!0,labels:{style:{colors:"var(--color-light-subtitle)"},offsetX:0,formatter:y=>zs(y,3)},axisBorder:{show:!1},axisTicks:{show:!1}},xaxis:{categories:p.value,tickAmount:4,axisBorder:{show:!1},axisTicks:{show:!1},crosshairs:{show:!1},tooltip:{enabled:!1},labels:{style:{colors:"var(--color-light-subtitle)"}}},tooltip:{theme:"dark",custom:({series:y,seriesIndex:U,dataPointIndex:x,w:W})=>{const G=I.value[x],X=f.value[x];return`
          <div class='custom_tooltip'>
            <div class='tooltip_row'>
              <div class='label'>Date:</div> ${W.globals.categoryLabels[x]}
            </div>
            <div class='tooltip_row'>
              <div class='label'>${r.value===te.NAV?"NAV":"Share Price"}:</div>
              ${r.value===te.NAV?S(G):X}
            </div>
          </div>
        `}}}}),S=g=>{var y,U;return ie(g,(y=t.fund)==null?void 0:y.baseToken.decimals)+" "+((U=t.fund)==null?void 0:U.baseToken.symbol)},J=async()=>{var U,x;c.value=!0;const g=await l.initializeBlockTimeContext(t.fund.chainId,!1),y=(g==null?void 0:g.averageBlockTime)||0;f.value=await Promise.all((x=(U=t.fund)==null?void 0:U.navUpdates)==null?void 0:x.map(async W=>{var oe;const G=fe(String(W.totalNAV||"0"),(oe=t.fund)==null?void 0:oe.baseToken.decimals),X=Number(await l.getBlockByTimestamp(t.fund.chainId,W.timestamp/1e3,y)||0);try{const ae=await d.callWithRetry(t.fund.chainId,()=>d.getCustomContract(t.fund.chainId,ze,t.fund.fundToken.address).methods.totalSupply().call({},X)),j=fe(String(ae||"0"),t.fund.fundToken.decimals),N=t.fund.baseToken.decimals,z=t.fund.fundToken.decimals,b=N-z,$=b<0?G*10n**BigInt(-b):G,E=b>0?j*10n**BigInt(b):j,q=10n**36n,Z=j>0n?$*q/E:0n;return parseFloat(ke(Z,36))}catch(ae){return console.error("Error getting share price",ae),0}})),c.value=!1},O=()=>{c.value=!0,Ls(t.fund.chainId,t.fund.address).then(g=>{console.warn("TTT fetchFundNavUpdatesAction ",t.fund.chainId,t.fund.address,g),f.value=g.map(y=>y.sharePrice),console.debug("TTT fetchFundNavUpdatesAction ",t.fund.chainId,t.fund.address,g),c.value=!1}).catch(g=>{console.error(`Failed fetchFundNavUpdatesAction for ${t.fund.address}`,g),c.value=!1,J()})};return Ae(()=>r.value,()=>{var g;r.value===te.SHARE_PRICE&&t.fund&&!((g=f.value)!=null&&g.length)&&O()},{immediate:!0}),(g,y)=>{const U=Ms,x=ye("apexchart"),W=Ze;return s(D)?F("",!0):(n(),u("div",Ys,[i("div",Hs,[i("div",null,[v(U,{selected:s(r),"onUpdate:selected":y[0]||(y[0]=G=>me(r)?r.value=G:null),value:s(_),"is-loading":s(c)&&s(r)===s(te).SHARE_PRICE,"type-options":s(xe)},null,8,["selected","value","is-loading","type-options"])])]),i("div",Gs,[s(c)&&s(r)===s(te).SHARE_PRICE?(n(),V(Se,{key:0,type:"ossein",height:"400px",width:"100%"})):(n(),u("div",Ks,[v(W,null,{default:A(()=>[s(w).length>0?(n(),V(x,{key:0,height:"400",width:"100%",options:s(C),series:s(B)},null,8,["options","series"])):(n(),u("div",Zs,y[1]||(y[1]=[i("h3",null," No NAV updates available yet. ",-1)])))]),_:1})]))])]))}}}),Js=K(Qs,[["__scopeId","data-v-6d1ee23f"]]),Xs={requestDeposit:["function requestDeposit(uint256 amount)"],deposit:["function deposit()"],depositAndDelegateBySig:["function depositAndDelegateBySig(address delegatee, uint256 nonce, uint256 expiry, uint8 v, bytes32 r, bytes32 s)"],revokeDepositWithrawal:["function revokeDepositWithrawal(bool isDeposit)"],requestWithdraw:["function requestWithdraw(uint256 amount)"],withdraw:["function withdraw()"]},en=e=>new Qe(Xs[e]),he=(e,o)=>en(e).encodeFunctionData(e,o??[]),tn={class:"pending_request card_box card_box--no-padding"},sn={class:"pending_request__header"},nn={class:"pending_request__pending_tokens"},on={class:"pending_request__icon_more"},an={class:"pending_request__header pending_request__header--bg-light"},ln={class:"pending_request__available_token"},rn=Q({__name:"PendingRequest",props:{fundTransactionRequest:{type:Object,default:()=>{}},token0:{type:Object,default:()=>{}},token1:{type:Object,default:()=>{}},exchangeRate:{type:ce,default:ce.fromValue(0)}},emits:["cancel-request-success"],setup(e,{emit:o}){const l=o,d=ne(),a=Te(),t=P(!1),r=()=>{t.value=!t.value},f=()=>{t.value=!1},c=e,_=k(()=>ie(c.fundTransactionRequest.amount,c.token0.decimals,!1)),B=k(()=>{if(!c.exchangeRate)return 0;console.log("exchangeRate:",c.exchangeRate);const p=ke(c.fundTransactionRequest.amount,c.token0.decimals),C=c.exchangeRate.mul(ce.fromString(p));return it(C.toString(),3)}),D=P(!1),I=async()=>{if(!d.activeAccountAddress){a.errorToast("Connect your wallet to cancel the deposit.");return}const p=c.fundTransactionRequest.type===De.Deposit;console.log(`Cancel ${c.fundTransactionRequest.type} Request`),D.value=!0;const C=he("revokeDepositWithrawal",[p]);try{await d.fundContract.send("fundFlowsCall",{},C).on("transactionHash",S=>{console.log("tx hash: "+S),a.addToast("The transaction has been submitted. Please wait for it to be confirmed.")}).on("receipt",S=>{console.log("receipt: ",S),S.status?(a.successToast(`Cancellation of a ${c.fundTransactionRequest.type} request was successful.`),l("cancel-request-success"),p?d.fundUserData.depositRequest=void 0:d.fundUserData.redemptionRequest=void 0):(d.fetchUserFundDepositRedemptionRequests(),a.errorToast("Your deposit request has failed. Please contact the Rethink Finance support.")),D.value=!1,f()}).on("error",S=>{console.error(S),a.errorToast("There has been an error. Please contact the Rethink Finance support.")})}catch(S){w(S)}},w=(p,C=!0)=>{D.value=!1,[4001,100].includes(p==null?void 0:p.code)?a.addToast("Transaction was rejected."):(a.errorToast("There has been an error. Please contact the Rethink Finance support."),console.error(p),C&&d.fetchUserFundDepositRedemptionRequests())};return(p,C)=>{var J,O,g;const S=ye("Icon");return n(),u("div",tn,[i("div",sn,[i("div",nn,[R(" Pending "+h((J=e.fundTransactionRequest)==null?void 0:J.type)+" Request ",1),i("div",null,h(s(_))+" "+h((O=e.token0)==null?void 0:O.symbol),1)]),i("div",on,[v(se,{activator:"parent",location:"left"},{activator:A(({props:y})=>[v(S,pe(y,{icon:"ic:twotone-cancel",width:"1.5rem",onClick:r}),null,16)]),default:A(()=>[R(" Cancel "+h(e.fundTransactionRequest.type)+" Request ",1)]),_:1})]),t.value?Je((n(),V(ue,{key:0,disabled:D.value,class:"pending_request__cancel_button bg-primary text-secondary",onClick:I},{prepend:A(()=>[D.value?(n(),V(ee,{key:0,class:"d-flex",size:"20",width:"3",indeterminate:""})):F("",!0)]),default:A(()=>[R(" Cancel "+h(e.fundTransactionRequest.type)+" Request ",1)]),_:1},8,["disabled"])),[[Xe,f]]):F("",!0)]),i("div",an,[C[0]||(C[0]=i("div",null," Claimable ",-1)),i("div",ln,h(s(B))+" "+h((g=e.token1)==null?void 0:g.symbol),1)])])}}}),We=K(rn,[["__scopeId","data-v-2ba79c3a"]]),dn={class:"deposit-flow mb-4"},un={class:"label"},cn={class:"buttons_group"},fn={key:0},mn={key:1},_n={key:0,class:"text-red mt-4 text-center"},pn=Q({__name:"ProcessDepositModal",props:{modelValue:{type:Boolean,default:!1},tokenValue:{type:String,default:""},tokenValueChanged:{type:Boolean,default:!1},visibleErrorMessages:{type:Array,default:()=>[]}},emits:["update:modelValue","deposit-success","update:tokenValue"],setup(e,{emit:o}){const l=e,d=o,a=Te(),t=ne(),r=k(()=>t.fund),{shouldUserRequestDeposit:f,shouldUserApproveAllowance:c,canUserProcessDeposit:_,shouldUserWaitSettlementOrCancelDeposit:B,userDepositRequest:D,userDepositRequestExists:I}=ge(t),w=P(!1),p=P(!1),C=P(!1),S=P(!1),J=P(!1),O=k(()=>{var b,$,E,q,Z,Y;return!((b=t.fundUserData)!=null&&b.fundAllowance)||!((E=($=t.fundUserData)==null?void 0:$.depositRequest)!=null&&E.amount)?!1:((q=t.fundUserData)==null?void 0:q.fundAllowance)>=((Y=(Z=t.fundUserData)==null?void 0:Z.depositRequest)==null?void 0:Y.amount)}),g=k(()=>!t.fundUserData.fundDelegateAddress||!t.activeAccountAddress?!1:t.fundUserData.fundDelegateAddress.toLowerCase()===t.activeAccountAddress.toLowerCase()),y=k(()=>{var $,E,q;const b=($=t.fund)==null?void 0:$.baseToken;return!((E=D==null?void 0:D.value)!=null&&E.amount)||!b?"N/A":ie((q=D==null?void 0:D.value)==null?void 0:q.amount,b.decimals,!1)}),U=k(()=>{var $,E;const b=($=t.fund)==null?void 0:$.baseToken;return I.value&&((E=D==null?void 0:D.value)!=null&&E.amount)&&b?`Deposit Flow: ${y.value} ${b.symbol}`:f.value&&l.tokenValue&&b?`Deposit Flow: ${l.tokenValue} ${b.symbol}`:"Deposit Flow"}),x=(b,$=!0)=>{w.value=!1,p.value=!1,[4001,100].includes(b==null?void 0:b.code)?a.addToast("Transaction was rejected."):(a.errorToast("There has been an error. Please contact the Rethink Finance support."),console.error(b),$&&t.fetchUserFundData(t.selectedFundChain,t.selectedFundAddress))},W=()=>{d("update:tokenValue",y.value)},G=async()=>{var E;if(!t.activeAccountAddress){a.errorToast("Connect your wallet to request deposit.");return}if(!r.value){a.errorToast("Fund data is missing.");return}console.log("REQUEST DEPOSIT"),w.value=!0;const b=fe(l.tokenValue||"0",(E=r.value)==null?void 0:E.baseToken.decimals);console.log("Request deposit tokensWei: ",b,"from : ",t.activeAccountAddress);const $=he("requestDeposit",[b]);try{await t.fundContract.send("fundFlowsCall",{},$).on("transactionHash",q=>{console.log("tx hash: ",q),a.addToast("The transaction has been submitted. Please wait for it to be confirmed.")}).on("receipt",q=>{console.log("receipt :",q),q.status?(a.successToast("Your deposit request was successful."),t.fundUserData.depositRequest={amount:b,timestamp:Date.now(),type:De.Deposit},d("deposit-success")):(a.errorToast("Your deposit request has failed. Please contact the Rethink Finance support."),t.fetchUserFundData(t.selectedFundChain,t.selectedFundAddress)),w.value=!1}).on("error",q=>{x(q,!1)})}catch(q){x(q)}},X=async()=>{var E,q,Z;if(!t.activeAccountAddress){a.errorToast("Connect your wallet to approve allowance.");return}if(!r.value){a.errorToast("Fund data is missing.");return}console.log("APPROVE ALLOWANCE"),p.value=!0,W();let b;(E=D==null?void 0:D.value)!=null&&E.amount?b=D.value.amount:b=fe(l.tokenValue||"0",(q=r.value)==null?void 0:q.baseToken.decimals),console.log("Approve allowance tokensWei: ",b,"from : ",t.activeAccountAddress);const $=b;try{await t.fundBaseTokenContract.send("approve",{},(Z=r.value)==null?void 0:Z.address,b).on("transactionHash",Y=>{console.log("tx hash: "+Y),a.addToast("The transaction has been submitted. Please wait for it to be confirmed.")}).on("receipt",Y=>{console.log("receipt :",Y),Y.status?(a.successToast("The approval was successful. You can make the deposit now."),t.fundUserData.fundAllowance=$):a.errorToast("The transaction has failed. Please contact the Rethink Finance support."),p.value=!1}).on("error",Y=>{x(Y,!1)})}catch(Y){x(Y)}},oe=k(()=>l.visibleErrorMessages.length>0||w.value||p.value||!t.isUserWalletWhitelisted),ae=P([{name:"Request Deposit",onClick:G,isVisible:f,disabled:oe,loading:w,tooltipText:k(()=>I.value?"Deposit request already exists. To change it, you first have to cancel the existing one.":t.isUserWalletWhitelisted?"":"Your wallet address is not whitelisted to allow deposits into this vault.")},{name:"Approve Amount",onClick:X,loading:p,isVisible:c,tooltipText:void 0}]),j=k(()=>[{label:"1. Request Deposit",done:I.value,loading:w.value,isDisabled:!1},{label:"2. Approve Amount",done:O.value,loading:p.value,isDisabled:!1},{label:"3. Delegate to Myself",done:g.value&&O.value,loading:C.value},{label:"4. Process Deposit",done:!1,isDisabled:B.value&&g.value,tooltip:"Wait for the next NAV update to process the deposit."}]),N=async()=>{var $,E;if(!t.activeAccountAddress){a.errorToast("Connect your wallet to deposit tokens to the vault.");return}if(!t.fund){a.errorToast("Vault data is missing.");return}if(!(($=D==null?void 0:D.value)!=null&&$.amount)){a.errorToast("Deposit request data is missing.");return}console.log("DEPOSIT tokensWei: ",(E=D==null?void 0:D.value)==null?void 0:E.amount,"from : ",t.activeAccountAddress),S.value=!0;const b=he("deposit");try{await t.fundContract.send("fundFlowsCall",{},b).on("transactionHash",q=>{console.log("tx hash: "+q),a.addToast("The transaction has been submitted. Please wait for it to be confirmed.")}).on("receipt",q=>{console.log("receipt: ",q),t.fetchUserFundData(t.selectedFundChain,t.selectedFundAddress),q.status?(a.successToast("Your deposit was successful."),d("update:modelValue",!1),d("deposit-success")):a.errorToast("The transaction has failed. Please contact the Rethink Finance support."),S.value=!1}).on("error",q=>{S.value=!1,console.error(q),a.errorToast("There has been an error. Please contact the Rethink Finance support.")})}catch(q){S.value=!1,x(q)}},z=async()=>{var b,$;try{C.value=!0;const E=t.activeAccountAddress,q=(b=t.fund)==null?void 0:b.governanceToken.address,Z=($=t.fund)==null?void 0:$.address;if(Z===Ue){a.errorToast("The vault address is not available. Please contact the Rethink Finance support.");return}let Y=t.fundContract;q!==Z&&q!==Ue&&(Y=t.fundGovernanceTokenContract),await Y.send("delegate",{},E).on("transactionHash",function(m){console.log("tx hash: "+m),a.addToast("The transaction has been submitted. Please wait for it to be confirmed.")}).on("receipt",function(m){console.log(m),m.status?(a.successToast("Delegation of Governance Tokens Succeeded"),E&&(t.fundUserData.fundDelegateAddress=E)):a.errorToast("The delegateTo tx has failed. Please contact the Rethink Finance support."),C.value=!1}).on("error",function(m){console.error(m),C.value=!1,a.errorToast("There has been an error. Please contact the Rethink Finance support.")})}catch(E){console.error("Error delegating to external gov token: ",E),C.value=!1,a.errorToast("There has been an error. Please contact the Rethink Finance support.")}};return(b,$)=>{const E=ye("Icon"),q=Re,Z=We,Y=pt;return n(),V(Y,{"model-value":e.modelValue,title:s(U),"onUpdate:modelValue":$[2]||($[2]=m=>b.$emit("update:modelValue",m))},{default:A(()=>[i("div",dn,[(n(!0),u(M,null,de(s(j),(m,T)=>(n(),u("div",{key:T},[v(se,{disabled:!m.isDisabled,activator:"parent",location:"top"},{default:A(()=>[R(h(m.tooltip),1)]),activator:A(({props:H})=>[i("div",pe({ref_for:!0},H),[(n(),u("div",{key:T,class:le(["step",{is_disabled:m.isDisabled}])},[i("span",un,h(m.label),1),m.done&&!m.isDisabled?(n(),V(E,{key:0,icon:"material-symbols:done",class:"text-success me-2",height:"1.2rem",width:"1.2rem"})):F("",!0),m.loading?(n(),V(ee,{key:1,class:"d-flex ms-2",size:"20",width:"3",indeterminate:""})):F("",!0)],2))],16)]),_:2},1032,["disabled"])]))),128))]),i("div",cn,[!s(g)&&s(O)?(n(),u(M,{key:0},[v(ue,{class:"button",variant:"outlined",onClick:z},{prepend:A(()=>[s(C)?(n(),V(ee,{key:0,class:"d-flex",size:"20",width:"3",indeterminate:""})):F("",!0)]),default:A(()=>[$[3]||($[3]=R(" Delegate to Myself "))]),_:1}),v(q,{modelValue:s(J),"onUpdate:modelValue":$[0]||($[0]=m=>me(J)?J.value=m:null)},null,8,["modelValue"])],64)):s(_)||s(B)?(n(),u(M,{key:1},[s(B)?(n(),u("h3",fn," Wait for settlement or cancel the deposit request. ")):s(_)?(n(),u("h3",mn," You can now process or cancel the deposit request. ")):F("",!0),v(ue,{class:"button",variant:"outlined",disabled:s(B),onClick:N},{prepend:A(()=>[s(S)?(n(),V(ee,{key:0,class:"d-flex",size:"20",width:"3",indeterminate:""})):F("",!0)]),default:A(()=>[$[4]||($[4]=R(" Process Deposit "))]),_:1},8,["disabled"]),s(I)&&s(r)?(n(),V(Z,{key:2,"fund-transaction-request":s(D),"exchange-rate":s(t).baseToFundTokenExchangeRate,token0:s(r).baseToken,token1:s(r).fundToken,style:{width:"100%"},onCancelRequestSuccess:$[1]||($[1]=m=>b.$emit("update:modelValue",!1))},null,8,["fund-transaction-request","exchange-rate","token0","token1"])):F("",!0)],64)):F("",!0),(n(!0),u(M,null,de(s(ae),m=>(n(),u(M,null,[m.isVisible?(n(),V(se,{key:m.name,disabled:!m.tooltipText,bottom:""},{default:A(()=>[R(h(m.tooltipText),1)]),activator:A(({props:T})=>[i("span",pe({ref_for:!0},T),[v(ue,{class:"button",disabled:m.disabled,variant:"outlined",onClick:m.onClick},{prepend:A(()=>[m.loading?(n(),V(ee,{key:0,class:"d-flex",size:"20",width:"3",indeterminate:""})):F("",!0)]),default:A(()=>[R(" "+h(m.name),1)]),_:2},1032,["disabled","onClick"])],16)]),_:2},1032,["disabled"])):F("",!0)],64))),256))]),e.visibleErrorMessages&&e.tokenValueChanged?(n(),u("div",_n,[(n(!0),u(M,null,de(e.visibleErrorMessages,(m,T)=>(n(),u("div",{key:T},h(m==null?void 0:m.message),1))),128))])):F("",!0)]),_:1},8,["model-value","title"])}}}),Me=K(pn,[["__scopeId","data-v-0de1b3d7"]]),vn={class:"fund_settlement"},hn={class:"card_header"},gn={key:0,class:"fund_settlement__buttons"},kn={key:1},bn={key:0,class:"fund_settlement__no_pending_requests"},yn={key:1},Tn={key:2,class:"fund_settlement__pending_requests"},wn={key:3,class:"fund_settlement__no_pending_requests"},Dn={class:"text-primary"},An=Q({__name:"index",props:{fund:{type:Object,default:()=>{}}},emits:["deposit-success"],setup(e,{emit:o}){Be();const l=Te(),d=we(),a=ne(),t=$e(),{fundUserData:r,userDepositRequest:f,userRedemptionRequest:c,baseToFundTokenExchangeRate:_,fundToBaseTokenExchangeRate:B,shouldUserWaitSettlementOrCancelDeposit:D,shouldUserWaitSettlementOrCancelRedemption:I,userDepositRequestExists:w,userRedemptionRequestExists:p}=ge(a),C=k(()=>d.isActionState("fetchUserFundDepositRedemptionRequests",ve.Loading)),S=e,J=k(()=>W.value?!0:!(!G.value||!X.value)),O=P(!1),g=()=>{w.value&&(O.value=!0),p.value&&oe()},y=P(!1),U=P(!1),x=P(""),W=k(()=>y.value||U.value),G=k(()=>w.value?D.value?"Wait for settlement or cancel the deposit request.":a.isUserWalletWhitelisted?"":"Your wallet address is not whitelisted to allow deposits into this vault.":"There is no deposit request."),X=k(()=>{var q,Z,Y,m;const j=((q=c==null?void 0:c.value)==null?void 0:q.amount)||0n;if(!p.value)return"There is no redemption request.";if(r.value.fundTokenBalance<j)return"Not enough vault tokens to process the redemptions request.";if(I.value)return"Wait for settlement or cancel the redemption request.";const N=((Z=a.fund)==null?void 0:Z.fundContractBaseTokenBalance)||0n,z=ce.fromString(a.fundToBaseTokenExchangeRate.toString()),b=ce.fromString(ke(j,(Y=a.fund)==null?void 0:Y.fundToken.decimals)),$=z.mul(b);return ce.fromString(ke(N,(m=a.fund)==null?void 0:m.baseToken.decimals)).lt($)?"Not enough liquidity in the vault contract.":a.isUserWalletWhitelisted?"":"Your wallet address is not whitelisted to allow deposits into this vault."}),oe=async()=>{var N,z;if(!a.activeAccountAddress){l.errorToast("Connect your wallet to redeem tokens from the vault.");return}if(!a.fund){l.errorToast("vault data is missing.");return}if(!((N=c==null?void 0:c.value)!=null&&N.amount)){l.errorToast("Redemption request data is missing.");return}console.log("[REDEEM]"),U.value=!0,console.log("[REDEEM] tokensWei: ",(z=c==null?void 0:c.value)==null?void 0:z.amount,"from : ",a.activeAccountAddress);const j=he("withdraw");try{await a.fundContract.send("fundFlowsCall",{},j).on("transactionHash",b=>{console.log("tx hash: "+b),l.addToast("The transaction has been submitted. Please wait for it to be confirmed.")}).on("receipt",b=>{console.log("receipt: ",b),a.fetchUserFundData(a.selectedFundChain,a.selectedFundAddress),b.status?l.successToast("Your redemption was successful. It may take 10 seconds or more for values to update."):l.errorToast("The transaction has failed. Please contact the Rethink Finance support."),U.value=!1}).on("error",b=>{ae(b)})}catch(b){ae(b)}},ae=j=>{U.value=!1,[4001,100].includes(j==null?void 0:j.code)?l.addToast("Transaction was rejected."):(l.errorToast("There has been an error. Please contact the Rethink Finance support."),console.error(j))};return et(async()=>{var j,N;await Pe((j=S.fund)==null?void 0:j.chainId,(N=S.fund)==null?void 0:N.plannedSettlementPeriod).then(z=>{x.value=z}).catch(z=>{console.error("Error parsing planned settlement",z)})}),(j,N)=>{const z=We,b=_t;return n(),u("div",vn,[i("div",hn,[N[3]||(N[3]=i("div",{class:"card_header__title subtitle_white"}," Pending Requests ",-1)),s(w)||s(p)?(n(),u("div",gn,[v(se,{disabled:!(s(w)&&s(G)||s(p)&&s(X)),activator:"parent",location:"bottom"},{activator:A($=>[v(ue,pe($,{disabled:s(J),onClick:g}),{prepend:A(()=>[s(W)?(n(),V(ee,{key:0,class:"d-flex",size:"20",width:"3",indeterminate:""})):F("",!0)]),default:A(()=>[N[2]||(N[2]=R(" Process Request "))]),_:2},1040,["disabled"])]),default:A(()=>[s(w)?(n(),u(M,{key:0},[R(h(s(G)),1)],64)):F("",!0),s(w)&&s(p)?(n(),u("br",kn)):F("",!0),s(p)?(n(),u(M,{key:2},[R(h(s(X)),1)],64)):F("",!0)]),_:1},8,["disabled"])])):F("",!0)]),v(Me,{modelValue:s(O),"onUpdate:modelValue":N[0]||(N[0]=$=>me(O)?O.value=$:null),"token-value":"","token-value-changed":!1,"visible-error-messages":[],onDepositSuccess:N[1]||(N[1]=$=>j.$emit("deposit-success"))},null,8,["modelValue"]),s(t).isConnected?s(C)?(n(),u("div",yn,[v(Se,{type:"list-item-two-line"}),v(Se,{type:"list-item-two-line"})])):s(w)||s(p)?(n(),u("div",Tn,[s(w)?(n(),V(z,{key:0,"fund-transaction-request":s(f),"exchange-rate":s(_),token0:e.fund.baseToken,token1:e.fund.fundToken},null,8,["fund-transaction-request","exchange-rate","token0","token1"])):F("",!0),s(p)?(n(),V(z,{key:1,"fund-transaction-request":s(c),"exchange-rate":s(B),token1:e.fund.baseToken,token0:e.fund.fundToken},null,8,["fund-transaction-request","exchange-rate","token1","token0"])):F("",!0)])):(n(),u("div",wn," Currently there are no deposit or redemption requests. ")):(n(),u("div",bn," Connect your wallet to view deposit or redemption requests. ")),v(b,null,{default:A(()=>[N[4]||(N[4]=R(" The deposit and redeem requests are settled within the planned Settlement Cycle of ")),i("span",Dn,h(s(x)),1),N[5]||(N[5]=R(". You can learn more about how settlements work ")),N[6]||(N[6]=i("a",{class:"text-primary",href:"https://docs.rethink.finance/rethink.finance",target:"_blank"},"here",-1)),N[7]||(N[7]=R(". "))]),_:1})])}}}),$n=K(An,[["__scopeId","data-v-b5e1138b"]]),Fn=(e,o,l)=>e?`1 ${o} = ${e.toString()} ${l}`:"--",Cn={class:"request_deposit"},Sn={class:"request_deposit__token"},xn={class:"request_deposit__token_header"},Vn={class:"request_deposit__token_data"},Rn={class:"request_deposit__token_col"},Un={class:"request_deposit__token_col pa-0 request_deposit__token_col--dark text-end"},qn={class:"request_deposit__balance request_deposit__balance--row"},Bn={class:"request_deposit__token"},Pn={class:"request_deposit__token_header"},Nn={class:"request_deposit__token_data"},En={class:"request_deposit__token_col"},In={class:"request_deposit__token_col text-end"},Wn={class:"request_deposit__balance"},Mn={key:0},Ln={key:1},On={class:"buttons_container"},jn=Q({__name:"BaseForm",props:{modelValue:{type:String,default:""},token0:{type:Object,default:()=>{}},token1:{type:Object,default:()=>{}},token0UserBalance:{type:BigInt,default:BigInt("0")},token1UserBalance:{type:BigInt,default:BigInt("0")},exchangeRate:{type:ce,default:ce.fromValue(0)},rules:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:o}){const l=e,d=ne(),a=o,t=k({get:()=>(l==null?void 0:l.modelValue)??"",set:w=>{a("update:modelValue",w)}}),r=w=>{t.value=w},f=[w=>{let p;try{p=fe(w||"0",l.token0.decimals)}catch{return`Make sure the value has max ${l.token0.decimals} decimals.`}return p<=0?"Value must be positive.":!0},...l.rules],c=k(()=>ie(l.token0UserBalance,l.token0.decimals,!1)),_=k(()=>ie(l.token1UserBalance,l.token1.decimals,!1)),B=k(()=>Fn(l.exchangeRate,l.token0.symbol,l.token1.symbol)),D=k(()=>{if(!t.value)return"0";if(!l.exchangeRate||!t.value||!l.token0.decimals)return"N/A";try{const w=l.exchangeRate.mul(ce.fromString(t.value.toString()));return Ce(w.toString())}catch(w){return console.error("error calculatedToken1Value",w),"0"}}),I=k(()=>{var C,S;if(!((C=l==null?void 0:l.token0)!=null&&C.decimals)||!((S=l==null?void 0:l.token1)!=null&&S.decimals))return"--";const p=10**-Number(l.token1.decimals-l.token0.decimals);return Ce(p.toFixed(18))});return(w,p)=>{var J,O;const C=ye("Icon"),S=ht;return n(),u("div",Cn,[i("div",Sn,[i("div",xn,[p[2]||(p[2]=R(" Token ")),i("span",null,[v(C,{icon:"octicon:question-16",width:"1rem"}),e.token0?(n(),V(se,{key:0,activator:"parent",location:"right"},{default:A(()=>[R(h(e.token0.symbol)+" ("+h(e.token0.address)+"). ",1)]),_:1})):F("",!0)])]),i("div",Vn,[i("div",Rn,h(e.token0.symbol),1),i("div",Un,[v(S,{modelValue:s(t),"onUpdate:modelValue":p[0]||(p[0]=g=>me(t)?t.value=g:null),rules:f,class:"request_deposit__input_amount"},null,8,["modelValue"])])]),i("div",qn,[p[3]||(p[3]=R(" Balance: ")),i("strong",{class:"set_token_value_button mx-1",onClick:p[1]||(p[1]=g=>r(s(c)))},h(s(c))+" "+h(e.token0.symbol),1)])]),i("div",Bn,[i("div",Pn,[p[4]||(p[4]=R(" Token ")),i("span",null,[v(C,{icon:"octicon:question-16",width:"1rem"}),e.token1?(n(),V(se,{key:0,activator:"parent",location:"right"},{default:A(()=>[R(h(e.token1.symbol)+" ("+h(e.token1.address)+"). ",1)]),_:1})):F("",!0)])]),i("div",Nn,[i("div",En,h(e.token1.symbol),1),i("div",In," â‰ˆ "+h(s(D)),1)]),i("div",Wn,[i("div",null,[p[5]||(p[5]=R(" Balance: ")),i("strong",null,h(s(_))+" "+h(e.token1.symbol),1)]),s(d).fundLastNAVUpdate?(n(),u("div",Mn,[p[6]||(p[6]=R(" Based on Last NAV Update: ")),i("div",null,[i("strong",null,h(s(B)),1)])])):(n(),u("div",Ln," There was no NAV update yet: 1 "+h((J=e.token0)==null?void 0:J.symbol)+" = "+h(s(I))+" "+h((O=e.token1)==null?void 0:O.symbol),1))])]),i("div",On,[tt(w.$slots,"buttons",{},void 0,!0)])])}}}),Le=K(jn,[["__scopeId","data-v-98e749dc"]]),zn={style:{width:"100%"}},Yn={class:"label"},Hn={key:2,style:{width:"100%"}},Gn={class:"buttons_group"},Kn={key:0,class:"text-red mt-4 text-center"},Zn=Q({__name:"Deposit",emits:["deposit-success"],setup(e,{emit:o}){const l=o,d=Te(),a=$e(),t=ne(),r=P(""),f=P(!1),c=k(()=>t.fund),{shouldUserRequestDeposit:_,shouldUserApproveAllowance:B,canUserProcessDeposit:D,shouldUserWaitSettlementOrCancelDeposit:I,userDepositRequest:w,userDepositRequestExists:p}=ge(t),C=P(!1),S=P(!1),J=P(!1);P(!1);const O=P(!1);P(!1),Ae(()=>r.value,()=>{f.value=!0});const g=[m=>{var H,re;if(!c.value)return{message:"Fund data is missing.",display:!0};let T;try{T=fe(m,(H=c.value)==null?void 0:H.baseToken.decimals)}catch{return{message:`Make sure the value has max ${(re=c.value)==null?void 0:re.baseToken.decimals} decimals.`,display:!1}}if(T<=0)return{message:"Value must be positive.",display:!1};if(console.log("[DEPOSIT] check user base token balance wei: ",T,t.fundUserData.baseTokenBalance),!p.value&&t.fundUserData.baseTokenBalance<T){const L=ie(t.fundUserData.baseTokenBalance,c.value.baseToken.decimals);return{message:`Your ${c.value.baseToken.symbol} balance is too low: ${L}.`,display:!0}}return!0}],y=k(()=>{var T,H,re;const m=(T=t.fund)==null?void 0:T.baseToken;return!((H=w==null?void 0:w.value)!=null&&H.amount)||!m?"N/A":ie((re=w==null?void 0:w.value)==null?void 0:re.amount,m.decimals,!1)}),U=k(()=>C.value||S.value),x=k(()=>W.value.length>0||U.value||!t.isUserWalletWhitelisted),W=k(()=>g.map(m=>m(r.value||"0")).filter(m=>m!==!0)),G=k(()=>W.value.filter(m=>m.display)),X=k(()=>{var m,T;return(m=c.value)!=null&&m.baseToken?fe(r.value||"0",(T=c.value)==null?void 0:T.baseToken.decimals):0n}),oe=(m,T=!0)=>{C.value=!1,S.value=!1,[4001,100].includes(m==null?void 0:m.code)?d.addToast("Transaction was rejected."):(d.errorToast("There has been an error. Please contact the Rethink Finance support."),console.error(m),T&&t.fetchUserFundData(t.selectedFundChain,t.selectedFundAddress))},ae=async()=>{if(!t.activeAccountAddress){d.errorToast("Connect your wallet to request deposit.");return}if(!c.value){d.errorToast("Fund data is missing.");return}console.log("REQUEST DEPOSIT"),C.value=!0,console.log("Request deposit tokensWei: ",X.value,"from : ",t.activeAccountAddress);const m=he("requestDeposit",[X.value]);console.log("isConnectedWalletUsingLedger:",a.isConnectedWalletUsingLedger),console.log("contract:",t.fundContract),console.warn("connectedWallet",a==null?void 0:a.connectedWallet);try{await t.fundContract.send("fundFlowsCall",{},m).on("transactionHash",T=>{console.log("tx hash: ",T),d.addToast("The transaction has been submitted. Please wait for it to be confirmed.")}).on("receipt",T=>{console.log("receipt :",T),T.status?(d.successToast("Your deposit request was successful."),t.fundUserData.depositRequest={amount:X.value,timestamp:Date.now(),type:De.Deposit},l("deposit-success")):(d.errorToast("Your deposit request has failed. Please contact the Rethink Finance support."),t.fetchUserFundData(t.selectedFundChain,t.selectedFundAddress)),C.value=!1}).on("error",T=>{oe(T,!1)})}catch(T){oe(T)}},j=()=>{r.value=y.value},N=async()=>{var T;if(!t.activeAccountAddress){d.errorToast("Connect your wallet to approve allowance.");return}if(!c.value){d.errorToast("Fund data is missing.");return}console.log("APPROVE ALLOWANCE"),S.value=!0,j(),console.log("Approve allowance tokensWei: ",X.value,"from : ",t.activeAccountAddress);const m=X.value;try{await t.fundBaseTokenContract.send("approve",{},(T=c.value)==null?void 0:T.address,X.value).on("transactionHash",H=>{console.log("tx hash: "+H),d.addToast("The transaction has been submitted. Please wait for it to be confirmed.")}).on("receipt",H=>{console.log("receipt :",H),H.status?(d.successToast("The approval was successful. You can make the deposit now."),t.fundUserData.fundAllowance=m):d.errorToast("The transaction has failed. Please contact the Rethink Finance support."),S.value=!1}).on("error",H=>{oe(H,!1)})}catch(H){oe(H)}},z=k(()=>{var m;return console.log("fundStore.fundUserDataStore.fundUserDataStore.fundUserData: ",t.fundUserData),!!((m=t.fundUserData.depositRequest)!=null&&m.timestamp)}),b=k(()=>{var m,T,H,re,L,_e;return!((m=t.fundUserData)!=null&&m.fundAllowance)||!((H=(T=t.fundUserData)==null?void 0:T.depositRequest)!=null&&H.amount)?!1:((re=t.fundUserData)==null?void 0:re.fundAllowance)>=((_e=(L=t.fundUserData)==null?void 0:L.depositRequest)==null?void 0:_e.amount)&&z.value}),$=k(()=>!t.fundUserData.fundDelegateAddress||!t.activeAccountAddress?!1:t.fundUserData.fundDelegateAddress.toLowerCase()===t.activeAccountAddress.toLowerCase()),E=k(()=>!1);P([{name:"Request Deposit",onClick:ae,isVisible:_,disabled:x,loading:C,tooltipText:k(()=>p.value?"Deposit request already exists. To change it, you first have to cancel the existing one.":t.isUserWalletWhitelisted?"":"Your wallet address is not whitelisted to allow deposits into this vault.")},{name:"Approve Amount",onClick:N,loading:S,isVisible:B,tooltipText:void 0}]);const q=k(()=>[{label:"1. Request Deposit",done:z.value,loading:C.value,isDisabled:!1},{label:"2. Approve Amount",done:b.value,loading:S.value,isDisabled:!1},{label:"3. Delegate to Myself",done:$.value&&b.value,loading:J.value},{label:"4. Process Deposit",done:E.value,isDisabled:I.value&&$.value,tooltip:"Wait for the next NAV update to process the deposit."}]),Z=()=>{z.value||ae(),O.value=!0},Y=k(()=>!z.value&&W.value.length>0||!t.isUserWalletWhitelisted);return(m,T)=>{const H=Le,re=ye("Icon");return n(),u("div",zn,[s(z)?(n(),u("div",{key:1,class:"deposit-flow",onClick:Z},[T[5]||(T[5]=i("h3",{class:"title"}," Deposit in progress: ",-1)),(n(!0),u(M,null,de(s(q),(L,_e)=>(n(),u("div",{key:_e},[v(se,{disabled:!L.isDisabled,activator:"parent",location:"top"},{default:A(()=>[R(h(L.tooltip),1)]),activator:A(({props:Oe})=>[i("div",pe({ref_for:!0},Oe),[(n(),u("div",{key:_e,class:le(["step",{is_disabled:L.isDisabled}])},[i("span",Yn,h(L.label),1),L.done&&!L.isDisabled?(n(),V(re,{key:0,icon:"material-symbols:done",class:"text-success me-2",height:"1.2rem",width:"1.2rem"})):F("",!0),L.loading?(n(),V(ee,{key:1,class:"d-flex ms-2",size:"20",width:"3",indeterminate:""})):F("",!0)],2))],16)]),_:2},1032,["disabled"])]))),128))])):(n(),u(M,{key:0},[s(c)?(n(),V(H,{key:0,modelValue:s(r),"onUpdate:modelValue":T[0]||(T[0]=L=>me(r)?r.value=L:null),token0:s(c).baseToken,token1:s(c).fundToken,"token0-user-balance":s(t).fundUserData.baseTokenBalance,"token1-user-balance":s(t).fundUserData.fundTokenBalance,"exchange-rate":s(t).baseToFundTokenExchangeRate},null,8,["modelValue","token0","token1","token0-user-balance","token1-user-balance","exchange-rate"])):F("",!0)],64)),T[8]||(T[8]=i("div",{class:"divider"},null,-1)),s(a).isConnected?(n(),u("div",Hn,[i("div",Gn,[v(se,{disabled:s(t).isUserWalletWhitelisted,location:"bottom"},{default:A(()=>T[6]||(T[6]=[R(" Your wallet address is not whitelisted to allow deposits into this vault. ")])),activator:A(({props:L})=>[i("span",st(nt(L)),[v(ue,{class:"button_deposit button",variant:"outlined",disabled:s(Y),onClick:Z},{default:A(()=>[R(h(s(z)?"Continue Deposit":"Deposit"),1)]),_:1},8,["disabled"])],16)]),_:1},8,["disabled"])]),s(G)&&s(f)?(n(),u("div",Kn,[(n(!0),u(M,null,de(s(G),(L,_e)=>(n(),u("div",{key:_e},h(L.message),1))),128))])):F("",!0),v(Me,{modelValue:s(O),"onUpdate:modelValue":T[1]||(T[1]=L=>me(O)?O.value=L:null),"token-value":s(r),"token-value-changed":s(f),"visible-error-messages":s(G),"onUpdate:tokenValue":T[2]||(T[2]=L=>r.value=L),onDepositSuccess:T[3]||(T[3]=L=>m.$emit("deposit-success"))},null,8,["modelValue","token-value","token-value-changed","visible-error-messages"])])):(n(),V(ue,{key:3,class:"bg-primary text-secondary button_connect_wallet",onClick:T[4]||(T[4]=L=>s(a).connectWallet())},{default:A(()=>T[7]||(T[7]=[R(" Connect Wallet ")])),_:1}))])}}}),Qn=K(Zn,[["__scopeId","data-v-36634753"]]),Jn={style:{width:"100%"}},Xn={key:1},eo={class:"buttons_group"},to={key:0},so={key:1},no={key:0,class:"text-red mt-4 text-center"},oo=Q({__name:"Redeem",setup(e){const o=Te(),l=$e(),d=ne(),a=P(""),t=P(!1),r=k(()=>d.fund),f=P(!1),c=P(!1),_=P(!1),{shouldUserWaitSettlementOrCancelRedemption:B,userRedemptionRequestExists:D}=ge(d);Ae(()=>a.value,()=>{t.value=!0});const I=[g=>{var U,x;if(!r.value)return{message:"Fund data is missing.",display:!0};let y;try{y=fe(g||"0",(U=r.value)==null?void 0:U.fundToken.decimals)}catch{return{message:`Make sure the value has max ${(x=r.value)==null?void 0:x.fundToken.decimals} decimals.`,display:!1}}if(y<=0)return{message:"Value must be positive.",display:!1};if(console.log("[REDEEM] check user fund token balance wei: ",y,d.fundUserData.fundTokenBalance),d.fundUserData.fundTokenBalance<y){const W=ie(d.fundUserData.fundTokenBalance,r.value.fundToken.decimals);return{message:`Your ${r.value.fundToken.symbol} balance is too low: ${W}.`,display:!0}}return!0}],w=k(()=>(p.value.length>0&&console.log("request redeem errors",p.value),p.value.length>0||f.value||!d.isUserWalletWhitelisted)),p=k(()=>I.map(g=>g(a.value||"0")).filter(g=>g!==!0)),C=k(()=>p.value.filter(g=>g.display)),S=(g,y=!0)=>{f.value=!1,c.value=!1,_.value=!1,[4001,100].includes(g==null?void 0:g.code)?o.addToast("Redeem transaction was rejected."):(o.errorToast("There has been an error. Please contact the Rethink Finance support."),console.error(g),y&&d.fetchUserFundData(d.selectedFundChain,d.selectedFundAddress))},O=P([{name:"Request Redemption",onClick:async()=>{if(!d.activeAccountAddress){o.errorToast("Connect your wallet to redeem tokens from the vault.");return}if(!r.value){o.errorToast("Vault data is missing.");return}console.log("[REQUEST REDEMPTION]"),f.value=!0;const g=fe(a.value||"0",r.value.fundToken.decimals);console.log("[REDEEM] tokensWei: ",g,"from : ",d.activeAccountAddress);const y=he("requestWithdraw",[g]);try{await d.fundContract.send("fundFlowsCall",{},y).on("transactionHash",U=>{console.log("tx hash: "+U),o.addToast("The transaction has been submitted. Please wait for it to be confirmed.")}).on("receipt",U=>{console.log(U),U.status?(o.successToast("Your withdrawal request was successful. It may take 10 seconds or more for values to update."),d.fundUserData.redemptionRequest={amount:g,timestamp:Date.now(),type:De.Redemption},a.value=""):o.errorToast("The transaction has failed. Please contact the Rethink Finance support."),f.value=!1}).on("error",U=>{S(U,!1)})}catch(U){S(U)}},disabled:w,loading:f,isVisible:k(()=>!D.value),tooltipText:k(()=>D.value?"Redemption request already exists. To change it, you first have to cancel the existing one.":d.isUserWalletWhitelisted?"":"Your wallet address is not whitelisted to allow deposits into this vault.")}]);return(g,y)=>{const U=Le;return n(),u("div",Jn,[s(r)?(n(),V(U,{key:0,modelValue:s(a),"onUpdate:modelValue":y[0]||(y[0]=x=>me(a)?a.value=x:null),token0:s(r).fundToken,token1:s(r).baseToken,"token0-user-balance":s(d).fundUserData.fundTokenBalance,"token1-user-balance":s(d).fundUserData.baseTokenBalance,"exchange-rate":s(d).fundToBaseTokenExchangeRate},null,8,["modelValue","token0","token1","token0-user-balance","token1-user-balance","exchange-rate"])):F("",!0),y[3]||(y[3]=i("div",{class:"divider"},null,-1)),s(l).isConnected?(n(),u("div",Xn,[i("div",eo,[s(B)?(n(),u("h3",to,"Wait for settlement or cancel the redemption request.")):s(D)?(n(),u("h3",so,"You can now process or cancel the redemption request.")):F("",!0),(n(!0),u(M,null,de(s(O),x=>(n(),u(M,null,[x.isVisible?(n(),V(se,{key:x.name,location:"bottom",disabled:!x.tooltipText,bottom:""},{default:A(()=>[R(h(x.tooltipText),1)]),activator:A(({props:W})=>[i("span",pe({ref_for:!0},W),[v(ue,{class:"button",disabled:x.disabled,variant:"outlined",onClick:x.onClick},{prepend:A(()=>[x.loading?(n(),V(ee,{key:0,class:"d-flex",size:"20",width:"3",indeterminate:""})):F("",!0)]),default:A(()=>[R(" "+h(x.name),1)]),_:2},1032,["disabled","onClick"])],16)]),_:2},1032,["disabled"])):F("",!0)],64))),256))]),s(C)&&s(t)?(n(),u("div",no,[(n(!0),u(M,null,de(s(C),(x,W)=>(n(),u("div",{key:W},h(x.message),1))),128))])):F("",!0)])):(n(),V(ue,{key:2,class:"bg-primary text-secondary button_connect_wallet",onClick:y[1]||(y[1]=x=>s(l).connectWallet())},{default:A(()=>y[2]||(y[2]=[R(" Connect Wallet ")])),_:1}))])}}}),ao=K(oo,[["__scopeId","data-v-c0c0283f"]]),lo={name:"Settlement",props:{fund:{type:Object,default:()=>{}},shouldUserDelegate:{type:Boolean,default:!1}},data(){return{selectedActionButtonValue:"deposit",isDelegateDialogOpen:!1,selectItems:[{key:"deposit",label:"Deposit"},{key:"redeem",label:"Redeem"}]}},computed:{isSelectedDepositButton(){return this.selectedActionButtonValue==="deposit"},isSelectedRedeemButton(){return this.selectedActionButtonValue==="redeem"}},methods:{selectActionButton(e){this.selectedActionButtonValue=e},openDelegateDialog(){console.log("openDelegateDialog"),console.log("this.shouldUserDelegate: ",this.shouldUserDelegate),this.shouldUserDelegate&&(this.isDelegateDialogOpen=!0)}}},io={class:"fund_settlement"},ro={class:"card_header"},uo={class:"fund_settlement__card_boxes"},co={key:0,class:"card_box"};function fo(e,o,l,d,a,t){const r=vt,f=Qn,c=ao,_=Re;return n(),u("div",io,[i("div",ro,[o[2]||(o[2]=i("div",{class:"card_header__title subtitle_white"}," Manage Deposits ",-1)),v(r,{modelValue:a.selectedActionButtonValue,"onUpdate:modelValue":[o[0]||(o[0]=B=>a.selectedActionButtonValue=B),t.selectActionButton],items:a.selectItems,class:"fund_settlement__buttons"},null,8,["modelValue","items","onUpdate:modelValue"])]),i("div",uo,[a.selectedActionButtonValue?(n(),u("div",co,[t.isSelectedDepositButton?(n(),V(f,{key:0})):t.isSelectedRedeemButton?(n(),V(c,{key:1})):F("",!0)])):F("",!0)]),v(_,{modelValue:a.isDelegateDialogOpen,"onUpdate:modelValue":o[1]||(o[1]=B=>a.isDelegateDialogOpen=B)},null,8,["modelValue"])])}const mo=K(lo,[["render",fo],["__scopeId","data-v-4f5e49c7"]]),_o={class:"fund_details"},po={class:"main_card"},vo={class:"d-flex flex-column"},ho={class:"main_card main_grid order-1 order-sm-0"},Go=Q({__name:"index",setup(e){const o=ne(),{shouldUserDelegate:l,userDepositRequestExists:d,userRedemptionRequestExists:a}=ge(o),t=ot().fund;return(r,f)=>{const c=Lt,_=Us,B=Js,D=$n,I=mo;return n(),u("div",_o,[v(c,{fund:s(t)},null,8,["fund"]),i("div",po,[v(_,{fund:s(t)},null,8,["fund"])]),i("div",vo,[i("div",ho,[v(B,{fund:s(t)},null,8,["fund"]),s(d)||s(a)?(n(),V(D,{key:0,fund:s(t)},null,8,["fund"])):(n(),V(I,{key:1,fund:s(t),"should-user-delegate":s(l)},null,8,["fund","should-user-delegate"]))])])])}}});export{Go as default};
